---
title: meme-æ€»ç»“
tags: é»˜è®¤
categories: Programming
date: 2021-06-07 19:25:24
---

## åºè¨€

ç®€å•è®°å½•ä¸€ä¸‹åœ¨ä¹ˆä¹ˆç›´æ’­é‡åˆ°çš„é—®é¢˜ä»¥åŠè§£å†³åŠæ³•ï¼Œé¡¹ç›®æŠ€æœ¯æ ˆè·¨åº¦æ¯”è¾ƒå¤§ï¼Œæœ‰ 6-7 å¹´å‰ jquery é¡¹ç›®ï¼Œä¹Ÿæœ‰ React + MSTï¼ˆmobx state treeï¼‰ + SSR é¡¹ç›®ï¼Œè¿˜æœ‰çº¯ React é¡¹ç›®ï¼Œé‡åˆ°çš„é—®é¢˜æ¯”è¾ƒå¹¿æ³›ï¼Œè®°å½•ä¸€ä¸‹å¸¸è§çš„é—®é¢˜ï¼Œå¸®åŠ©å­¦ä¹ ã€‚

1. React çš„æ›´æ–°æœºåˆ¶

2. Ref çš„ä¸€äº›ç”¨æ³•

3. å—æ§ç»„å»ºå’Œéå—æ§ç»„ä»¶

4. å‘½åç©ºé—´

5. Canvas å®ç°å¼¹å¹•ç»„ä»¶  
   å®ç°å¼¹å¹•çš„æ ¸å¿ƒæ˜¯ Canvas çš„ measureText()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¯ä»¥è®¡ç®—å‡ºç”»å¸ƒä¸Šå­—ä½“çš„å®½åº¦ï¼Œç”±äºå¼¹å¹•çš„å†…å®¹ä¸€èˆ¬æ˜¯ç”±
   ç›¸å¯¹å›ºå®šçš„å›¾ç‰‡åŠ æœªçŸ¥é•¿åº¦çš„æ–‡æ¡ˆæ„æˆï¼Œæ¸²æŸ“å¤æ‚çš„å•æ¡å¼¹å¹•é¦–å…ˆéœ€è¦è§£å†³å¼¹å¹•æ€»é•¿åº¦ï¼Œæ‹¿åˆ°äº†æ€»é•¿åº¦ï¼Œé‚£ä¹ˆä¸ç®¡æ˜¯æ€»ä½“çš„å¼¹å¹•èƒŒæ™¯è¿˜æ˜¯å›¾ç‰‡æ–‡æ¡ˆçš„æœªçŸ¥éƒ½èƒ½
   å‡†ç¡®æ— è¯¯çš„æ¸²æŸ“å‡ºæ¥ï¼ŒReact å¯ä»¥æŠŠåŠŸèƒ½åšæˆä¸€ä¸ªç»„ä»¶ï¼Œä¸€æ¬¡å®Œæˆï¼Œå¤šæ¬¡å¤ç”¨ï¼Œè¿™é‡Œæˆ‘ç®€å•åˆ—ä¸¾ä¸¤ç§å¼¹å¹•çš„å®ç°ï¼Œä¸€ç§æ˜¯æ™®é€šçš„å¼¹å¹•ï¼Œæ„æˆæ˜¯èƒŒæ™¯è‰² + ç”¨æˆ·å¤´åƒ + ç›¸å¯¹å›ºå®šçš„æ–‡æ¡ˆï¼ˆæ¯”å¦‚æŠ½å¥–å¼¹å¹•ï¼Œå¤´åƒ + XXX åœ¨ VVV æ´»åŠ¨ä¸­ æŠ½ä¸­äº† AAAA x 99 æ¬¡ï¼‰ï¼Œ ä¸€ç§æ˜¯ç‰¹æ®Šå¼¹å¹•ï¼Œæ¯”å¦‚æ˜¥èŠ‚æœŸé—´äº§å“ä¸Šçº¿äº†ç¥ˆç¦é€ç¤¼éœ€æ±‚ï¼Œç”¨æˆ·å‘é€ç¥ç¦è¯­ï¼Œç„¶åç«‹å³åœ¨å±å¹•ä¸Šå¼¹å¹•å½¢å¼å‡ºç°ï¼Œæ¯æ¡ç¥ç¦è¯­å¼¹å¹•çš„èƒŒæ™¯æ ·å¼ä¸åŒï¼ŒğŸˆ¶ï¸ æ–°æ˜¥å¯¹è”ã€ç‡•å­é«˜é£ã€æŸ³æ ‘çº¸æ¡ç­‰ï¼Œåˆ‡æ¯ä¸ªç”¨æˆ·è¾“å…¥çš„ç¥ç¦è¯­é•¿åº¦å–å†³äºç”¨æˆ·è‡ªå·±ï¼Œæœ‰æ—¶å€™ä¸€æ¡å¼¹å¹•å°±å‡ ä¸ªå­—ï¼Œæœ‰çš„æœ‰å‡ åå­—ï¼ŒçŸ¥é“æ¯æ¡å¼¹å¹•çš„é•¿åº¦æœ‰ä¸¤ä¸ªç”¨å¤„ï¼Œä¸€æ˜¯å¼¹å¹•çš„èƒŒæ™¯ä½ç½®æ¸²æŸ“ï¼Œè€Œæ˜¯å¼¹å¹•é‡‡ç”¨å››è¡Œå¹¶å­˜çš„å½¢å¼ï¼Œé‚£ä¹ˆå¼¹å¹•æ’å…¥å“ªä¸€è¡Œä¹Ÿå–å†³äºå“ªä¸€è¡Œçš„å¼¹å¹•ç¨€ç–ç¨‹åº¦ï¼Œè¯ä¸å¤šå°‘ï¼Œä¸Šå›¾ä¸Šä»£ç ï¼š

   ```javascript
   // common å¼¹å¹•çš„å¼•ç”¨æ–‡ä»¶

   export function getDevicePixelRatio(): number {
     // Fix fake window.devicePixelRatio on mobile Firefox
     const isFirefox = navigator.userAgent.toLowerCase().indexOf('firefox') > -1

     if (window.devicePixelRatio !== undefined && !isFirefox) {
       return window.devicePixelRatio
     } else if (window.matchMedia) {
       const mediaQuery = (v: string, ov: string) => {
         return (
           '(-webkit-min-device-pixel-ratio: ' +
           v +
           '),' +
           '(min--moz-device-pixel-ratio: ' +
           v +
           '),' +
           '(-o-min-device-pixel-ratio: ' +
           ov +
           '),' +
           '(min-resolution: ' +
           v +
           'dppx)'
         )
       }
       if (window.matchMedia(mediaQuery('1.5', '3/2')).matches) {
         return 1.5
       }
       if (window.matchMedia(mediaQuery('2', '2/1')).matches) {
         return 2
       }
       if (window.matchMedia(mediaQuery('0.75', '3/4')).matches) {
         return 0.7
       }
     }
     return 1
   }

   // barrage-spring.tsx

   import { cancelAnimation } from '@utils/media'
   import { getDevicePixelRatio } from '@core/client'
   import { max } from '@utils/tool'
   ```


    const roundRect = function (ctx, left, top, width, height, r) {
    const pi = Math.PI;
    ctx.beginPath();
    ctx.arc(left + r, top + r, r, -pi, -pi / 2);
    ctx.arc(left + width - r, top + r, r, -pi / 2, 0);
    ctx.arc(left + width - r, top + height - r, r, 0, pi / 2);
    ctx.arc(left + r, top + height - r, r, pi / 2, pi);
    ctx.closePath();
    }

    const circleImg = function (ctx, img, l, t, r){
    const d = 2 * r
    ctx.save();
    ctx.beginPath()
    ctx.arc(l + r + 30, t + r - 3, r, 0, 2 * Math.PI)
    ctx.closePath()
    ctx.clip();
    ctx.drawImage(img, l + 30, t - 3, d, d);
    ctx.restore();
    }

    const leftBg = function (ctx, leftImg, left, top, width, height) {
    ctx.save()
    ctx.drawImage(leftImg, left, top, width, height)   // height 94
    ctx.restore();
    }

    const middleBg = function (ctx, img, left, top, width, height) {
    ctx.save()
    ctx.drawImage(img, left+112, top, width, height)
    ctx.restore();
    }

    const rightBg = function (ctx, img, left, top, width, height) {
    ctx.save()
    ctx.drawImage(img, left, top, width, height)
    ctx.restore();
    }



    // const preImg = (url, callback, options) => {
    //   const {x, y, w, h} = options
    //   const img = new Image()
    //   img.src = testLeft || url
    //   if (img.complete) {
    //     callback.call(img, x, y, w, h)
    //     return
    //   }
    //   img.onload = () => {
    //     callback.call(img, x, y, w, h)
    //   }
    // }


    const getPxRatio = () => {
    const c = document.createElement("canvas"),
        ctx = c.getContext("2d"),
        dpr = getDevicePixelRatio() || 1,
        bsr = ctx['webkitBackingStorePixelRatio'] ||
        ctx['mozBackingStorePixelRatio'] ||
        ctx['msBackingStorePixelRatio'] ||
        ctx['oBackingStorePixelRatio'] ||
        ctx['backingStorePixelRatio'] || 1;

    return dpr / bsr;
    }

    export class Barrage {
    constructor(option) {
        const { canvasId, onPalyFinish } = option
        const pixelRatio = max([getPxRatio(), 2])
        this.pxRatio = pixelRatio;  // ç¼©æ”¾å€æ•°ï¼Œ1ä¼šç³Š
        this.canvas = document.getElementById(canvasId);
        this.canvas.width = this.w = this.canvas.width * pixelRatio;
        this.canvas.height = this.h = this.canvas.height * pixelRatio;
        this.drawing = true
        this.finishCount = 0
        this.ctx = this.canvas.getContext('2d');
        this.style = { // å¼¹å¹•æ ·å¼
        height: 47 * pixelRatio,  // å¼¹å¹•é«˜åº¦   // æ—§ç‰ˆé«˜åº¦29
        imgBgWidth: 56 * pixelRatio,  // èƒŒæ™¯å›¾ç‰‡çš„å®½åº¦(å·¦ã€å³)
        fontSize: 12 * pixelRatio,  // å­—ä½“å¤§å°
        marginBottom: 20 * pixelRatio,  // å¼¹å¹• margin-bottom
        paddingX: 15 * pixelRatio,  // å¼¹å¹• padding x
        avatarWidth: 20 * pixelRatio,  // å¤´åƒå®½åº¦
        ellipsisMaxWidth: 100 * pixelRatio,
        offsetRight: 56 * pixelRatio   // å³èƒŒæ™¯åç§»é‡
        }
        this.ctx.font = this.style.fontSize + 'px PingFangSC-Regular';
        this.onPalyFinish = onPalyFinish

        this.barrageList = [];  // å¼¹å¹•åˆ—è¡¨
        this.rowStatusList = [];  // è®°å½•æ¯è¡Œæ˜¯å¦å¯æ’å…¥ï¼Œé˜²æ­¢é‡å ã€‚ è¡Œå·ä¸ºå¯æ’å…¥ falseä¸ºä¸å¯æ’å…¥

        let rowLength = Math.floor(this.h / (this.style.height + this.style.marginBottom));
        for (var i = 0; i < rowLength; i++) {
        this.rowStatusList.push(i)
        }
    }

    shoot(value) {
        const { height, avatarWidth, fontSize, marginBottom, paddingX, ellipsisMaxWidth } = this.style;
        const { img, sortArr, t1, t2, t3, t4 } = value;
        const ellipsisT2 = this.getEllipsisText(t2)
        let row = this.getRow();
        let color = '#7C0102';
        let offset = this.pxRatio;
        let offsetNew = 30
        let w_0 = paddingX;  // å¤´åƒå¼€å§‹ä½ç½®
        let w_1 = w_0 + avatarWidth + 8 + offsetNew + 10;  // t1æ–‡å­—å¼€å§‹ä½ç½®
        let w_2 = w_1 + Math.ceil(this.ctx.measureText(t1).width) + 8;  // t2æ–‡å­—å¼€å§‹ä½ç½®
        let w_3 = w_2 +  Math.ceil(this.ctx.measureText(ellipsisT2).width) + 8;  // t3æ–‡å­—å¼€å§‹ä½ç½®
        let w_4 = w_3 + Math.ceil(this.ctx.measureText(t3).width) + 8;  // t4æ–‡å­—å¼€å§‹ä½ç½®
        let w_5 = w_4 + Math.ceil(this.ctx.measureText(t4).width) + paddingX + 8;  // å¼¹å¹•æ€»é•¿åº¦

        let barrage = {
        color,
        row,
        offset,
        top: row * (height + marginBottom),
        left: this.w,
        width: [w_0, w_1, w_2, w_3, w_4, w_5],
        value,
        ellipsisT2,
        }

        this.barrageList.push(barrage);
    }

    draw() {
        if (!this.drawing) {
        return
        }

        if (!!this.barrageList.length) {
        this.ctx.clearRect(0, 0, this.w, this.h);
        for (let i = 0, barrage; barrage = this.barrageList[i]; i++) {
            // å¼¹å¹•æ»šå‡ºå±å¹•ï¼Œä»æ•°ç»„ä¸­ç§»é™¤
            if (barrage.left + barrage.width[5] <= -25) {
            this.barrageList.splice(i, 1);
            this.finishCount ++;
            i--;
            continue;
            }

            // å¼¹å¹•å®Œå…¨æ»šå…¥å±å¹•ï¼Œå½“å‰è¡Œå¯æ’å…¥
            if (!barrage.rowFlag) {
            if ((barrage.left + barrage.width[5]) < this.w - 45) {  //
                this.rowStatusList[barrage.row] = barrage.row;
                barrage.rowFlag = true;
            }
            }

            barrage.left -= barrage.offset;
            this.drawBarrage(barrage);
        }
        }
        this.reqAnimeId = requestAnimationFrame(this.draw.bind(this));
    }

    restartDraw() {
        this.drawing = true;
        this.draw()
    }

    clearDraw() {
        this.drawing = false
        cancelAnimation(this.reqAnimeId)
    }

    drawBarrage(barrage) {
        const { height, avatarWidth, fontSize, ellipsisMaxWidth } = this.style;
        const {
        value: { img, sortArr, t1, t3, t4,},
        ellipsisT2,
        color,
        row,
        left,
        top,
        offset,
        width,
        } = barrage;

        // ç”»æ¡†å­
        // roundRect(this.ctx, left, top, width[5], height, height / 2, avatarWidth)
        // this.ctx.fillStyle = 'rgba(0,0,0,0.45)';
        // this.ctx.fill();

        // -- ç”»å·¦è¾¹èƒŒæ™¯

        leftBg(this.ctx, sortArr[0], left , top, this.style.imgBgWidth, height)
        middleBg(this.ctx, sortArr[1], left , top, width[2]-width[1], height)
        rightBg(this.ctx, sortArr[2], left + width[5]- this.style.offsetRight , top, this.style.imgBgWidth, height )
        // left, top, width[1], height

        // ç”»å¤´åƒ
        // circleImg(this.ctx, img, left + width[0], top + (height - avatarWidth) / 2, avatarWidth/2)
        circleImg(this.ctx, sortArr[3], left + width[0], top + (height - avatarWidth) / 2, avatarWidth/2)

        // æ–°çš„topåç§»é‡  15
        const offsetYNew = -4
        const paddingTop = (height - fontSize) / 2 - 2

        this.ctx.fillStyle = color;
        this.ctx.fillText(t1, left + width[1], top + fontSize + paddingTop + offsetYNew);

        this.ctx.fillStyle = '#CFFCFC';
        this.ctx.fillText(ellipsisT2, left + width[2], top + fontSize + paddingTop);

        this.ctx.fillStyle = color;
        this.ctx.fillText(t3, left + width[3], top + fontSize + paddingTop);

        this.ctx.fillStyle = '#FFFF33';
        this.ctx.fillText(t4, left + width[4], top + fontSize + paddingTop);
    }

    getRow() {
        let emptyRowList = this.rowStatusList.filter(d => /\d/.test(d));  // æ‰¾å‡ºå¯æ’å…¥è¡Œ
        let row = emptyRowList[Math.floor(Math.random() * emptyRowList.length)];  // éšæœºé€‰ä¸€è¡Œ
        this.rowStatusList[row] = false;
        return row;
    }

    haveEmptyRow() {
        let emptyRowList = this.rowStatusList.filter(d => /\d/.test(d));  // æ‰¾å‡ºå¯æ’å…¥è¡Œ
        return !!emptyRowList.length;
    }

    getEllipsisText(text) {
        const { ellipsisMaxWidth: maxWidth  } = this.style
        if (this.ctx.measureText(text).width <= maxWidth) {
            return text
        }

        const textArr = text.split('');//å½“å‰å‰©ä½™çš„å­—ç¬¦ä¸²
        for (let m = 1; m <= textArr.length; m++) {
        if (this.ctx.measureText(textArr.slice(0, m)).width > maxWidth) {
            return textArr.slice(0, m).join('') + '...'
        }
        }
    }
    }

    // danmu.tsx   å¼¹å¹•ç»„ä»¶ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨ <danmu />

    import React, { useEffect, useRef } from 'react'
    import styled from 'styled-components'

    import { defAvatarNew } from '@constants'
    import request from '@core/request'
    // import { Barrage } from '@utils/barrage'
    import { Barrage } from '@pages/act_spring_festival/barrage-spring'
    import { choice } from '@utils/tool'

    import { actions } from './config'

    export default (props: any) => {
    const storeRef = useRef<any>({
        timer: 0,
        finishCount: 0,
        barrage: null,
    })

    useEffect(() => {
        fetchData()
    }, [])

    useEffect(() => {
        const barrage = new Barrage({ canvasId: 'act-spring-barrage' })
        barrage.draw()
        storeRef.current.barrage = barrage

        return () => {
        barrage.clearDraw()
        clearTimeout(storeRef.current.timer)
        }
    }, [])

    const fetchData = () => {
        request(actions.wishList).then((resData) => {
        const items = resData || []
        if (items && items[0]) {
            shootBarrage(items[0])
            setTimeout(() => shootBarrage(items[1]), 500)
            startBarrage(2, items)
        }
        })
    }

    const startBarrage = (activeIndex: number, source: any[]) => {
        const { timer, barrage } = storeRef.current
        clearTimeout(timer)

        storeRef.current.timer = setTimeout(() => {
        let flag = false
        if (source[activeIndex]) {
            flag = shootBarrage(source[activeIndex])
        }
        if (barrage.finishCount && barrage.finishCount >= source.length - 3) {
            barrage.finishCount = 0
            fetchData()
        }
        startBarrage(!flag ? activeIndex : activeIndex + 1, source)
        }, choice([1000, 1800]))
    }

    const shootBarrage = (currentItem: any) => {
        const barrage = storeRef.current.barrage

        if (!barrage.haveEmptyRow() || !currentItem) {
        return false
        }

        const { pic = defAvatarNew, wish = '' } = currentItem

        const data = {
        t1: wish,
        t2: '',
        t3: '',
        t4: '',
        }

        // --ä¸€èµ·åˆå§‹åŒ–èƒŒæ™¯å›¾
        const imgConf1 = [
        'https://img.sumeme.com/28/4/1612232722204.png',
        'https://img.sumeme.com/8/0/1612232705544.png',
        'https://img.sumeme.com/14/6/1612232681614.png',
        pic,
        ]

        const imgConf2 = [
        'https://img.sumeme.com/32/0/1612232775520.png',
        'https://img.sumeme.com/32/0/1612232762208.png',
        'https://img.sumeme.com/54/6/1612232743414.png',
        pic,
        ]

        const imgConf3 = [
        'https://img.sumeme.com/27/3/1612232818395.png',
        'https://img.sumeme.com/48/0/1612232804656.png',
        'https://img.sumeme.com/32/0/1612232789280.png',
        pic,
        ]

        // const imgConf4 = [
        //   'https://img.sumeme.com/25/1/1612232866777.png',
        //   'https://img.sumeme.com/32/0/1612232846432.png',
        //   'https://img.sumeme.com/33/1/1612232833441.png',
        //   pic,
        // ]

        const imgConfAll = [imgConf1, imgConf2, imgConf3]

        const imgArray = choice(imgConfAll)

        const receiveArray: any[] = []
        // let $myContent = document.getElementById("myContent");
        // let [imgW, imgH] = [300, 300];

        // let Canvas = document.createElement('canvas');
        // let ctx = Canvas.getContext("2d");
        // let scaleBy = 2;
        // Canvas.width = imgW * scaleBy;
        // Canvas.height = imgH * scaleBy;
        imgArray.forEach((e: any, idx: number) => {
        const img = new Image()
        img.src = e
        img.setAttribute('crossOrigin', 'Anonymous')
        img.addEventListener('load', () => {
            // ctx.drawImage(img, 0, 0, imgW * scaleBy, imgH * scaleBy);
            img.id = 'img' + idx
            receiveArray.push(img) // å°†ç»˜åˆ¶çš„imgèŠ‚ç‚¹æ”¶é›†åˆ°æ•°ç»„é‡Œï¼Œè¿™é‡Œçš„é¡ºåºå¯èƒ½å’ŒimgArrayçš„é¡ºåºä¸ä¸€æ ·
            if (receiveArray.length === imgArray.length) {
            // æ‰€æœ‰å›¾ç‰‡loadå¹¶ç»˜åˆ¶å®Œæˆ
            const sortArr = new Array()
            receiveArray.forEach((ex) => {
                // å°†æ‰€æœ‰ç»˜åˆ¶å›¾ç‰‡æŒ‰imgArrayé¡ºåºæ’åº
                sortArr[ex.id.split('img')[1]] = ex
            })
            barrage.shoot({
                sortArr,
                ...data,
            })
            // sortArr.forEach(ex2 => {
            //     $myContent.appendChild(ex2)
            // })
            }
        })
        })

        // const img = new Image()
        // img.setAttribute('crossOrigin', 'anonymous')
        // const data = {
        //   t1: wish,
        //   t2: '',
        //   t3: '',
        //   t4: '',
        // }
        // img.onload = () => {
        //   barrage.shoot({
        //     img,
        //     ...data,
        //   })
        // }
        // img.onerror = () => {
        //   barrage.finishCount++
        // }
        // let pic1 = 'https://img.sumeme.com/27/3/1611904142299.png'
        // console.log('---', pic)
        // img.src = pic1
        return true
    }

    return (
        <StyledBarrage>
        <canvas id="act-spring-barrage" height="250px" />
        </StyledBarrage>
    )
    }

    export const StyledBarrage = styled.div`
    position: absolute;
    bottom: -120px;
    width: 750px;
    height: 550px;
    /* z-index: 99999; */
    canvas {
        width: 100%;
        height: 100%;
    }
    `

    ```
    æŠ½ç©ºæŠŠè¿™ä¸ªå¼¹å¹•å†™ä¸ª demo ï¼Œå…‰å¹²å·´å·´çš„æ–‡å­—æ˜¯åœ¨éš¾ä»¥ç†è§£å•Š

6. Node çš„ç‰ˆæœ¬æ§åˆ¶

   è¿™ä¸ªä¸€èˆ¬ä½¿ç”¨ nvm æˆ–è€… n å‘½ä»¤

7. ç§»åŠ¨ç«¯å’Œ H5 çš„æ¡¥æ¥é€šä¿¡

   ä½¿ç”¨ jsBridge è¿›è¡Œ H5 å’Œç§»åŠ¨ç«¯çš„é€šä¿¡ã€‚å…·ä½“åé¢æ•´ç†ä¸€ä¸‹ã€‚

8. ç›´æ’­ç¤¼ç‰©çš„åŠ¨ç”»æ’­æ”¾é˜Ÿåˆ—å®ç°

9. Video æ’­æ”¾ mp4 çš„æ³¨æ„ç‚¹

   react ä¸­æ’­æ”¾ mp4 æ ¼å¼ï¼Œä¼šæœ‰ä¸€äº› iOS æœºå‹çš„å…¼å®¹é—®é¢˜ï¼Œä¸å¦‚ iOS ä¸èƒ½è‡ªåŠ¨æ’­æ”¾ç­‰

```javascript
//Reactä¸­æ’­æ”¾mp4çš„æƒ…å†µï¼Œä¸€å¸®æƒ…å†µä¸‹æ’­æ”¾GIFæˆ–è€…SVGA
// ä»£ç å¦‚ä¸‹
<div
  className="video-box"
  dangerouslySetInnerHTML={{
    __html: `
        <video
        id="entry-video"
        poster="https://img.sumeme.com/16/0/1624613307152.png"
        autoPlay
        x-webkit-airplay="allow"
        x5-video-player-type="h5"
        webkit-playsinline
        playsinline
        muted
        style="object-fit:fill"
        >
        <source src="https://img.sumeme.com/swf/Render6-16.mp4" type="video/mp4"> 
        </video>
        `,
  }}
/>
```

    posterå±æ€§å¯ä»¥åœ¨è§†é¢‘æœªåŠ è½½å®Œæˆå‰å±•ç¤ºä¸€å¼ å°é¢å›¾ç‰‡ï¼Œè§†é¢‘åŠ è½½åè‡ªåŠ¨æ’­æ”¾è§†é¢‘ã€‚

10. hooks å°è£…

    å…¶å®ç›¸æ¯”è‡ªå·±å°è£…æœ‰é’ˆå¯¹æ€§çš„ hooks å¤–ï¼Œé˜¿é‡Œçš„ ahooks3.0 ä¹Ÿå¯ä»¥ä½¿ç”¨ï¼ŒåŠŸèƒ½è¿˜æ˜¯å€¼å¾—æœŸå¾…çš„

11. React ä¸­æŒ‚è½½æ»‘åŠ¨å‡½æ•°

12. æŠ½å¥–

13. ä¸€äº› CSS

    ```
    -webkit-tap-highlight-color: rgba(0,0,0,0)
    // è§£å†³iOSå’ŒiPadè®¾å¤‡ä¸Šç‚¹å‡»çŠ¶æ€å‡ºç°é»˜è®¤è“è‰²é«˜äº®ï¼Œå¾ˆå¸¸è§
    ```

## CSS ç‚¹ä¹å›¾

æœ€è¿‘å¹´ä¸­å’Œå‘¨å¹´åº†å¼€å§‹ï¼Œé“ºå¤©ç›–åœ°çš„æ´»åŠ¨ã€‚UI è®¾è®¡çš„é£æ ¼å’Œä¸€å¾€ä¸å¤ªä¸€æ ·ï¼Œä¸¾ä¸€ä¸ªæ —å­ï¼š åœ¨æŠ•ç¥¨é¡µé¢ä¸­ï¼Œæ¯ä¸ªè¢«æŠ•ç¥¨çš„ä¸»æ’­éƒ½æ˜¯å•ç‹¬çš„ä¸€å¼ ç‰¹æ®ŠèƒŒæ™¯å›¾åŒ…è£¹ï¼Œè¯¥å®¹å™¨å¯èƒ½ä¼šæ ¹æ®è¢«æŠ•ç¥¨äººçš„ä¿¡æ¯é•¿çŸ­ä¸ä¸€ï¼Œä¸è§„åˆ™èƒŒæ™¯è¾¹æ¡†å›¾ä¹Ÿè¦è‡ªåŠ¨é€‚åº”ã€‚ç±»ä¼¼è¿™æ ·çš„éœ€æ±‚ï¼Œä¸€èˆ¬æœ‰è¿™ä¹ˆå‡ ç§æ–¹æ³•å®ç°ï¼š

1. ä¸‰æ®µå›¾é‡å¤
   å°±æ˜¯æŠŠä¸è§„åˆ™çš„èƒŒæ™¯å›¾åˆ‡æˆä¸‰æ®µã€‚å¤´éƒ¨ã€ä¸­é—´éƒ¨åˆ†ã€åº•éƒ¨ï¼Œä¸­é—´éƒ¨åˆ†åˆ©ç”¨èƒŒæ™¯å›¾çš„ repeat æ¥è‡ªé€‚åº”ï¼Œç¼ºç‚¹å°±æ˜¯ä¸çµæ´»ï¼Œéœ€è¦æ‰¾ UI åˆ‡å›¾ï¼Œé‡Œé¢å†…å®¹çš„é—´è·æ§åˆ¶ä¸ç²¾å‡†

2. ç‚¹ä¹å›¾
   ç‚¹ä¹å›¾æ˜¯ç§»åŠ¨ç«¯çš„ä¸€ç§åšæ³•ï¼Œå°±æ˜¯ä¸€å¼ å›¾åˆ‡å››åˆ€ï¼Œå››ä¸ªè§’ä¸ä¼¸ç¼©ï¼Œä¿æŒåŸå›¾æ¯”ä¾‹ã€‚å››æ¡è¾¹è¿›è¡Œä¼¸ç¼©ï¼Œä¸­é—´çš„éƒ¨åˆ†ç”¨æ¥å¡«å……ï¼Œä¸€å…±ä¹ä¸ªéƒ¨åˆ†ï¼Œæ‰€ä»¥ç§°ç‚¹ä¹å›¾ã€‚CSS3 ä¹Ÿå¯ä»¥å®ç°ç‚¹ä¹å›¾ï¼Œä¸”æ•ˆæœä¸é”™ï¼Œä¸¾ä¸ªä¾‹å­ï¼š  
   å†™ä¸€ä¸ªä¸šåŠ¡ç»„ä»¶ï¼Œåªç”¨æ¥åš wrap åŒ…è£¹ï¼Œç”¨ç‚¹ä¹å›¾ï¼Œè¿™æ ·å…¶ä»–çš„åŒæ ·å¼çš„ç»„ä»¶éƒ½å¯ä»¥å¤ç”¨ã€‚

```javascript
import React from 'react'
import styled from 'styled-components'

import { StyledBaseWrap } from '../styled'

type Props = {
  children: any
  title?: string
  // title?: string
  // headerType?: 'icon' | 'pureString'
}

export default (props: Props) => {
  const { children, title = '' } = props

  if (!children) {
    return null
  }

  return (
    <StyledBaseWrap>
      <i className="bg" />
      {
        title && (
          <div className="title-bg-box">
            <i className="title-bg" />
            {/* <p className="you-she">{title}</p> */}
            <div className="you-she">{title}</div>
          </div>
        )
      }
      {children}
    </StyledBaseWrap>
  )
}

const StyledBaseWrap = styled.div`
  position: relative;
  width: 680px;
  margin: 0 auto;
  min-height: 320px;
  & > * {
    margin: 0 auto;
  }
  .bg {
    position: absolute;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    display: block;
    border-style: solid;
    border-width: 130px 340px 190px 340px;
    border-image-source: url(${require('./images/bg_wrap.png')});
    border-image-slice: 130 340 190 340 fill;
    border-image-width: 1;
    border-image-repeat: repeat;
  }
  .title-bg-box {
    position: absolute;
    min-width: 380px;
    top: -20px;
    margin: 0 auto;
    font-size: 32px;
    left: 50%;
    transform: translateX(-50%);
    padding: 0 100px;
    box-sizing: border-box;
    div {
      position: relative;
      height: 52px;
      line-height: 52px;
      white-space: nowrap;
    }
  }
  .title-bg {
    position: absolute;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    display: block;
    border-style: solid;
    border-width: 24px 172px 24px 172px;
    border-image-source: url(${require('./images/title_bg.png')});
    border-image-slice: 24 172 24 172 fill;
    border-image-width: 1;
    border-image-repeat: repeat;
    margin: 0 auto;
  }
`
```

ä½¿ç”¨ 'border-image-slice' å±æ€§æ¥å®Œæˆç‚¹ä¹å›¾ï¼Œå®ƒæ¥å— 4 ä¸ªå‚æ•°ï¼Œåˆ†åˆ«åœ¨å›¾ç‰‡çš„ä¸Šå³ä¸‹å·¦åˆ‡ä¸€åˆ€ï¼ŒæŠŠå›¾ç‰‡åˆ†ä¸º 9 ä¸ªéƒ¨åˆ†ï¼Œä¸€ä¸­å¿ƒï¼Œå››ä¸ªè§’ï¼Œå››ä¸ªè¾¹ã€‚ä¼¸ç¼©åªä¼šè®©è¾¹è¿›è¡Œä¼¸ç¼©ï¼Œæ‰€ä»¥éœ€è¦è°ƒæ•´åˆ‡çš„ä½ç½®ï¼Œå°½é‡åœ¨è§„åˆ™çš„åœ°æ–¹ä¸‹åˆ€ã€‚æ­¤æ—¶ï¼Œè‹¥çˆ¶å®¹å™¨çš„å®½é«˜æœªç»™å®šï¼Œåˆ™å®Œå…¨ç”±å†…å®¹æ’‘å¼€å®½é«˜ï¼Œ
ä¸Šé¢æ —å­ä¸­ï¼Œå®½åº¦åšäº†é™åˆ¶ï¼Œé«˜åº¦æœªé™åˆ¶ï¼Œä¼ å…¥çš„ children ä¼šæ’‘å¼€ç‚¹ä¹å›¾ç»„ä»¶çš„é«˜åº¦ï¼Œåšåˆ°æ¯ä¸ªå­ç»„ä»¶é«˜åº¦æ ¹æ®å†…å®¹è‡ªé€‚åº”ï¼Œä½†æ•´ä½“çš„æ ·å¼ä¸ä¼šå‘ç”Ÿå˜åŒ–ã€‚
