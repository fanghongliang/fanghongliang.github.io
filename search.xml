<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[å­—ä½“å­é›†åŒ–åº”ç”¨]]></title>
    <url>%2F2023%2F10%2F30%2F%E5%AD%97%E4%BD%93%E5%AD%90%E9%9B%86%E5%8C%96%2F</url>
    <content type="text"><![CDATA[fontminfontmin æ˜¯ä¸€ä¸ªåŸºäºŽNode.jsçš„å­—ä½“å­é›†åŒ–å·¥å…·ï¼Œå®ƒå¯ä»¥å°†å­—ä½“æ–‡ä»¶åŽ‹ç¼©ä¸ºæœ€å°çš„å­é›†ï¼Œä»¥ä¾¿åœ¨Webåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ã€‚å®ƒå¯ä»¥å¸®åŠ©å‡å°‘å­—ä½“æ–‡ä»¶çš„å¤§å°ï¼Œæé«˜é¡µé¢åŠ è½½é€Ÿåº¦ï¼Œå¹¶å‡å°‘å¸¦å®½ä½¿ç”¨ã€‚ æå–å­—ä½“ä¸­æŒ‡å®šå­—ç¬¦é›†å‚è€ƒç™¾åº¦ fontmin / ä»‹ç» å¦‚ä½•ä½¿ç”¨ npm å‘½ä»¤è¿›è¡Œå®‰è£… fontmin 1npm install fontmin åˆ›å»ºå†…å®¹æ–‡ä»¶å¤¹,å‘½åæœ€å¥½æ˜¯å­—ä½“åç§°ï¼Œä¾‹å¦‚ï¼š DINPro \ youshebiaotihei \ yuweiã€ç¦¹å«ä¹¦æ³•è¡Œæ•°ç®€ä½“ã€‘ æ–‡ä»¶å¤¹ä¸‹åˆ›å»º content.txt å’Œ å¯¼å…¥ç›¸å…³å­—ä½“åŒ…æ–‡ä»¶ï¼Œ æ ¼å¼ XXXX.ttf è¿™é‡Œæˆ‘ä½¿ç”¨ ç¦¹å«ä¹¦æ³•è¡Œæ•°ç®€ä½“ å­—ä½“åŒ…ï¼Œcontent.txt ä¸­å†™å…¥ä½ éœ€è¦åº”ç”¨å­—ä½“çš„æ–‡å­—ï¼Œä¾‹å¦‚ï¼š ä¿¡æ¯æŠ€æœ¯æ ‡å‡† ã€1ã€‘æ­å»ºçŽ¯å¢ƒã€ã€2ã€3ã€‘å‡†å¤‡ç‰©æ–™ã€‚è¿™ä¸€æ­¥æˆ‘ä»¬ç¼–å†™è„šå…·ä½“è„šæœ¬ å¦‚ä¸‹ä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960&lt;!-- convert.js --&gt;/** * * * ä½¿ç”¨æ–¹å¼ * npm run font yuwei * * */let Fontmin = require('fontmin')let path = require('path')let fs = require('fs')let fontName = process.argv[2] // node å‘½ä»¤ï¼ŒåŽé¢ä¼šä»‹ç»ä¸æ­¢ä¸€ç§å­—ä½“æ—¶çš„è§£å†³åŠžæ³•ï¼Œä¸»è¦æ˜¯æ‹¿åˆ° ã€1ã€‘ä¸­çš„å­—ä½“ç›®å½•åç§°let srcPath = path.resolve('act-font/'+fontName) // act-font æ˜¯æˆ‘çš„é¡¹ç›®ä¸€çº§ç›®å½•ã€‚è‡ªå·±æ ¹æ®ç›®å½•ä½ç½®æŸ¥æ‰¾å³å¯ï¼Œä¸»è¦æ˜¯æ‹¿åˆ° ã€1ã€‘ ç›®å½•ä½ç½®å³å¯ã€‚let srcFontPath = srcPath + '/font.ttf' // èŽ·å–å…·ä½“å­—ä½“æ–‡ä»¶èµ„æºï¼Œè¿™é‡Œæ‹¿åˆ°äº† yuwei çš„å­—ä½“åŒ…è·¯å¾„let contentPath = srcPath + '/content.txt' // åŒç†ï¼ŒèŽ·å–ä½ éœ€è¦å¤„ç†çš„æ–‡å­— ã€3ã€‘let distPath = path.resolve('act-font/dist/' + fontName) // æ‰“åŒ…è¾“å‡ºçš„æ–‡ä»¶ä½ç½®ï¼Œæœ€ç»ˆçš„è¾“å‡ºæ–‡ä»¶å­˜åœ¨è¿™é‡Œconsole.log('------ convert start ------')console.log('srcFontPath:', srcFontPath)console.log('contentPath:', contentPath)console.log('distPath:', distPath)let content = fs.readFileSync(contentPath,'utf8').toString()console.log('content:', content)let fontmin = new Fontmin().src(srcFontPath).dest(distPath)console.log('srcFontPath:', srcFontPath)fontmin .use(Fontmin.glyph(&#123; text: content, hinting: false // keep ttf hint info (fpgm, prep, cvt). default = true &#125;)) .use(Fontmin.ttf2eot()) .use(Fontmin.ttf2svg()) .use(Fontmin.ttf2woff(&#123; deflate: true // deflate woff. default = false &#125;)) .use(Fontmin.css(&#123; fontPath: './', // location of font file base64: true, // inject base64 data:application/x-font-ttf; (gzip font with css). // default = false glyph: false, // generate class for each glyph. default = false iconPrefix: 'my-icon', // class prefix, only work when glyph is `true`. default to "icon" fontFamily: fontName, // custom fontFamily, default to filename or get from analysed ttf file asFileName: false, // rewrite fontFamily as filename force. default = false local: true // boolean to add local font. default = false &#125;)) .run((err, files, stream) =&gt; &#123; if (err) &#123; throw err; &#125; console.log('distPath:', distPath) console.log('------ convert success ------') &#125;) è„šæœ¬ç¼–å†™å®Œæ¯•ï¼Œå¯ä»¥ç›´æŽ¥ä½¿ç”¨ node æ‰§è¡Œ convert.js è„šæœ¬ï¼Œè¿™é‡Œæˆ‘ä»¬åœ¨ scripts ä¸­å°è£…ä¸€ä¸‹å‘½ä»¤ï¼Œæ–¹ä¾¿åŽç»­ä½¿ç”¨ 123456789// package.json "scripts": &#123; "font": "node convert-font.js"&#125;// æ‰§è¡Œ `npm run font &#123;å­—ä½“å&#125;`// eg: npm run font yuwei æ‰§è¡Œå®Œæ¯•ï¼Œå¯ä»¥çœ‹åˆ°åœ¨ dist æ–‡ä»¶ä¸­è¾“å‡ºäº†å­—ä½“æ–‡ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ .ttf æ–‡ä»¶å³å¯ã€‚ åœ¨ç¬¬ä¸‰æ–¹é¡¹ç›®ä¸­å¼•ç”¨ï¼Œé‡‡ç”¨å…¨å±€ CSS æ ·å¼å¼•å…¥ 12345678910111213141516/* å…¨å±€CSSæ ·å¼ *//* yuwei.ttf å³ dist ç›®å½•ä¸‹ yuwei/font.ttf æ”¹å,ä¸ºåŒºåˆ†å…¶ä»–å­—ä½“ */@font-face &#123; font-family: yuwei; src: url($&#123;require('@assets/styles/yuwei.ttf').default&#125;) format('truetype'); font-style: normal;&#125;.yu-wei &#123; font-family: yuwei, Tahoma, Arial;&#125;&lt;div&gt;è¿™é‡Œæ˜¯æ™®é€šå­—ä½“&lt;/div&gt;&lt;div className="yu-wei"&gt;ä¿¡æ¯æŠ€æœ¯æ ‡å‡†&lt;/div&gt; æ€»ç»“fontmin ä¼˜ç‚¹åœ¨äºŽèŠ‚çœäº†å­—ä½“æ–‡ä»¶åŒ…ï¼Œåœ¨å¤šå­—ä½“åœºæ™¯ä¸‹ï¼ŒæŒ‰éœ€åŠ è½½ï¼Œå‡å°‘å­—ä½“æ–‡ä»¶çš„å¤§å°ï¼Œæé«˜é¡µé¢åŠ è½½é€Ÿåº¦ï¼Œå¹¶å‡å°‘å¸¦å®½ä½¿ç”¨ã€‚ä¸”ä¸åœ¨å±€é™äºŽè®©UIåˆ‡å›¾ã€‚ä¸è¶³ä¹‹å¤„ï¼š æŒ‰éœ€åŠ è½½éœ€è¦æ¯æ¬¡æ–°å¢žæ–‡å­—çš„æ—¶å€™éƒ½è¦æ›´æ–° content.txt æ–‡ä»¶ï¼Œå¹¶é‡æ–°æ‰§è¡Œè„šæœ¬ï¼Œå¯¼å…¥æ–°çš„ .ttf å­—ä½“åŒ…ã€‚æ€»ä½“æ¥è¯´ï¼Œæ˜¯å¾ˆä¸é”™çš„ä¸€æ¬¾å­—ä½“å­é›†åŒ–åº”ç”¨åº“ï¼Œ Fontmin.js æ˜¯ä¸€ä¸ªéžå¸¸æœ‰ç”¨çš„å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©ç½‘ç«™æˆ–åº”ç”¨ç¨‹åºå‡å°å­—ä½“æ–‡ä»¶å¤§å°ï¼Œæé«˜é¡µé¢åŠ è½½é€Ÿåº¦ã€‚ä½†æ˜¯ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå®ƒå¯èƒ½ä¼šå½±å“å­—ä½“çš„å¤–è§‚ï¼Œå¹¶éœ€è¦é¢å¤–çš„å¤„ç†æ­¥éª¤ã€‚ è¯•è¯•AIå¯¹å®ƒçš„è¯„ä»·ï¼šFontmin.js çš„ä¼˜ç‚¹åŒ…æ‹¬ï¼š å‡å°å­—ä½“æ–‡ä»¶å¤§å°ï¼šFontmin.js å¯ä»¥å°†ä¸€ä¸ªå¤§åž‹å­—ä½“æ–‡ä»¶åŽ‹ç¼©ä¸ºä»…åŒ…å«æ‰€éœ€å­—ç¬¦çš„å°åž‹å­—ä½“æ–‡ä»¶ï¼Œä»Žè€Œå‡å°å­—ä½“æ–‡ä»¶çš„å¤§å°ï¼Œæé«˜é¡µé¢åŠ è½½é€Ÿåº¦ã€‚çµæ´»æ€§ï¼šFontmin.js æä¾›äº†å¤šç§æ–¹æ³•ï¼Œå¯ä»¥æ ¹æ®éœ€è¦é€‰æ‹©ä½¿ç”¨ï¼Œä¾‹å¦‚ Fontmin.glyph()ã€Fontmin.ttf2eot() å’Œ Fontmin.ttf2woff() ç­‰æ–¹æ³•ã€‚æ˜“äºŽä½¿ç”¨ï¼šFontmin.js çš„ API ç®€å•æ˜“ç”¨ï¼Œåªéœ€è¦å‡ è¡Œä»£ç å°±å¯ä»¥å®Œæˆå­—ä½“å­é›†åŒ–çš„æ“ä½œã€‚ Fontmin.js çš„ç¼ºç‚¹åŒ…æ‹¬ï¼š æ— æ³•å®Œå…¨ä¿ç•™å­—ä½“çš„å¤–è§‚ï¼šç”±äºŽ Fontmin.js åªä¿ç•™æ‰€éœ€å­—ç¬¦ï¼Œå› æ­¤å¯èƒ½ä¼šå½±å“å­—ä½“çš„å¤–è§‚ï¼Œç‰¹åˆ«æ˜¯å¯¹äºŽä¸€äº›å¤æ‚çš„å­—ä½“ã€‚éœ€è¦é¢å¤–çš„å¤„ç†æ­¥éª¤ï¼šFontmin.js ç”Ÿæˆçš„å­—ä½“æ–‡ä»¶éœ€è¦é¢å¤–çš„å¤„ç†æ­¥éª¤ï¼Œä¾‹å¦‚å°†å…¶æ·»åŠ åˆ° CSS æ–‡ä»¶ä¸­ï¼Œå¹¶ç¡®ä¿åœ¨ä¸åŒæµè§ˆå™¨å’Œè®¾å¤‡ä¸Šéƒ½èƒ½æ­£å¸¸æ˜¾ç¤ºã€‚ æ€»çš„æ¥è¯´ï¼ŒFontmin.js æ˜¯ä¸€ä¸ªéžå¸¸æœ‰ç”¨çš„å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©ç½‘ç«™æˆ–åº”ç”¨ç¨‹åºå‡å°å­—ä½“æ–‡ä»¶å¤§å°ï¼Œæé«˜é¡µé¢åŠ è½½é€Ÿåº¦ã€‚ä½†æ˜¯ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå®ƒå¯èƒ½ä¼šå½±å“å­—ä½“çš„å¤–è§‚ï¼Œå¹¶éœ€è¦é¢å¤–çš„å¤„ç†æ­¥éª¤ã€‚]]></content>
      <categories>
        <category>fontmin</category>
      </categories>
      <tags>
        <tag>fontmin</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[electron]]></title>
    <url>%2F2023%2F02%2F13%2Felectron%2F</url>
    <content type="text"><![CDATA[12 Electronæœ¬ç¯‡æ–‡ç« å°†ç»“åˆå®˜æ–¹æ–‡æ¡£ä»¥åŠå®žé™…çº¿ä¸Šæ¯å¤©ä¸‡äººä½¿ç”¨çš„ä¸€æ¬¾å¼€æ’­å·¥å…·æºç ç‰‡æ®µç»¼åˆé˜è¿°ä¸‹Electron çš„å¼€å‘ç»éªŒå’ŒæŠ€å·§ Electronæ˜¯ä¸€ä¸ªä½¿ç”¨ JavaScriptã€HTML å’Œ CSS æž„å»ºæ¡Œé¢åº”ç”¨ç¨‹åºçš„æ¡†æž¶ã€‚ åµŒå…¥ Chromium å’Œ Node.js åˆ° äºŒè¿›åˆ¶çš„ Electron å…è®¸æ‚¨ä¿æŒä¸€ä¸ª JavaScript ä»£ç ä»£ç åº“å¹¶åˆ›å»º åœ¨Windowsä¸Šè¿è¡Œçš„è·¨å¹³å°åº”ç”¨ macOSå’ŒLinuxâ€”â€”ä¸éœ€è¦æœ¬åœ°å¼€å‘ç»éªŒã€‚ å¼€å‘çŽ¯å¢ƒ æ‚¨éœ€è¦å®‰è£… node.js å»ºè®®å®‰è£…æœ€æ–°çš„LTSç‰ˆæœ¬ å› ä¸º Electron å°† Node.js åµŒå…¥åˆ°å…¶äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ï¼Œä½ åº”ç”¨è¿è¡Œæ—¶çš„ Node.js ç‰ˆæœ¬ä¸Žä½ ç³»ç»Ÿä¸­è¿è¡Œçš„ Node.js ç‰ˆæœ¬æ— å…³ã€‚ Electron åº”ç”¨ç¨‹åºéµå¾ªä¸Žå…¶ä»– Node.js é¡¹ç›®ç›¸åŒçš„ç»“æž„ã€‚ é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹å¹¶åˆå§‹åŒ– npm åŒ…ã€‚ 12mkdir my-electron-app &amp;&amp; cd my-electron-appnpm init initåˆå§‹åŒ–å‘½ä»¤ä¼šæç¤ºæ‚¨åœ¨é¡¹ç›®åˆå§‹åŒ–é…ç½®ä¸­è®¾ç½®ä¸€äº›å€¼ ä¸ºæœ¬æ•™ç¨‹çš„ç›®çš„ï¼Œæœ‰å‡ æ¡è§„åˆ™éœ€è¦éµå¾ªï¼š. entry point åº”ä¸º main.js.. author ä¸Ž description å¯ä¸ºä»»æ„å€¼ï¼Œä½†å¯¹äºŽåº”ç”¨æ‰“åŒ…æ˜¯å¿…å¡«é¡¹ã€‚è¿™é‡Œå®˜ç½‘åªæ˜¯ä½œä¸ºä¸€ä¸ªdemoæ¥è§„åˆ’æ–‡ä»¶ç»“æžœï¼Œå®žé™…å¼€å‘çŽ¯å¢ƒä¸­ï¼ŒElectronåº”ç”¨å¾ˆå¯èƒ½æ˜¯åœ¨åŽŸæœ‰ä¸šåŠ¡çš„ç½‘é¡µç‰ˆé¡¹ç›®ä¸­ ï¼Œæ¯”å¦‚ä¸€ä¸ªç½‘é¡µç‰ˆç›´æ’­é¡µé¢ï¼Œä½¿ç”¨React + next å®žçŽ°ã€‚çŽ°åœ¨è¦å®žçŽ°å¼€æ’­å·¥å…·æ¡Œé¢ç«¯é¥®ç”¨ï¼Œä¸€èˆ¬ç›´æŽ¥é€‰æ‹©åœ¨åŽŸæœ‰çš„é¡¹ç›®æ–‡ä»¶ä¸­ç›´æŽ¥æ–°å»ºæ–‡ä»¶å¤¹å¼€å§‹ï¼Œé‚£ä¹ˆå…¥å£æ–‡ä»¶å¾ˆå¯èƒ½ä¸æ˜¯æ ¹ç›®å½•ä¸‹ main.jsï¼Œè¿™ç‚¹æˆ‘ä»¬é€šè¿‡ package.json çš„é…ç½® main: â€˜xxxâ€™å¯ä»¥è§£å†³. è‡³äºŽè¯´ Electron æ˜¯ â€œWebç½‘é¡µâ€ å¥—äº†æ¡Œé¢ç«¯çš„å£³ï¼Œé‚£ä¸ºä»€ä¹ˆæˆ‘ä»¬è¿˜è¦ä½¿ç”¨ Electronå‘¢ï¼Ÿ å› ä¸ºWebåº”ç”¨æ— æ³•æ‹¿åˆ°æ“ä½œç³»ç»Ÿçš„æƒé™ï¼Œè¿™å¯¹äºŽæˆ‘ä»¬è§£å†³ä¸€äº›é—®é¢˜ååˆ†å…³é”®ã€‚ 12345// package.json&#123; "description": "www.2339.com", "main": "app/main.js", // è¿™é‡Œé…ç½®äº†é¡¹ç›®çš„å…¥å£æ–‡ä»¶&#125; æŒ‰è£… ElectronåŒ… å¹¶åˆ›å»ºæ‰§è¡Œè„šæœ¬ 1234567891011121314yarn add --dev electron// é…ç½® package.json 4ç§çŽ¯å¢ƒï¼Œä¸€èˆ¬å­¦ä¹ åªéœ€è¦é…ç½®ä¸€ç§å³å¯ï¼Œæ‰“åŒ…å‘½ä»¤åŽç»­ä¹Ÿåœ¨è¿™é‡Œé…ç½®&#123; "scripts": &#123; "electron:dev": "electron .", "electron:staging": "cross-env NODE_ENV=development ELECTRON=1 MODE=staging nextron -p 9401 .", "electron:grey": "electron .", "electron:production": "electron .", &#125;&#125;// å‘½ä»¤å¯åŠ¨ dev çŽ¯å¢ƒyarn electron:dev è¿è¡Œä¸»è¿›ç¨‹ä»»ä½• Electron åº”ç”¨ç¨‹åºçš„å…¥å£éƒ½æ˜¯ main æ–‡ä»¶ã€‚ è¿™ä¸ªæ–‡ä»¶æŽ§åˆ¶äº†ä¸»è¿›ç¨‹ï¼Œå®ƒè¿è¡Œåœ¨ä¸€ä¸ªå®Œæ•´çš„Node.jsçŽ¯å¢ƒä¸­ï¼Œè´Ÿè´£æŽ§åˆ¶æ‚¨åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸï¼Œæ˜¾ç¤ºåŽŸç”Ÿç•Œé¢ï¼Œæ‰§è¡Œç‰¹æ®Šæ“ä½œå¹¶ç®¡ç†æ¸²æŸ“å™¨è¿›ç¨‹(ç¨åŽè¯¦ç»†ä»‹ç»)ã€‚æ‰§è¡ŒæœŸé—´ï¼ŒElectron å°†ä¾æ®åº”ç”¨ä¸­ package.jsoné…ç½®ä¸‹mainå­—æ®µä¸­é…ç½®çš„å€¼æŸ¥æ‰¾æ­¤æ–‡ä»¶ï¼Œæ‚¨åº”è¯¥å·²åœ¨åº”ç”¨è„šæ‰‹æž¶æ­¥éª¤ä¸­é…ç½®ã€‚ åˆ›å»ºé¡µé¢åœ¨å¯ä»¥ä¸ºæˆ‘ä»¬çš„åº”ç”¨åˆ›å»ºçª—å£å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆåˆ›å»ºåŠ è½½è¿›è¯¥çª—å£çš„å†…å®¹ã€‚ åœ¨Electronä¸­ï¼Œå„ä¸ªçª—å£æ˜¾ç¤ºçš„å†…å®¹å¯ä»¥æ˜¯æœ¬åœ°HTMLæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªè¿œç¨‹urlã€‚ åœ¨çª—å£ä¸­æ‰“å¼€æ‚¨çš„é¡µé¢çŽ°åœ¨æ‚¨æœ‰äº†ä¸€ä¸ªé¡µé¢ï¼Œå°†å®ƒåŠ è½½è¿›åº”ç”¨çª—å£ä¸­ã€‚ è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œä½ éœ€è¦ ä¸¤ä¸ªElectronæ¨¡å—ï¼š . app æ¨¡å—ï¼Œå®ƒæŽ§åˆ¶åº”ç”¨ç¨‹åºçš„äº‹ä»¶ç”Ÿå‘½å‘¨æœŸã€‚. BrowserWindow æ¨¡å—ï¼Œå®ƒåˆ›å»ºå’Œç®¡ç†åº”ç”¨ç¨‹åº çª—å£ã€‚å› ä¸ºä¸»è¿›ç¨‹è¿è¡Œç€ Node.jsï¼Œæ‚¨å¯ä»¥åœ¨ main.js æ–‡ä»¶å¤´éƒ¨å°†å®ƒä»¬å¯¼å…¥ä½œä¸º CommonJS æ¨¡å—ï¼š ä¸“æœ‰åè¯ çª—å£ é¢„åŠ è½½è„šæœ¬ æ¸²æŸ“å™¨ ä¸»è¿›ç¨‹æ¯ä¸ª Electron åº”ç”¨éƒ½æœ‰ä¸€ä¸ªå•ä¸€çš„ä¸»è¿›ç¨‹ï¼Œä½œä¸ºåº”ç”¨ç¨‹åºçš„å…¥å£ç‚¹ã€‚ ä¸»è¿›ç¨‹åœ¨ Node.js çŽ¯å¢ƒä¸­è¿è¡Œï¼Œè¿™æ„å‘³ç€å®ƒå…·æœ‰ require æ¨¡å—å’Œä½¿ç”¨æ‰€æœ‰ Node.js API çš„èƒ½åŠ›ä¸»è¿›ç¨‹çš„ä¸»è¦ç›®çš„æ˜¯ä½¿ç”¨ BrowserWindow æ¨¡å—åˆ›å»ºå’Œç®¡ç†åº”ç”¨ç¨‹åºçª—å£ã€‚BrowserWindow ç±»çš„æ¯ä¸ªå®žä¾‹åˆ›å»ºä¸€ä¸ªåº”ç”¨ç¨‹åºçª—å£ï¼Œä¸”åœ¨å•ç‹¬çš„æ¸²æŸ“å™¨è¿›ç¨‹ä¸­åŠ è½½ä¸€ä¸ªç½‘é¡µã€‚ æ‚¨å¯ä»Žä¸»è¿›ç¨‹ç”¨ window çš„ webContent å¯¹è±¡ä¸Žç½‘é¡µå†…å®¹è¿›è¡Œäº¤äº’ã€‚ åº”ç”¨ç¨‹åºç”Ÿå‘½å‘¨æœŸä¸»è¿›ç¨‹è¿˜èƒ½é€šè¿‡ Electron çš„ app æ¨¡å—æ¥æŽ§åˆ¶æ‚¨åº”ç”¨ç¨‹åºçš„ç”Ÿå‘½å‘¨æœŸã€‚ è¯¥æ¨¡å—æä¾›äº†ä¸€æ•´å¥—çš„äº‹ä»¶å’Œæ–¹æ³•ï¼Œå¯ä»¥è®©æ‚¨ç”¨æ¥æ·»åŠ è‡ªå®šä¹‰çš„åº”ç”¨ç¨‹åºè¡Œä¸º (ä¾‹å¦‚ï¼šä»¥ç¼–ç¨‹æ–¹å¼é€€å‡ºæ‚¨çš„åº”ç”¨ç¨‹åºã€ä¿®æ”¹åº”ç”¨ç¨‹åºåžï¼Œæˆ–æ˜¾ç¤ºä¸€ä¸ªå…³äºŽé¢æ¿) app æ¨¡å— BrowserWindow æ¨¡å—BrowserWindow ç±»çš„æ¯ä¸ªå®žä¾‹åˆ›å»ºä¸€ä¸ªåº”ç”¨ç¨‹åºçª—å£ï¼Œä¸”åœ¨å•ç‹¬çš„æ¸²æŸ“å™¨è¿›ç¨‹ä¸­åŠ è½½ä¸€ä¸ªç½‘é¡µã€‚ æ‚¨å¯ä»Žä¸»è¿›ç¨‹ç”¨ window çš„ webContent å¯¹è±¡ä¸Žç½‘é¡µå†…å®¹è¿›è¡Œäº¤äº’ã€‚ç”±äºŽ BrowserWindow æ¨¡å—æ˜¯ä¸€ä¸ª EventEmitterï¼Œ æ‰€ä»¥æ‚¨ä¹Ÿå¯ä»¥ä¸ºå„ç§ç”¨æˆ·äº‹ä»¶ ( ä¾‹å¦‚ï¼Œæœ€å°åŒ– æˆ– æœ€å¤§åŒ–æ‚¨çš„çª—å£ ) æ·»åŠ å¤„ç†ç¨‹åºã€‚å½“ä¸€ä¸ª BrowserWindow å®žä¾‹è¢«é”€æ¯æ—¶ï¼Œä¸Žå…¶ç›¸åº”çš„æ¸²æŸ“å™¨è¿›ç¨‹ä¹Ÿä¼šè¢«ç»ˆæ­¢ã€‚ CommonJS æ¨¡å— Preload è„šæœ¬é¢„åŠ è½½ï¼ˆpreloadï¼‰è„šæœ¬åŒ…å«äº†é‚£äº›æ‰§è¡ŒäºŽæ¸²æŸ“å™¨è¿›ç¨‹ä¸­ï¼Œä¸”å…ˆäºŽç½‘é¡µå†…å®¹å¼€å§‹åŠ è½½çš„ä»£ç  ã€‚ è¿™äº›è„šæœ¬è™½è¿è¡ŒäºŽæ¸²æŸ“å™¨çš„çŽ¯å¢ƒä¸­ï¼Œå´å› èƒ½è®¿é—® Node.js API è€Œæ‹¥æœ‰äº†æ›´å¤šçš„æƒé™ã€‚é¢„åŠ è½½è„šæœ¬å¯ä»¥åœ¨ BrowserWindow æž„é€ æ–¹æ³•ä¸­çš„ webPreferences é€‰é¡¹é‡Œè¢«é™„åŠ åˆ°ä¸»è¿›ç¨‹ã€‚å› ä¸ºé¢„åŠ è½½è„šæœ¬ä¸Žæµè§ˆå™¨å…±äº«åŒä¸€ä¸ªå…¨å±€ Window æŽ¥å£ï¼Œå¹¶ä¸”å¯ä»¥è®¿é—® Node.js APIï¼Œæ‰€ä»¥å®ƒé€šè¿‡åœ¨å…¨å±€ window ä¸­æš´éœ²ä»»æ„ API æ¥å¢žå¼ºæ¸²æŸ“å™¨ï¼Œä»¥ä¾¿ä½ çš„ç½‘é¡µå†…å®¹ä½¿ç”¨ã€‚ ä¸‹é¢æ˜¯æ¸²æŸ“è¿›ç¨‹ä¸­é€‰å–ç”¨æˆ·æ“ä½œç³»ç»Ÿæ–‡ä»¶ä¸­çš„ä¸€å¼ å›¾ç‰‡å³æ‰“å¼€ç³»ç»Ÿæ–‡ä»¶å¤¹ï¼Œé€‰å–ä¸€å¼ å›¾ç‰‡ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191// åœ¨ preload è„šæœ¬ä¸­å¢žåŠ å…¨å±€æ¶ˆæ¯å¤„ç†æœºåˆ¶ // preload.jswindow.electron = &#123; message: &#123; send: (payload) =&gt; &#123; return ipcRenderer.send('message', payload); &#125;, on: (handler) =&gt; &#123; return ipcRenderer.on('message', handler); &#125;, off: (handler) =&gt; &#123; return ipcRenderer.off('message', handler); &#125;, &#125;,&#125;;// lib/qtClient èµ„æºæ–‡ä»¶å¤¹// å°è£…ä¸€ä¸ªå…¨å±€å…¬ç”¨æ–¹æ³•const clientEvent = new EventEmitter();const inti = (cb) =&gt; &#123; // PCé¡¹ç›®å’Œelectroné¡¹ç›®åœ¨åŒä¸€å·¥ç¨‹ä¸­ if (!browser.electronClient) &#123; console.info( '======================\r\néž electron çŽ¯å¢ƒ\r\n======================', ); return; &#125; // ç›‘å¬ä¸»è¿›ç¨‹äº‹ä»¶ window.electron.message.on((event, msg) =&gt; &#123; if (msg.id) &#123; clientEvent.emit(msg.id, msg); &#125; else &#123; clientEvent.emit(msg.action, msg); &#125; clientEvent.emit('all', msg); &#125;); cb &amp;&amp; cb();&#125;// call æ¶ˆæ¯å°è£…const call = (&#123; action, data = &#123;&#125;, onSuccess = (msg) =&gt; &#123;&#125;, onFail = (msg) =&gt; &#123;&#125;,&#125;) =&gt; &#123; // åŒä¸Šï¼ŒåŒºåˆ†electronçŽ¯å¢ƒ if (!browser.electronClient) &#123; return; &#125; if (!action) &#123; console.error('action is required'); return; &#125; const options = &#123; id: utils.getRandomString(), action, data, &#125;; clientEvent.once(options.id, (msg) =&gt; &#123; if (msg.code === 1) &#123; onSuccess(msg); &#125; else &#123; onFail(msg); &#125; &#125;); if (typeof data === 'function') &#123; options.data = &#123;&#125;; &#125; if (action !== 'getSystemInfo') &#123; log(`callã€$&#123;action&#125;ã€‘ options:`, options); &#125; window.electron.message.send(options);&#125;;const qtClient = &#123; init, call&#125;export default call// å°è£…å…·ä½“çš„ä¸šåŠ¡éœ€æ±‚-é€‰å–å›¾ç‰‡// app-client.jsconst selectImage = (onSuccess) =&gt; &#123; qtClient.call(&#123; action: 'selectImage', onSuccess, &#125;);&#125;;// å…·ä½“ä¸šåŠ¡çŽ¯å¢ƒä¸­ä½¿ç”¨// eg ä¸»æ’­å¼€æ’­åˆæµæ—¶å¾€è§†é¢‘åŒºåŸŸæ·»åŠ ä¸€å¼ å›¾ç‰‡const handleAddImage = () =&gt; &#123; appClient.selectImage((msg) =&gt; &#123; const &#123; filePath, fileName, ext, width, height &#125; = msg.data; // è¿”å›žæœ‰æ–‡ä»¶çš„å…·ä½“ä¿¡æ¯ï¼Œæ–‡ä»¶åã€è·¯å¾„ç­‰ // å¤„ç†ä½ çš„ä¸šåŠ¡ // æ¯”å¦‚ï¼š æŠŠæ–‡ä»¶ä¿¡æ¯åœ¨é€šè¿‡åˆ™ zego ç­‰ä¸‰æ–¹ä¼ é€’å‡ºåŽ»ï¼Œæœ€ç»ˆåœ¨ç›´æ’­æµä¸­æˆåŠŸæ·»åŠ ä¸€å¼ å›¾ç‰‡æˆ–Gif &#125;)&#125;// -----------------åˆ†å‰²çº¿--------------// ä»¥ä¸Šä»£ç æ˜¯æ¸²æŸ“è¿›ç¨‹å¤„ç†çš„äº‹// æ¸²æŸ“è¿›ç¨‹å‘ä¸»è¿›ç¨‹å‘é€äº†æƒ³è¦æ‰“å¼€ç”¨æˆ·æ–‡ä»¶å¤¹èŽ·å–å›¾ç‰‡çš„æ¶ˆæ¯ï¼Œ ipcRenderer// ä»¥ä¸‹å°†æ˜¯ä¸»è¿›ç¨‹ä¸­ç›‘å¬æ¸²æŸ“è¿›ç¨‹çš„æ¶ˆæ¯ï¼Œå¹¶ä½œå‡ºå¤„ç† ipcMain// main.tsimport message from './message';message.init()// message.ts// å¤„ç†æ‰€æœ‰çš„ä¸»è¿›ç¨‹æ¶ˆæ¯ // æ‰“å¼€æ–‡ä»¶å¤¹ï¼Œå¹¶é€‰å–å›¾ç‰‡æ–‡ä»¶ const selectImage = (event, message) =&gt; &#123; dialog .showOpenDialog(&#123; title: 'é€‰æ‹©å›¾ç‰‡', properties: ['openFile'], filters: [ &#123; name: 'Images', extensions: ['jpg', 'png', 'jpeg', 'gif', 'bmp'] &#125;, ], &#125;) .then(async (&#123; canceled, filePaths, bookmarks &#125;) =&gt; &#123; if (filePaths.length) &#123; const filePath = filePaths[0]; const &#123; width, height &#125; = imageSize(filePath); // const &#123;fileTypeFromFile&#125; = await import('file-type') // const fileType = await fileTypeFromFile(filePath); const [fileName, fileExt] = filePath .replace(/\\/gi, '/') .split('/') .pop() .split('.'); // const ext = fileType?.ext || fileExt; const ext = fileExt; responseSuccess(event, message, &#123; data: &#123; filePath: filePaths[0], fileName, width, height, ext: ext.toLowerCase(), &#125;, &#125;); &#125; &#125;);&#125;;const actions = &#123; selectImage,&#125;const init = () =&gt; &#123; ipcMain.on('message', (event, message) =&gt; &#123; // event.sender.send('message', message); if (message.action !== 'getSystemInfo') &#123; log.info('[ipcMain message]', message); &#125; if (actions[message.action]) &#123; actions[message.action](event, message); &#125; else &#123; log.warn('action not found', message.action); &#125; &#125;);&#125;; è‡³æ­¤ï¼Œä¸€ä¸ªå®Œå–„çš„æ¸²æŸ“è¿›ç¨‹-ä¸»è¿›ç¨‹é€šä¿¡æ¡†æž¶å°±æ­å»ºå®Œæ¯•ï¼ŒåŽç»­å…¶ä»–çš„é€šä¿¡éœ€æ±‚ç›´æŽ¥æ‰©å±•ä¸Šå³å¯ã€‚ è™½ç„¶é¢„åŠ è½½è„šæœ¬ä¸Žå…¶æ‰€é™„ç€çš„æ¸²æŸ“å™¨åœ¨å…±äº«ç€ä¸€ä¸ªå…¨å±€ window å¯¹è±¡ï¼Œä½†æ‚¨å¹¶ä¸èƒ½ä»Žä¸­ç›´æŽ¥é™„åŠ ä»»ä½•å˜åŠ¨åˆ° window ä¹‹ä¸Šï¼Œå› ä¸º contextIsolation æ˜¯é»˜è®¤çš„ã€‚è¯­å¢ƒéš”ç¦»ï¼ˆContext Isolationï¼‰æ„å‘³ç€é¢„åŠ è½½è„šæœ¬ä¸Žæ¸²æŸ“å™¨çš„ä¸»è¦è¿è¡ŒçŽ¯å¢ƒæ˜¯éš”ç¦»å¼€æ¥çš„ï¼Œä»¥é¿å…æ³„æ¼ä»»ä½•å…·ç‰¹æƒçš„ API åˆ°æ‚¨çš„ç½‘é¡µå†…å®¹ä»£ç ä¸­ã€‚ å–è€Œä»£ä¹‹ï¼Œæˆ‘ä»¬å°‡ä½¿ç”¨ contextBridge æ¨¡å—æ¥å®‰å…¨åœ°å®žçŽ°äº¤äº’ darwinDarwin æ˜¯MacOSX æ“ä½œçŽ¯å¢ƒ, å³è‹¹æžœç”µè„‘çš„æ“ä½œç³»ç»Ÿ æ‰“åŒ…å·¥å…·electron-builder CLIå‘½ä»¤è¡ŒæŽ¥å£ devDependencieså¼€å‘çŽ¯å¢ƒéœ€è¦çš„é¢å¤–ä¾èµ–ï¼Œæ‚¨çš„åº”ç”¨éœ€è¦è¿è¡Œ Electron APIï¼Œå› æ­¤è¿™å¬ä¸ŠåŽ»å¯èƒ½æœ‰ç‚¹åç›´è§‰ã€‚ å®žé™…ä¸Šï¼Œæ‰“åŒ…åŽçš„åº”ç”¨æœ¬èº«ä¼šåŒ…å« Electron çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå› æ­¤ä¸éœ€è¦å°† Electron ä½œä¸ºç”Ÿäº§çŽ¯å¢ƒä¾èµ–ã€‚ åŽŸç”Ÿ APIä¸ºäº†ä½¿ Electron çš„åŠŸèƒ½ä¸ä»…ä»…é™äºŽå¯¹ç½‘é¡µå†…å®¹çš„å°è£…ï¼Œä¸»è¿›ç¨‹ä¹Ÿæ·»åŠ äº†è‡ªå®šä¹‰çš„ API æ¥ä¸Žç”¨æˆ·çš„ä½œä¸šç³»ç»Ÿè¿›è¡Œäº¤äº’ã€‚ Electron æœ‰ç€å¤šç§æŽ§åˆ¶åŽŸç”Ÿæ¡Œé¢åŠŸèƒ½çš„æ¨¡å—ï¼Œä¾‹å¦‚èœå•ã€å¯¹è¯æ¡†ä»¥åŠæ‰˜ç›˜å›¾æ ‡ã€‚]]></content>
      <categories>
        <category>code</category>
      </categories>
      <tags>
        <tag>electron</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç›´æ’­ç›¸å…³Liveã€hybridã€‘]]></title>
    <url>%2F2022%2F01%2F01%2Fpage%2F</url>
    <content type="text"><![CDATA[åºè¨€ç›´æ’­é—´ä¸€äº›å¤æ‚åŠŸèƒ½çš„å®žçŽ°å’Œæ€»ç»“ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºŽ IM åŠæ—¶é€šè®¯æ¶ˆæ¯ã€èžäº‘ã€èžä¿¡ IM ç§èŠæ¶ˆæ¯ã€æŽ¨æ‹‰æµã€WebSocket æŽ¨é€ã€Hybrid ä¸Ž H5 çš„æ¡¥æŽ¥é€šä¿¡ã€mobx-state-tree | React é‡æž„ è¿œå¤ JQ ä»£ç ã€ PC ç›´æ’­é—´æ·±åº¦é“¾æŽ¥è‡³ç§»åŠ¨ç«¯ã€ç”¨æˆ·æžéªŒè¯ï¼ˆéªŒè¯éžè„šæœ¬æˆ–æœºå™¨äººï¼‰ã€è¿›åœºç‰¹æ•ˆã€ç”¨æˆ·å¤´åƒæŒ‚å ã€ç‚«å½©æ˜µç§°ã€ç”¨æˆ·è´¢å¯Œã€ç­‰çº§ã€èº«ä»½æ ‡ç­¾ç»„ä»¶åŒ–ã€æ‹–æ‹½ç­‰ç»„ä»¶åº”ç”¨ã€ åŠ¨ç”»SVGASvga æ˜¯å¸¸è§çš„ä¸€ç§ç›´æ’­é—´åŠ¨ç”»æ’­æ”¾æ ¼å¼ï¼Œå…¶ç‰¹æ€§è¿™é‡Œä¸åšè¿‡å¤šè§£é‡Šï¼Œä»Šå¤©æ€»ç»“ä¸€ä¸‹åœ¨ H5 ç«¯ å’Œ PC ç«¯ æ’­æ”¾ Svga åŠ¨ç”»çš„å…¨è¿‡ç¨‹ã€‚å°è£…å…¬ç”¨æ–¹æ³•ä»¥åŠä¼˜åŒ–ã€é¿å‘ã€‚ åŠ¨ç”»æ’­æ”¾åœ¨ç”¨æˆ·é€ç¤¼ã€ç¤¼ç‰©é¢„è§ˆç­‰åœºæ™¯ä¸‹ä½¿ç”¨é¢‘ç¹ï¼Œå°è£…ä¸€ä¸ªå…¬ç”¨æ–¹æ³•åœ¨é¡¹ç›® lib ååˆ†å¿…è¦ã€‚è¿™é‡Œä½¿ç”¨ ã€svgaplayerwebã€‘ å°è£…æ–¹æ³•ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172export function retryPromise(promiseFn, retriesLeft = 5, interval = 1500) &#123; return new Promise((resolve, reject) =&gt; &#123; promiseFn() .then(resolve) .catch((error) =&gt; &#123; setTimeout(() =&gt; &#123; if (retriesLeft === 1) &#123; reject(error); return; &#125; retryPromise(promiseFn, retriesLeft - 1, interval).then( resolve, reject ); &#125;, interval); &#125;); &#125;);&#125;/** * åŠ è½½svgaåŠ¨ç”» * @param &#123;String&#125; id dom-id * @param &#123;src&#125; src svgaæ–‡ä»¶è·¯å¾„ * @param &#123;Number&#125; loops å¾ªçŽ¯æ¬¡æ•°,é»˜è®¤ä¸º0æ— é™å¾ªçŽ¯ * @param &#123;Function&#125; onFinished å®Œæˆå›žè°ƒ * @param &#123;Boolean&#125; isPlayNow æ˜¯å¦ç«‹å³æ’­æ”¾ï¼Œé»˜è®¤true */const svgaModules = &#123;&#125;;export function svgaPlayer(option) &#123; const &#123; id, src, loops = 0, onFinished, clearsAfterStop = true, fillMode = "Backward", isPlayNow = true, &#125; = option; if (!id) &#123; return; &#125; const play = () =&gt; &#123; const &#123; svga &#125; = svgaModules; const player = new svga.Player(`#$&#123;id&#125;`); const parser = new svga.Parser(`#$&#123;id&#125;`); parser.load(src, (videoItem) =&gt; &#123; player.loops = loops; player.clearsAfterStop = clearsAfterStop; player.fillMode = fillMode; player.setVideoItem(videoItem); player.onFinished(() =&gt; &#123; if (onFinished) &#123; onFinished(); &#125; &#125;); isPlayNow &amp;&amp; player.startAnimation(); &#125;); &#125;; if (svgaModules.svga) &#123; play(); return; &#125; retryPromise(() =&gt; import("svgaplayerweb")).then((svga) =&gt; &#123; svgaModules.svga = svga; play(); &#125;);&#125; ä»¥ä¸Šå°è£…å¯ä»¥æ»¡è¶³å¸¸è§çš„åŠ¨ç”»æ’­æ”¾åœºæ™¯ã€‚ Tab ç‚¹å‡»åŠ¨ç”»åœºæ™¯çŽ°åœ¨çš„ H5 äº¤äº’è¶Šæ¥è¶Šä½“çŽ°ç”¨æˆ·è‡³ä¸Šï¼Œåœ¨ tab çš„ç‚¹å‡»ä¸Šï¼Œè®¾è®¡å¸ˆæ›´æƒ³è¦ç”¨æˆ·ç‚¹å‡» æŸä¸ª tab æ’­æ”¾è¯¥ tab çš„åŠ¨ç”»çŠ¶æ€ï¼Œå¸¸è§çš„æœ‰ç‚¹å‡» hybrid é¡µé¢æ ¹ tabï¼Œè¯¥ tab ä¼šæŠ–åŠ¨åŠ¨ç”»æˆ–è€…æ— è¡”æŽ¥æ’­æ”¾ä¸€ä¸ªå°åŠ¨ç”»ï¼Œè¿™ä¸ªè®¾è®¡å¸ˆç»™çš„ svga åŠ¨ç”»ï¼Œå®žçŽ°åªéœ€è¦ä¸Šè¿°å…¬ç”¨æ–¹æ³• ã€isPlayNowã€‘ å‚æ•°ï¼Œé»˜è®¤åªè®©åŠ¨ç”»åŠ è½½è€Œä¸ç«‹å³æ’­æ”¾ï¼Œå±•ç¤ºç¬¬ä¸€å¸§ï¼Œæ•ˆæžœå’Œé™æ€ tab ä¸€æ ·ï¼Œå¾…ç‚¹å‡»æ—¶åœ¨ ä¿®æ”¹ ã€isPlayNowã€‘ ä¸º trueï¼Œæ’­æ”¾åŠ¨ç”»å³å¯å®žçŽ°ä¸Šè¿°æ•ˆæžœã€‚ VAPvap [video-animation-player] æ˜¯è…¾è®¯ä¼é¹…ç”µç«žæŽ¨å‡ºçš„å¼€æº mp4 æ’­æ”¾åº“ï¼Œå…·ä½“ç§»æ­¥ GitHub ä»“åº“ï¼Œè¯¥åº“é€‚é…ä¸‰ç«¯ï¼Œè¿™é‡Œåªæ€»ç»“ä¸‹ Web ç«¯ å°è£…å…¬ç”¨æ–¹æ³•ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475// vap-player.jsimport Vap from "video-animation-player";import &#123; request &#125; from "lib";let vap = null;const play = (opt) =&gt; &#123; let &#123; container, src, configUrl, imgUser, textUser, width = "100%", height = "100%", fontStyle, loop = false, fps = 24, mute = true, precache = false, accurate = false, onStop = () =&gt; &#123;&#125;, &#125; = opt; const fn = (config) =&gt; &#123; if (vap) &#123; vap.destroy(); &#125; vap = new Vap( Object.assign( &#123;&#125;, &#123; container, src, config, width, height, fontStyle, imgUser, textUser, loop, fps: config.info.fps || fps, precache, mute, accurate, &#125; ) ) .on("error", (e) =&gt; &#123; vap.destroy(); onStop(); &#125;) .on("ended", () =&gt; &#123; vap.destroy(); onStop(); &#125;); &#125;; request.api.get(configUrl).then((res) =&gt; &#123; fn(res.data); &#125;);&#125;;const destroy = () =&gt; &#123; if (vap) &#123; vap.destroy(); &#125;&#125;;export default &#123; play, destroy &#125;;// å¼•ç”¨import VapPlayer from "lib";VapPlayer.play(options); ä½¿ç”¨ vap åœ¨éƒ¨åˆ†æœºåž‹å¯¼è‡´åŠ¨ç”»æ•ˆæžœæ¨¡ç³Šé”¯é½¿çš„è§£å†³åŠžæ³•ï¼š Dom å®¹å™¨çš„å®½é«˜æ‰©å¤§ 400%ï¼Œå†ç¼©å° â€˜transform: scale(0.25);â€™ ç¼©å°å››å€ã€‚ Chromeä¸æ”¯æŒobsè™šæ‹Ÿæ‘„åƒå¤´è§£å†³æ–¹æ³•ç›´æ’­å¹³å°ä¸€èˆ¬éƒ½ä¼šæœ‰è‡ªå·±å¯¹åº”çš„å¼€æ’­å·¥å…·ï¼Œæ¯”å¦‚YYã€è™Žç‰™åŠ©æ‰‹ã€OBSç­‰ã€‚é‡‡ç”¨OBSé‡‡é›†è§†é¢‘æµï¼Œä¼šä½¿ç”¨è™šæ‹Ÿæ‘„åƒå¤´ï¼ŒChromeæœ‰æ—¶å€™ä¼šä¸æ”¯æŒè™šæ‹Ÿæ‘„åƒå¤´ï¼Œè§£å†³åŠžæ³•ä¸ºï¼š æµè§ˆå™¨é»˜è®¤æœªå…è®¸è™šæ‹Ÿæ‘„åƒå¤´çš„ä½¿ç”¨ï¼Œåœ¨å‡ºChromeçš„è®¾ç½®ä¸­æ‰“å¼€å¯¹åº”çš„éšç§é…ç½®å³å¯ï¼Œå…·ä½“æ­¥éª¤å¯ä»¥Googleã€‚ IM åŠæ—¶é€šè®¯æ¶ˆæ¯å¾…æ•´ç† æŽ¨æ‹‰æµdsBridge æ¡¥æŽ¥é€šä¿¡socket ç›‘å¬å‘å¸ƒCSSç‚«å½©æ˜µç§°äº”é¢œå…­è‰²çš„ç‚«å½©æ˜µç§°CSSå®žçŽ° 1234&lt;!-- html --&gt;&lt;WrapColorName&gt; &lt;div className="name"&gt;ç”¨æˆ·æ˜µç§°å“‡å“ˆå“ˆ&lt;/div&gt;&lt;/WrapColorName&gt; 1234567891011121314151617181920212223242526272829/* è¿™é‡Œä½¿ç”¨ styled-components å†™æ³•ï¼Œå¯ä»¥æ”¹æˆå…¶ä»–CSSæ¡†æž¶å†™æ³•ï¼Œè¯­æ³•ä¸å˜ */const maskedAnimation = keyframes` from &#123; background-position: 0 0; &#125; to &#123; background-position: -200% 0; &#125;`;const WrapColorName = styled.div` background-image: -webkit-linear-gradient( left, #f70000, #ff891c 14.3%, #ffe719 28.6%, #33e97c 43%, #1dd5ff 57%, #ec80ff 71.4%, #ff43dc 86%, #ff43cb 100% ); -webkit-text-fill-color: transparent; -webkit-background-clip: text; -webkit-background-size: 200% 100%; -webkit-animation: $&#123;maskedAnimation&#125; 3s infinite linear;` ä¸Šé¢çš„demo å¯ä»¥ç›´æŽ¥åœ¨æœ¬åœ°è·‘ï¼Œä¸»è¦åˆ©ç”¨ webkit-background-size çš„ä½ç½®åç§»å’Œ webkit-animation èƒŒæ™¯å…‰æŸå®žçŽ°ç‚«å½©åŠ¨ç”»æ–‡æ¡ˆï¼Œä¸Šè¿°æ¡ˆä¾‹å¯ä»¥ç›´æŽ¥åœ¨ æ¼”ç¤ºåœ°å€ æŸ¥çœ‹]]></content>
      <categories>
        <category>é»˜è®¤</category>
      </categories>
      <tags>
        <tag>é»˜è®¤</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MST]]></title>
    <url>%2F2021%2F07%2F13%2FMST%2F</url>
    <content type="text"><![CDATA[åºè¨€Reactçš„ç»„ä»¶åŒ–å¼€å‘ç¡®å®žå¯¹äºŽå¤§åž‹é¡¹ç›®éžå¸¸æœ‰ç”¨ï¼Œå¤§åž‹é¡¹ç›®çš„æ•°æ®çŠ¶æ€ç®¡ç†å†™ä¹±äº†ä¹Ÿæ˜¯å¤´ç–¼å’Œéš¾ä»¥ç»´æŠ¤çš„ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹é¡¹ç›®ä¸­ä½¿ç”¨çš„çŠ¶æ€ç®¡ç†MSTï¼ˆmobx-state-treeï¼‰ é¢„å¤‡çŸ¥è¯† MobXï¼šè¿™æ˜¯MSTçš„æ ¸å¿ƒï¼ŒMSTä¸­å­˜å‚¨çš„å“åº”å¼â€œçŠ¶æ€â€éƒ½æ˜¯MobXçš„Observable Reactï¼šä½¿ç”¨Reactæ¥æµ‹è¯•MSTçš„åŠŸèƒ½éžå¸¸ç®€å• TypeScriptï¼šåŽæ–‡ä¸­ä¼šä½¿ç”¨TSæ¥ç¼–å†™ç¤ºä¾‹ä»£ç ï¼ŒTSå¼ºå¤§çš„æ™ºèƒ½æç¤ºå’Œç±»åž‹æ£€æŸ¥ï¼Œæœ‰åŠ©äºŽå¿«é€ŸæŽŒæ¡MSTçš„API å®‰è£…MSTä¾èµ–MobXã€‚é¡¹ç›®ä¸­æ‰§è¡Œyarn add mobx mobx-state-treeå³å¯å®Œæˆå®‰è£…ã€‚MobXæœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼Œæ–°ç‰ˆæœ¬éœ€è¦æµè§ˆå™¨Proxyæ”¯æŒï¼Œä¸€äº›è€æ—§çš„æµè§ˆå™¨å¹¶ä¸æ”¯æŒï¼Œéœ€è¦å…¼å®¹è€æµè§ˆå™¨çš„è¯·å®‰è£…mobx@4ï¼šyarn add mobx@4 mobx-state-treeã€‚ ç»“æž„ ä½¿ç”¨MSTæ¥ç»´æŠ¤çŠ¶æ€ï¼Œé¦–å…ˆéœ€è¦è®©MSTçŸ¥é“ï¼Œè¿™ä¸ªçŠ¶æ€çš„ç»“æž„æ˜¯ä»€ä¹ˆæ ·çš„ã€‚MSTå†…å»ºäº†ä¸€ä¸ªç±»åž‹æœºåˆ¶ã€‚é€šè¿‡ç±»åž‹çš„ç»„åˆå°±å¯ä»¥å®šä¹‰å‡ºæ•´ä¸ªçŠ¶æ€çš„å½¢çŠ¶ã€‚å¹¶ä¸”ï¼Œåœ¨å¼€å‘çŽ¯å¢ƒä¸‹ï¼ŒMSTå¯ä»¥é€šè¿‡è¿™ä¸ªå®šä¹‰å¥½çš„å½¢çŠ¶ï¼Œæ¥åˆ¤æ–­çŠ¶æ€çš„å€¼å’Œå½¢çŠ¶ä¸Žå…¶å¯¹åº”çš„ç±»åž‹æ˜¯å¦åŒ¹é…ï¼Œç¡®ä¿çŠ¶æ€çš„ç±»åž‹ä¸Žé¢„æœŸä¸€è‡´ï¼Œè¿™æœ‰åŠ©äºŽåœ¨å¼€å‘æ—¶åŠæ—¶å‘çŽ°æ•°æ®ç±»åž‹çš„é—®é¢˜ï¼š MSTæä¾›çš„ä¸€ä¸ªé‡è¦å¯¹è±¡å°±æ˜¯typesï¼Œåœ¨è¿™ä¸ªå¯¹è±¡ä¸­ï¼ŒåŒ…å«äº†åŸºç¡€çš„å…ƒç±»åž‹ï¼ˆprimitives typesï¼‰ï¼Œå¦‚stringã€booleanã€numberï¼Œè¿˜åŒ…å«äº†ä¸€äº›å¤æ‚ç±»åž‹çš„å·¥åŽ‚æ–¹æ³•å’Œå·¥å…·æ–¹æ³•ï¼Œå¸¸ç”¨çš„æœ‰modelã€arrayã€mapã€optionalç­‰ã€‚modelæ˜¯ä¸€ä¸ªtypesä¸­æœ€é‡è¦çš„ä¸€ä¸ªtypeï¼Œä½¿ç”¨types.modelæ–¹æ³•å¾—åˆ°çš„å°±æ˜¯Modelï¼Œåœ¨Modelä¸­ï¼Œå¯ä»¥åŒ…å«å¤šä¸ªtypeæˆ–è€…å…¶ä»–Modelã€‚ä¸€ä¸ªModelå¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆNodeï¼‰ï¼ŒèŠ‚ç‚¹ä¹‹é—´ç›¸äº’ç»„åˆï¼Œå°±æž„é€ å‡ºäº†æ•´æ£µçŠ¶æ€æ ‘ï¼ˆState Treeï¼‰ã€‚MSTå¯ç”¨çš„ç±»åž‹å’Œç±»åž‹æ–¹æ³•éžå¸¸å¤šï¼Œè¿™é‡Œä¸ä¸€ä¸€åˆ—ä¸¾ï¼Œå¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹å®Œæ•´çš„åˆ—è¡¨ã€‚å®ŒæˆModelçš„å®šä¹‰åŽï¼Œå¯ä»¥ä½¿ç”¨Model.createæ–¹æ³•èŽ·å¾—Modelçš„å®žä¾‹ã€‚Model.createå¯ä»¥ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯Modelçš„åˆå§‹çŠ¶æ€å€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å¯é€‰å‚æ•°ï¼Œè¡¨ç¤ºéœ€è¦ç»™ModelåŠå­Modelçš„envå¯¹è±¡ï¼ˆçŽ¯å¢ƒé…ç½®å¯¹è±¡ï¼‰ï¼Œenvç”¨äºŽå®žçŽ°ç®€å•çš„ä¾èµ–æ³¨å…¥åŠŸèƒ½ã€‚ PropsViewsviewsæ˜¯Modelä¸­ä¸€ç³»åˆ—è¡ç”Ÿæ•°æ®æˆ–èŽ·å–è¡ç”Ÿæ•°æ®çš„æ–¹æ³•çš„é›†åˆï¼Œç±»ä¼¼Vueç»„ä»¶çš„computedè®¡ç®—å±žæ€§ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå®šä¹‰viewsæ—¶æœ‰ä¸¤ç§é€‰æ‹©ï¼Œä½¿ç”¨getteræˆ–è€…ä¸ä½¿ç”¨ã€‚ä½¿ç”¨getteræ—¶ï¼Œè¡ç”Ÿæ•°æ®çš„å€¼ä¼šè¢«ç¼“å­˜ç›´åˆ°ä¾èµ–çš„æ•°æ®å‘é€å˜åŒ–ã€‚è€Œä¸ä½¿ç”¨æ—¶ï¼Œéœ€è¦é€šè¿‡æ–¹æ³•è°ƒç”¨çš„æ–¹å¼èŽ·å–è¡ç”Ÿæ•°æ®ï¼Œæ— æ³•å¯¹è®¡ç®—ç»“æžœè¿›è¡Œç¼“å­˜ã€‚å°½å¯èƒ½ä½¿ç”¨getterï¼Œæœ‰åŠ©äºŽæå‡åº”ç”¨çš„æ€§èƒ½ã€‚ Actionsä»Žåå­—ä¸Šå¯ä»¥çœ‹å‡ºæ¥ï¼Œä¸Šé¢å››ä½éƒ½æ˜¯ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨ä»–ä»¬åœ¨Modelçš„å„ä¸ªç”Ÿå‘½å‘¨æœŸæ‰§è¡Œä¸€äº›æ“ä½œï¼š é™¤äº†é€šå¸¸æ„ä¹‰ä¸Šç”¨æ¥æ›´æ–°çŠ¶æ€çš„actionså¤–ï¼Œåœ¨model.actionsæ–¹æ³•ä¸­ï¼Œè¿˜å¯ä»¥è®¾ç½®ä¸€äº›ç‰¹æ®Šçš„actionsï¼š afterCreateafterAttachbeforeDetachbeforeDestroy ä»Žåå­—ä¸Šå¯ä»¥çœ‹å‡ºæ¥ï¼Œä¸Šé¢å››ä½éƒ½æ˜¯ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨ä»–ä»¬åœ¨Modelçš„å„ä¸ªç”Ÿå‘½å‘¨æœŸæ‰§è¡Œä¸€äº›æ“ä½œï¼š 1234567const Model = types .model(...) .actions(self =&gt; (&#123; afterCreate () &#123; // æ‰§è¡Œä¸€äº›åˆå§‹åŒ–æ“ä½œ &#125; &#125;)); å¼‚æ­¥Actionã€Flowå¼‚æ­¥æ›´æ–°çŠ¶æ€æ˜¯éžå¸¸å¸¸è§çš„éœ€æ±‚ï¼ŒMSTä»Žåº•å±‚æ”¯æŒå¼‚æ­¥actionã€‚ 1234567891011121314151617181920const model = types .model(...) .actions(self =&gt; (&#123; // async/await async getData () &#123; try &#123; const data = await api.getData(); ... &#125; catch (err) &#123; ... &#125; ... &#125;, // promise updateData () &#123; return api.updateData() .then(...) .catch(...); &#125; &#125;)); è‹¥ä½¿ç”¨Promiseã€async/awaitæ¥ç¼–å†™å¼‚æ­¥Actionï¼Œåœ¨å¼‚æ­¥æ“ä½œä¹‹åŽæ›´æ–°çŠ¶æ€æ—¶ï¼Œä»£ç æ‰§è¡Œçš„ä¸Šä¸‹æ–‡ä¼šè„±ç¦»actionï¼Œå¯¼è‡´çŠ¶æ€åœ¨actionä¹‹å¤–è¢«æ›´æ–°è€ŒæŠ¥é”™ã€‚è¿™é‡Œæœ‰ä¸¤ç§è§£å†³åŠžæ³•ï¼š å°†æ›´æ–°çŠ¶æ€çš„æ“ä½œå•ç‹¬å°è£…æˆaction ç¼–å†™ä¸€ä¸ªrunInActionçš„actionåœ¨å¼‚æ­¥æ“ä½œä¸­ä½¿ç”¨ 123456789101112131415161718192021222324252627282930313233343536373839// æ–¹æ³•1const Model = types .model(...) .actions(self =&gt; (&#123; setLoading (loading: boolean) &#123; self.loading = loading; &#125;, setData (data: any) &#123; self.data = data; &#125;, async getData () &#123; ... self.setLoading(true); // è¿™é‡Œå› ä¸ºåœ¨å¼‚æ­¥æ“ä½œä¹‹å‰ï¼Œç›´æŽ¥èµ‹å€¼self.loading = trueä¹Ÿok const data = await api.getData(); self.setData(data); self.setLoading(false); ... &#125; &#125;)); // æ–¹æ³•2const Model = types .model(...) .actions(self =&gt; (&#123; runInAction (fn: () =&gt; any) &#123; fn(); &#125;, async getData () &#123; ... self.runInAction(() =&gt; self.loading = true); const data = await api.getData(); self.runInAction(() =&gt; &#123; self.data = data; self.loading = false; &#125;); ... &#125; &#125;)); æ–¹æ³•1éœ€è¦é¢å¤–å°è£…Nä¸ªactionï¼Œæ¯”è¾ƒéº»çƒ¦ã€‚æ–¹æ³•2å°è£…ä¸€æ¬¡å°±å¯ä»¥å¤šæ¬¡ä½¿ç”¨ã€‚ä½†æ˜¯åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¸¤ç§æ–¹æ³•éƒ½ä¸å¤Ÿå®Œç¾Žï¼šä¸€ä¸ªå¼‚æ­¥actionè¢«åˆ†å‰²æˆäº†Nä¸ªactionè°ƒç”¨ï¼Œæ— æ³•ä½¿ç”¨MSTçš„æ’ä»¶æœºåˆ¶å®žçŽ°æ•´ä¸ªå¼‚æ­¥actionçš„åŽŸå­æ“ä½œã€æ’¤é”€/é‡åšç­‰é«˜çº§åŠŸèƒ½ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒMSTæä¾›äº†flowæ–¹æ³•æ¥åˆ›å»ºå¼‚æ­¥actionï¼š 1234567891011121314151617181920import &#123; types, flow &#125; from 'mobx-state-tree';const model = types .model(...) .actions(self =&gt; &#123; const getData = flow(function * () &#123; self.loading = true; try &#123; const data = yield api.getData(); self.data = data; &#125; catch (err) &#123; ... &#125; self.loading = false; &#125;); return &#123; getData &#125;; &#125;) ä½¿ç”¨flowæ–¹æ³•éœ€è¦ä¼ å…¥ä¸€ä¸ªgenerator functionï¼Œåœ¨è¿™ä¸ªç”Ÿæˆå™¨æ–¹æ³•ä¸­ï¼Œä½¿ç”¨yieldå…³é”®å­—å¯ä»¥resolveå¼‚æ­¥æ“ä½œã€‚å¹¶ä¸”ï¼Œåœ¨æ–¹æ³•ä¸­å¯ä»¥ç›´æŽ¥ç»™çŠ¶æ€èµ‹å€¼ï¼Œå†™èµ·æ¥æ›´ç®€å•è‡ªç„¶ã€‚ å¿«ç…§ Snapshotsnapshotå³â€œå¿«ç…§â€ï¼Œè¡¨ç¤ºæŸä¸€æ—¶åˆ»ï¼ŒModelçš„çŠ¶æ€åºåˆ—åŒ–ä¹‹åŽçš„å€¼ã€‚è¿™ä¸ªå€¼æ˜¯æ ‡å‡†çš„JSå¯¹è±¡ã€‚ ä½¿ç”¨getSnapshotæ–¹æ³•èŽ·å–å¿«ç…§ï¼š ä½¿ç”¨applySnapshotæ–¹æ³•å¯ä»¥æ›´æ–°Modelçš„çŠ¶æ€ï¼š Volatile Stateåœ¨MSTä¸­ï¼Œpropså¯¹åº”çš„çŠ¶æ€éƒ½æ˜¯å¯æŒä¹…åŒ–çš„ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥åºåˆ—åŒ–ä¸ºæ ‡å‡†çš„JSONæ•°æ®ã€‚å¹¶ä¸”ï¼Œpropså¯¹åº”çš„çŠ¶æ€å¿…é¡»ä¸Žpropsçš„ç±»åž‹ç›¸åŒ¹é…ã€‚å¦‚æžœéœ€è¦åœ¨Modelä¸­å­˜å‚¨æ— éœ€æŒä¹…åŒ–ï¼Œå¹¶ä¸”æ•°æ®ç»“æž„æˆ–ç±»åž‹æ— æ³•é¢„çŸ¥çš„åŠ¨æ€æ•°æ®ï¼Œå¯ä»¥è®¾ç½®ä¸ºVolatile Stateã€‚ Volatile Stateçš„å€¼ä¹Ÿæ˜¯Observableï¼Œä½†æ˜¯åªä¼šå“åº”å¼•ç”¨çš„å˜åŒ–ï¼Œæ˜¯ä¸€ä¸ªéžDeep Observableã€‚ é€‰æ‹©æ­£ç¡®çš„typesç±»åž‹types.stringå®šä¹‰ä¸€ä¸ªå­—ç¬¦ä¸²ç±»åž‹å­—æ®µã€‚ types.numberå®šä¹‰ä¸€ä¸ªæ•°å€¼ç±»åž‹å­—æ®µã€‚ types.booleanå®šä¹‰ä¸€ä¸ªå¸ƒå°”ç±»åž‹å­—æ®µã€‚ types.integerå®šä¹‰ä¸€ä¸ªæ•´æ•°ç±»åž‹å­—æ®µã€‚æ³¨æ„ï¼Œå³ä½¿æ˜¯TypeScriptä¸­ä¹Ÿæ²¡æœ‰â€œæ•´æ•°â€è¿™ä¸ªç±»åž‹ï¼Œåœ¨ç¼–ç æ—¶ï¼Œä¼ å…¥ä¸€ä¸ªå¸¦å°æ•°çš„å€¼TypeScriptä¹Ÿæ— æ³•å‘çŽ°å…¶ä¸­çš„ç±»åž‹é”™è¯¯ã€‚å¦‚æ— å¿…è¦ï¼Œè¯·ä½¿ç”¨types.numberã€‚ types.Dateå®šä¹‰ä¸€ä¸ªæ—¥æœŸç±»åž‹å­—æ®µã€‚è¿™ä¸ªç±»åž‹å­˜å‚¨çš„å€¼æ˜¯æ ‡å‡†çš„Dateå¯¹è±¡ã€‚åœ¨è®¾ç½®å€¼æ—¶ï¼Œå¯ä»¥é€‰æ‹©ä¼ å…¥æ•°å€¼ç±»åž‹çš„æ—¶é—´æˆ³æˆ–è€…Dateå¯¹è±¡ã€‚ types.nullå®šä¹‰ä¸€ä¸ªå€¼ä¸ºnullçš„ç±»åž‹å­—æ®µã€‚ types.undefinedå®šä¹‰ä¸€ä¸ªå€¼ä¸ºundefinedçš„ç±»åž‹å­—æ®µã€‚å¤åˆç±»åž‹ types.modelå®šä¹‰ä¸€ä¸ªå¯¹è±¡ç±»åž‹çš„å­—æ®µã€‚ types.arrayå®šä¹‰ä¸€ä¸ªæ•°ç»„ç±»åž‹çš„å­—æ®µã€‚types.array(types.string);types.array(types.model); types.mapå®šä¹‰ä¸€ä¸ªmapç±»åž‹çš„å­—æ®µã€‚è¯¥mapçš„keyéƒ½ä¸ºå­—ç¬¦ä¸²ç±»åž‹ï¼Œmapçš„å€¼éƒ½ä¸ºæŒ‡å®šç±»åž‹ã€‚mapå¯ç”¨setã€ getè¿›è¡Œå–èµ‹å€¼ 1234567891011121314151617181920export enum PopupType &#123; Rule = 'è§„åˆ™', Award = 'å¥–åŠ±', Buy = 'è´­ä¹°', Tip = 'æç¤º',&#125;popup: types.map(types.boolean);const showPopup = (type: PopupType) =&gt; &#123; self.popup.set(type: true)&#125;const hidePopup = (type: PopupType) =&gt; &#123; self.popup.set(type, false);&#125;;// å…·ä½“ä½¿ç”¨&#123;popup.get(PopupType.Rule) &amp;&amp; &lt;PopupRule /&gt;&#125; types.optionalå¯é€‰ç±»åž‹,æ ¹æ®ä¼ å…¥çš„å‚æ•°ï¼Œå®šä¹‰ä¸€ä¸ªå¸¦æœ‰é»˜è®¤å€¼çš„å¯é€‰ç±»åž‹ã€‚types.optionalæ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œæ–¹æ³•æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ•°æ®çš„çœŸå®žç±»åž‹ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ•°æ®çš„é»˜è®¤å€¼ã€‚types.optional(types.number, 1);ä¸Šé¢çš„ä»£ç å®šä¹‰äº†ä¸€ä¸ªé»˜è®¤å€¼ä¸º1çš„æ•°å€¼ç±»åž‹ã€‚æ³¨æ„ï¼Œtypes.arrayæˆ–è€…types.mapå®šä¹‰çš„ç±»åž‹è‡ªå¸¦é»˜è®¤å€¼ï¼ˆarrayä¸º[]ï¼Œmapä¸º{}ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸‹é¢ä¸¤ç§å®šä¹‰çš„ç»“æžœæ˜¯ä¸€æ ·çš„ï¼š 1234567// ä½¿ç”¨types.optionaltypes.optional(types.array(types.number), []);types.optional(types.map(types.number), &#123;&#125;);// ä¸ä½¿ç”¨types.optionaltypes.array(types.number);types.map(types.number); å¦‚æžœè¦è®¾ç½®çš„é»˜è®¤å€¼ä¸Žtypes.arrayæˆ–types.mapè‡ªå¸¦çš„é»˜è®¤å€¼ç›¸åŒï¼Œé‚£ä¹ˆå°±ä¸éœ€è¦ä½¿ç”¨types.optionalã€‚ types.customå¦‚æžœæƒ³æŽ§åˆ¶ç±»åž‹æ›´åº•å±‚çš„å¦‚åºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€ç±»åž‹æ ¡éªŒç­‰ç»†èŠ‚ï¼Œæˆ–è€…æ ¹æ®ä¸€ä¸ªclassæˆ–interfaceæ¥å®šä¹‰ç±»åž‹ï¼Œå¯ä»¥ä½¿ç”¨types.customå®šä¹‰è‡ªå®šä¹‰ç±»åž‹ã€‚ 1234567891011121314151617181920class Decimal &#123; ...&#125;const DecimalPrimitive = types.custom&lt;string, Decimal&gt;(&#123; name: "Decimal", fromSnapshot(value: string) &#123; return new Decimal(value) &#125;, toSnapshot(value: Decimal) &#123; return value.toString() &#125;, isTargetType(value: string | Decimal): boolean &#123; return value instanceof Decimal &#125;, getValidationMessage(value: string): string &#123; if (/^-?\d+\.\d+$/.test(value)) return "" // OK return `'$&#123;value&#125;' doesn't look like a valid decimal number` &#125;&#125;); types.unionå®žé™…å¼€å‘ä¸­ä¹Ÿè®¸ä¼šé‡åˆ°è¿™æ ·çš„æƒ…å†µï¼šä¸€ä¸ªå€¼çš„ç±»åž‹å¯èƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯èƒ½æ˜¯æ•°å€¼ã€‚é‚£æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨types.unionå®šä¹‰è”åˆç±»åž‹ï¼š types.union(types.number, types.string);è”åˆç±»åž‹å¯ä»¥æœ‰ä»»æ„ä¸ªè”åˆçš„ç±»åž‹ã€‚ types.literalå­—é¢å€¼ç±»åž‹å¯ä»¥é™åˆ¶å­˜å‚¨çš„å†…å®¹ä¸Žç»™å®šçš„å€¼ä¸¥æ ¼ç›¸ç­‰ã€‚æ¯”å¦‚ä½¿ç”¨types.literal(â€˜maleâ€™)å®šä¹‰çš„çŠ¶æ€å€¼åªèƒ½ä¸ºâ€™maleâ€™ã€‚å®žé™…ä¸Šï¼Œä¸Šé¢æåˆ°è¿‡çš„types.nullä»¥åŠtypes.undefinedå°±æ˜¯å­—é¢å€¼ç±»åž‹ï¼š const NullType = types.literal(null);const UndefinedType = types.literal(undefined);æ­é…è”åˆç±»åž‹ï¼Œå¯ä»¥è¿™æ ·å®šä¹‰ä¸€ä¸ªæ€§åˆ«ç±»åž‹ï¼šconst GenderType = types.union(types.literal(â€˜maleâ€™), types.literal(â€˜femaleâ€™)); types.enumerationæžšä¸¾ç±»åž‹å¯ä»¥çœ‹ä½œæ˜¯è”åˆç±»åž‹ä»¥åŠå­—é¢å€¼ç±»åž‹çš„ä¸€å±‚å°è£…ï¼Œæ¯”å¦‚ä¸Šé¢çš„æ€§åˆ«å¯ä»¥ä½¿ç”¨æžšä¸¾ç±»åž‹æ¥å®šä¹‰ï¼šconst GenderType = types.enumeration(â€˜Genderâ€™, [â€˜maleâ€™, â€˜femaleâ€™]);æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¯é€‰çš„ï¼Œè¡¨ç¤ºæžšä¸¾ç±»åž‹çš„åç§°ã€‚ç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥çš„æ˜¯å­—é¢å€¼æ•°ç»„ã€‚åœ¨TypeScriptçŽ¯å¢ƒä¸‹ï¼Œå¯ä»¥è¿™æ ·æ­é…TypeScriptæžšä¸¾ä½¿ç”¨ï¼š 123456enum Gender &#123; male, female&#125;const GenderType = types.enumeration&lt;Gender&gt;('Gender', Object.values(Gender)); types.maybeå®šä¹‰ä¸€ä¸ªå¯èƒ½ä¸ºundefinedçš„å­—æ®µï¼Œå¹¶è‡ªå¸¦é»˜è®¤å€¼undefinedã€‚ 123types.maybe(type)// ç­‰åŒäºŽtypes.optional(types.union(type, types.literal(undefined)), undefined) types.maybeNullä¸Žtypes.maybeç±»ä¼¼ï¼Œå°†undefinedæ›¿æ¢æˆäº†nullã€‚ 123types.maybe(type)// ç­‰åŒäºŽtypes.optional(types.union(type, types.literal(null)), null) types.frozenfrozenæ„ä¸ºâ€œå†»ç»“çš„â€ï¼Œtypes.frozenæ–¹æ³•ç”¨æ¥å®šä¹‰ä¸€ä¸ªimmutableç±»åž‹ï¼Œå¹¶ä¸”å­˜æ”¾çš„å€¼å¿…é¡»æ˜¯å¯åºåˆ—åŒ–çš„ã€‚ å½“æ•°æ®çš„ç±»åž‹ä¸ç¡®å®šæ—¶ï¼Œåœ¨TypeScriptä¸­é€šå¸¸å°†å€¼çš„ç±»åž‹è®¾ç½®ä¸ºanyï¼Œè€Œåœ¨MSTä¸­ï¼Œå°±éœ€è¦ä½¿ç”¨types.frozenå®šä¹‰ã€‚ 12awardPosition: types.frozen(),notices: types.array(types.frozen()), åœ¨MSTçœ‹æ¥ï¼Œä½¿ç”¨types.frozenå®šä¹‰ç±»åž‹çš„çŠ¶æ€å€¼æ˜¯ä¸å¯å˜çš„ï¼Œæ‰€ä»¥ä¼šå‡ºçŽ°è¿™æ ·çš„æƒ…å†µï¼š 12model.anyData = &#123;a: 1, b: 2&#125;; // ok, reactivemodel.anyData.b = 3; // not reactive ä¹Ÿå°±æ˜¯åªæœ‰è®¾ç½®ä¸€ä¸ªæ–°çš„å€¼ç»™è¿™ä¸ªå­—æ®µï¼Œç›¸å…³çš„observeræ‰ä¼šå“åº”çŠ¶æ€çš„æ›´æ–°ã€‚è€Œä¿®æ”¹è¿™ä¸ªå­—æ®µå†…éƒ¨çš„æŸä¸ªå€¼ï¼Œæ˜¯ä¸ä¼šè¢«æ•æ‰åˆ°çš„!! types.lateæ»žåŽç±»åž‹æœ‰æ—¶å€™ä¼šå‡ºçŽ°è¿™æ ·çš„éœ€æ±‚ï¼Œéœ€è¦ä¸€ä¸ªModel Aï¼Œåœ¨Aä¸­ï¼Œå­˜åœ¨ç±»åž‹ä¸ºAæœ¬èº«çš„å­—æ®µã€‚ å¦‚æžœè¿™æ ·å†™ 1234const A = types .model('A', &#123; a: types.maybe(A), // ä½¿ç”¨mabeé¿å…æ— é™å¾ªçŽ¯ &#125;); ä¼šæç¤ºBlock-scoped variable â€˜Aâ€™ used before its declarationï¼Œä¹Ÿå°±æ˜¯åœ¨Aå®šä¹‰å®Œæˆä¹‹å‰å°±è¯•å›¾ä½¿ç”¨ä»–ï¼Œè¿™æ ·æ˜¯ä¸è¢«å…è®¸çš„ è¿™ä¸ªæ—¶å€™å°±éœ€è¦ä½¿ç”¨types.lateï¼š 1234const A = types .model('A', &#123; a: types.maybe(types.late(() =&gt; A)) &#125;); types.lateéœ€è¦ä¼ å…¥ä¸€ä¸ªæ–¹æ³•ï¼Œåœ¨æ–¹æ³•ä¸­è¿”å›žAï¼Œè¿™æ ·å°±å¯ä»¥é¿å¼€ä¸Šé¢æŠ¥é”™çš„é—®é¢˜ã€‚ types.refinementæçº¯ç±»åž‹ types.refinementå¯ä»¥åœ¨å…¶ä»–ç±»åž‹çš„åŸºç¡€ä¸Šï¼Œæ·»åŠ é¢å¤–çš„ç±»åž‹æ ¡éªŒè§„åˆ™ã€‚ æ¯”å¦‚éœ€è¦å®šä¹‰ä¸€ä¸ªemailå­—æ®µï¼Œç±»åž‹ä¸ºå­—ç¬¦ä¸²ä½†å¿…é¡»æ»¡è¶³emailçš„æ ‡å‡†æ ¼å¼ï¼Œå°±å¯ä»¥è¿™æ ·åšï¼š 12345const EmailType = types.refinement( 'Email', types.string, (snapshot) =&gt; /^[a-zA-Z_1-9]+@\.[a-z]+/.test(snapshot), // æ ¡éªŒæ˜¯å¦ç¬¦åˆemailæ ¼å¼); å®žæ“MST (mobx-state-tree)ï¼Œé¡¾åæ€ä¹‰æ˜¯Reactç”¨äºŽç®¡ç†çŠ¶æ€çš„çŠ¶æ€æ ‘ç»“æž„ï¼Œæ ¹æ®æ¯ä¸ªç»„ä»¶æž„å»ºå•ç‹¬çš„çŠ¶æ€æ ‘ç»“æž„ï¼Œä¸€èˆ¬å»ºè®®çŠ¶æ€æ ‘ç»“æž„å’ŒæŽ¥å£æˆ–è€…æŽ¨é€ä¿æŒä¸€è‡´çš„æ•°æ®ç»“æž„ï¼Œä¾¿äºŽæ›´æ–°ç»´æŠ¤ã€‚åœ¨è¯·æ±‚æŽ¥å£å’ŒæŽ¨é€æ—¶ï¼Œåªéœ€è¦æ›´æ–°å¯¹åº”çš„stateï¼Œå…¶ä»–çš„é¡µé¢çº§åˆ«çš„æ¸²æŸ“ç­‰äº¤ç»™ observer ç›‘å¬çš„ç»„ä»¶ã€‚ç®€å•ä½¿ç”¨æµç¨‹å¦‚ä¸‹â¬‡ï¸ &#123;.line-numbers&#125;123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175// 1 - å°è£…useContext/*** * * åˆ›å»ºæ€»çš„storeæ–‡ä»¶å¤¹ * ./store * ./store/index.ts * ./store/room.ts */// 1-1 ./store/index.tsimport &#123; useContent, createContext &#125; from 'react'import &#123; types, Instance, onSnapshot, applySnapshot&#125; from 'mobx-state-tree'import room from './room'const RootModel = types.modal('RootModel', &#123; room: room.Modal, // è¿˜å¯ä»¥æ‰©å±•ç›¸å…³å…¶ä»–çš„store // users: users.Modal,&#125;).action(self =&gt; &#123; return &#123;&#125;&#125;)let rootStore;export const initStore = (&#123;roomId, allRoomInfo&#125;) =&gt; &#123; const _rootStore = rootStore ?? RootModal.create(&#123; room: assign(&#123;&#125;, room.initStore, &#123; roomId: roomId, allRoomInfo, &#125;) //users: users.initState, &#125;) if ( typeof window !== 'undefined' ) &#123; window.__store = _rootStore &#125; if (typeof window === 'undefined' ) return _rootStore if (!rootStore) &#123; rootStore = _rootStore // onSnapshot(rootStore, snapshot =&gt; console.log("stage Snapshot: ", snapshot)); &#125; return rootStore;&#125;export type RootInstance = Instance&lt;typeof RootStore&gt;const RootStoreContext = createContext&lt;null || RootInstance&gt;(null);export const Provider = RootStoreContext.provider;export const useStore = () =&gt; &#123; const store = useContext(RootStoreContext); if (store === null) &#123; throw new Error('Store cannot be null, please add a context provider'); &#125; return store;&#125;export const getStore = () =&gt; &#123; return rootStore;&#125;// åˆ›å»ºå…·ä½“storeï¼ˆroom.tsï¼‰æ–‡ä»¶import &#123; flow, types &#125; from 'mobx-state-tree'import &#123; getStore &#125; from './index'const initState = &#123; roomId: 0, allRoomInfo: &#123;&#125;&#125;const PkModel = types.model('PkModel', &#123;&#125;)const AllRoomInfoModel = types.model('AllRoomInfoModel', &#123; _id: '', pk: types.maybeNull(PkModel)&#125;).views(self =&gt; &#123; return &#123;&#125;&#125;).actions(self =&gt; &#123; return &#123;&#125;&#125;)export const Model = types .model(&#123; roomId: types.number, allRoomInfo: AllRoomInfoModel, &#125;) .views(self =&gt; &#123; return &#123; get hasId() =&gt; &#123; return self._id !== '' &#125;, get isRoomOwner() &#123; let userId = getGlobalStore().userId; return userId &amp;&amp; userId === self.roomId; &#125; &#125; &#125;) .volatile(self=&gt; &#123; return &#123;&#125; &#125;) .actions(self =&gt; &#123; const update = flow(function* () &#123; let res; try &#123; res = yield request.api.get('****/api/room/$&#123;self.roomID&#125;') self.allRoomInfo = res.data &#125; &#125;), const setRoomInfo = (data) =&gt; &#123; self.allRoomInfo = data &#125;, const stopLive = () =&gt; &#123; ... &#125; return &#123; update, setRoomInfo, stopLive, &#125; &#125;)export default &#123; initState, Modal,&#125;// 3-ç»„ä»¶åº”ç”¨import &#123; observer &#125; from 'mobx-react'import &#123; useStore &#125; from '../store'const BeHeadTip = observer(() =&gt; &#123; const &#123; room &#125; = useStore() const &#123; roomId, allRoomInfo, hasId&#125; = room return ( !hsdId ? 'å½“å‰æˆ¿é—´æœªåœ¨å¼€æ’­å“Ÿï½ž' : &lt;StyledBeHead id=&#123; roomId &#125;&gt;ç»„ä»¶å†…å®¹&lt;/StyledBeHead&gt; )&#125;)const StyledBeHead = styled.div` position: relative;`// 4-æŽ¥å£ã€æŽ¨é€æ›´æ–°store// 4-1 æŽ¥å£const loadInfo = () =&gt; &#123; request.api.get('**/api/info_v2').then(res =&gt; &#123; setRoomInfo(res.data) &#125;)&#125;export default &#123; loadInfo &#125;// 4-2 æŽ¨é€const handle = (socket) =&gt; &#123; socket.on('room_info', (msg) =&gt; &#123; setRoomInfo(res.data) &#125;)&#125; å°è£…ä»¥ä¸Šçš„åˆ›é€ storeï¼Œå¯ä»¥ç®€å•å°è£…ä¸‹é€»è¾‘ï¼Œè®©ç¨‹åºå‘˜æ›´ä¸“æ³¨äºŽmodelçš„æž„å»º 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778// utils/create-store.tsimport &#123; Instance &#125; from 'mobx-state-tree'import &#123; createContext, useContext &#125; from 'react'const createStore = ( Model: any, initialState: any ) =&gt; &#123; type IStore = Instance&lt;typeof Model&gt; const store = Model.create(initialState) const StoreContext = createContext&lt;null | IStore&gt;(null) if (typeof window !== 'undefined') &#123; if (window['__Act' + Model.name]) &#123; window['__Act' + Model.name + random(100000, 10000)] = store &#125; else &#123; window['__Act' + Model.name] = store &#125; &#125; const useStore = ():IStore =&gt; &#123; const currentStore = useContext(StoreContext) if (currentStore === null ) &#123; throw new Error(`$&#123;Model.name&#125; Store cannot be null, please add a context provider`) &#125; return currentStore; &#125; return &#123; store, Provider: StoreContext.Provider, useStore, &#125;&#125;export default createStore;//å…·ä½“æ–‡ä»¶ä½¿ç”¨// **/store.tsximport &#123; createStore &#125; from '@utils/create-store'export const Model = types .model('Model', &#123; currentTab: '', list: [], &#125;) .action((self) =&gt; &#123; const setCurrTab = (tab: string) =&gt; &#123; self.currentTab = tab &#125; return &#123; setCurrTab &#125; &#125;)interface IModelSnapshotIn extend SnapshotIn&lt;typeof Model&gt;&#123;&#125;// const initState: IModelSnapshotIn = &#123;&#125;const initState = &#123; currentTab: 'home', list: []&#125;const &#123; store, Provider, useStore &#125; = createStore(Model, initState)export &#123; store, Provider, useStore &#125;// é¡µé¢å¼•ç”¨store// **/index.tsximport &#123; useStore &#125; from './store'const &#123; currentTab, setCurrTab &#125; = useStore() æ€»ç»“åœ¨æ•´ä¸ªç¨‹åºæ‰§è¡Œä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦æŽ§åˆ¶æ•°æ®çŠ¶æ€çš„æ›´æ–°ï¼Œä»¥åŠåœ¨MSTä¸­å¤„ç†å¥½æ•°æ®çš„é€»è¾‘ï¼Œæš´éœ²å‡ºç›´æŽ¥å¯ä»¥ä½¿ç”¨çš„æ–¹æ³•ã€‚ä¾‹å¦‚ hasId, MSTä¸­çš„ views ç›¸å½“äºŽ Vue ä¸­çš„ è®¡ç®—å±žæ€§ï¼Œæ ¹æ®ä¾èµ–å€¼çš„å˜åŒ–ï¼Œè®¡ç®—æœ€æ–°çš„ç»“æžœã€‚æ•°æ®çš„æ›´æ–°åªèƒ½åœ¨ actions ä¸­æš´éœ²çš„æ–¹æ³•ä¸­åŽ»å®žçŽ°ã€‚åœ¨é¢å¯¹å…·æœ‰éžå¸¸å¤æ‚çŠ¶æ€çš„å¤§åž‹é¡¹ç›®æ—¶ï¼Œå¯ä»¥æé«˜å¼€å‘æ•ˆçŽ‡ã€‚]]></content>
      <categories>
        <category>é»˜è®¤</category>
      </categories>
      <tags>
        <tag>ä¹ˆä¹ˆç›´æ’­</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¹ˆä¹ˆç›´æ’­-æ€»ç»“]]></title>
    <url>%2F2021%2F06%2F07%2Fsummary-meme%2F</url>
    <content type="text"><![CDATA[åºè¨€ç®€å•è®°å½•ä¸€ä¸‹åœ¨ä¹ˆä¹ˆç›´æ’­é‡åˆ°çš„é—®é¢˜ä»¥åŠè§£å†³åŠžæ³•ï¼Œé¡¹ç›®æŠ€æœ¯æ ˆè·¨åº¦æ¯”è¾ƒå¤§ï¼Œæœ‰ 6-7 å¹´å‰ jquery é¡¹ç›®ï¼Œä¹Ÿæœ‰ React + MSTï¼ˆmobx state treeï¼‰ + SSR é¡¹ç›®ï¼Œè¿˜æœ‰çº¯ React é¡¹ç›®ï¼Œé‡åˆ°çš„é—®é¢˜æ¯”è¾ƒå¹¿æ³›ï¼Œè®°å½•ä¸€ä¸‹å¸¸è§çš„é—®é¢˜ï¼Œå¸®åŠ©å­¦ä¹ ã€‚ React çš„æ›´æ–°æœºåˆ¶Ref çš„ä¸€äº›ç”¨æ³•å—æŽ§ç»„å»ºå’Œéžå—æŽ§ç»„ä»¶å‘½åç©ºé—´Canvas å®žçŽ°å¼¹å¹•ç»„ä»¶ å®žçŽ°å¼¹å¹•çš„æ ¸å¿ƒæ˜¯ Canvas çš„ measureText()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¯ä»¥è®¡ç®—å‡ºç”»å¸ƒä¸Šå­—ä½“çš„å®½åº¦ï¼Œç”±äºŽå¼¹å¹•çš„å†…å®¹ä¸€èˆ¬æ˜¯ç”± ç›¸å¯¹å›ºå®šçš„å›¾ç‰‡åŠ æœªçŸ¥é•¿åº¦çš„æ–‡æ¡ˆæž„æˆï¼Œæ¸²æŸ“å¤æ‚çš„å•æ¡å¼¹å¹•é¦–å…ˆéœ€è¦è§£å†³å¼¹å¹•æ€»é•¿åº¦ï¼Œæ‹¿åˆ°äº†æ€»é•¿åº¦ï¼Œé‚£ä¹ˆä¸ç®¡æ˜¯æ€»ä½“çš„å¼¹å¹•èƒŒæ™¯è¿˜æ˜¯å›¾ç‰‡æ–‡æ¡ˆçš„æœªçŸ¥éƒ½èƒ½ å‡†ç¡®æ— è¯¯çš„æ¸²æŸ“å‡ºæ¥ï¼ŒReact å¯ä»¥æŠŠåŠŸèƒ½åšæˆä¸€ä¸ªç»„ä»¶ï¼Œä¸€æ¬¡å®Œæˆï¼Œå¤šæ¬¡å¤ç”¨ï¼Œè¿™é‡Œæˆ‘ç®€å•åˆ—ä¸¾ä¸¤ç§å¼¹å¹•çš„å®žçŽ°ï¼Œä¸€ç§æ˜¯æ™®é€šçš„å¼¹å¹•ï¼Œæž„æˆæ˜¯èƒŒæ™¯è‰² + ç”¨æˆ·å¤´åƒ + ç›¸å¯¹å›ºå®šçš„æ–‡æ¡ˆï¼ˆæ¯”å¦‚æŠ½å¥–å¼¹å¹•ï¼Œå¤´åƒ + XXX åœ¨ VVV æ´»åŠ¨ä¸­ æŠ½ä¸­äº† AAAA x 99 æ¬¡ï¼‰ï¼Œ ä¸€ç§æ˜¯ç‰¹æ®Šå¼¹å¹•ï¼Œæ¯”å¦‚æ˜¥èŠ‚æœŸé—´äº§å“ä¸Šçº¿äº†ç¥ˆç¦é€ç¤¼éœ€æ±‚ï¼Œç”¨æˆ·å‘é€ç¥ç¦è¯­ï¼Œç„¶åŽç«‹å³åœ¨å±å¹•ä¸Šå¼¹å¹•å½¢å¼å‡ºçŽ°ï¼Œæ¯æ¡ç¥ç¦è¯­å¼¹å¹•çš„èƒŒæ™¯æ ·å¼ä¸åŒï¼ŒðŸˆ¶ï¸ æ–°æ˜¥å¯¹è”ã€ç‡•å­é«˜é£žã€æŸ³æ ‘çº¸æ¡ç­‰ï¼Œåˆ‡æ¯ä¸ªç”¨æˆ·è¾“å…¥çš„ç¥ç¦è¯­é•¿åº¦å–å†³äºŽç”¨æˆ·è‡ªå·±ï¼Œæœ‰æ—¶å€™ä¸€æ¡å¼¹å¹•å°±å‡ ä¸ªå­—ï¼Œæœ‰çš„æœ‰å‡ åå­—ï¼ŒçŸ¥é“æ¯æ¡å¼¹å¹•çš„é•¿åº¦æœ‰ä¸¤ä¸ªç”¨å¤„ï¼Œä¸€æ˜¯å¼¹å¹•çš„èƒŒæ™¯ä½ç½®æ¸²æŸ“ï¼Œè€Œæ˜¯å¼¹å¹•é‡‡ç”¨å››è¡Œå¹¶å­˜çš„å½¢å¼ï¼Œé‚£ä¹ˆå¼¹å¹•æ’å…¥å“ªä¸€è¡Œä¹Ÿå–å†³äºŽå“ªä¸€è¡Œçš„å¼¹å¹•ç¨€ç–ç¨‹åº¦ï¼Œè¯ä¸å¤šå°‘ï¼Œä¸Šå›¾ä¸Šä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477// common å¼¹å¹•çš„å¼•ç”¨æ–‡ä»¶export function getDevicePixelRatio(): number &#123; // Fix fake window.devicePixelRatio on mobile Firefox const isFirefox = navigator.userAgent.toLowerCase().indexOf('firefox') &gt; -1 if (window.devicePixelRatio !== undefined &amp;&amp; !isFirefox) &#123; return window.devicePixelRatio &#125; else if (window.matchMedia) &#123; const mediaQuery = (v: string, ov: string) =&gt; &#123; return ( '(-webkit-min-device-pixel-ratio: ' + v + '),' + '(min--moz-device-pixel-ratio: ' + v + '),' + '(-o-min-device-pixel-ratio: ' + ov + '),' + '(min-resolution: ' + v + 'dppx)' ) &#125; if (window.matchMedia(mediaQuery('1.5', '3/2')).matches) &#123; return 1.5 &#125; if (window.matchMedia(mediaQuery('2', '2/1')).matches) &#123; return 2 &#125; if (window.matchMedia(mediaQuery('0.75', '3/4')).matches) &#123; return 0.7 &#125; &#125; return 1&#125;// barrage-spring.tsximport &#123; cancelAnimation &#125; from '@utils/media'import &#123; getDevicePixelRatio &#125; from '@core/client'import &#123; max &#125; from '@utils/tool' const roundRect = function (ctx, left, top, width, height, r) &#123; const pi = Math.PI; ctx.beginPath(); ctx.arc(left + r, top + r, r, -pi, -pi / 2); ctx.arc(left + width - r, top + r, r, -pi / 2, 0); ctx.arc(left + width - r, top + height - r, r, 0, pi / 2); ctx.arc(left + r, top + height - r, r, pi / 2, pi); ctx.closePath(); &#125; const circleImg = function (ctx, img, l, t, r)&#123; const d = 2 * r ctx.save(); ctx.beginPath() ctx.arc(l + r + 30, t + r - 3, r, 0, 2 * Math.PI) ctx.closePath() ctx.clip(); ctx.drawImage(img, l + 30, t - 3, d, d); ctx.restore(); &#125; const leftBg = function (ctx, leftImg, left, top, width, height) &#123; ctx.save() ctx.drawImage(leftImg, left, top, width, height) // height 94 ctx.restore(); &#125; const middleBg = function (ctx, img, left, top, width, height) &#123; ctx.save() ctx.drawImage(img, left+112, top, width, height) ctx.restore(); &#125; const rightBg = function (ctx, img, left, top, width, height) &#123; ctx.save() ctx.drawImage(img, left, top, width, height) ctx.restore(); &#125; // const preImg = (url, callback, options) =&gt; &#123; // const &#123;x, y, w, h&#125; = options // const img = new Image() // img.src = testLeft || url // if (img.complete) &#123; // callback.call(img, x, y, w, h) // return // &#125; // img.onload = () =&gt; &#123; // callback.call(img, x, y, w, h) // &#125; // &#125; const getPxRatio = () =&gt; &#123; const c = document.createElement("canvas"), ctx = c.getContext("2d"), dpr = getDevicePixelRatio() || 1, bsr = ctx['webkitBackingStorePixelRatio'] || ctx['mozBackingStorePixelRatio'] || ctx['msBackingStorePixelRatio'] || ctx['oBackingStorePixelRatio'] || ctx['backingStorePixelRatio'] || 1; return dpr / bsr; &#125; export class Barrage &#123; constructor(option) &#123; const &#123; canvasId, onPalyFinish &#125; = option const pixelRatio = max([getPxRatio(), 2]) this.pxRatio = pixelRatio; // ç¼©æ”¾å€æ•°ï¼Œ1ä¼šç³Š this.canvas = document.getElementById(canvasId); this.canvas.width = this.w = this.canvas.width * pixelRatio; this.canvas.height = this.h = this.canvas.height * pixelRatio; this.drawing = true this.finishCount = 0 this.ctx = this.canvas.getContext('2d'); this.style = &#123; // å¼¹å¹•æ ·å¼ height: 47 * pixelRatio, // å¼¹å¹•é«˜åº¦ // æ—§ç‰ˆé«˜åº¦29 imgBgWidth: 56 * pixelRatio, // èƒŒæ™¯å›¾ç‰‡çš„å®½åº¦(å·¦ã€å³) fontSize: 12 * pixelRatio, // å­—ä½“å¤§å° marginBottom: 20 * pixelRatio, // å¼¹å¹• margin-bottom paddingX: 15 * pixelRatio, // å¼¹å¹• padding x avatarWidth: 20 * pixelRatio, // å¤´åƒå®½åº¦ ellipsisMaxWidth: 100 * pixelRatio, offsetRight: 56 * pixelRatio // å³èƒŒæ™¯åç§»é‡ &#125; this.ctx.font = this.style.fontSize + 'px PingFangSC-Regular'; this.onPalyFinish = onPalyFinish this.barrageList = []; // å¼¹å¹•åˆ—è¡¨ this.rowStatusList = []; // è®°å½•æ¯è¡Œæ˜¯å¦å¯æ’å…¥ï¼Œé˜²æ­¢é‡å ã€‚ è¡Œå·ä¸ºå¯æ’å…¥ falseä¸ºä¸å¯æ’å…¥ let rowLength = Math.floor(this.h / (this.style.height + this.style.marginBottom)); for (var i = 0; i &lt; rowLength; i++) &#123; this.rowStatusList.push(i) &#125; &#125; shoot(value) &#123; const &#123; height, avatarWidth, fontSize, marginBottom, paddingX, ellipsisMaxWidth &#125; = this.style; const &#123; img, sortArr, t1, t2, t3, t4 &#125; = value; const ellipsisT2 = this.getEllipsisText(t2) let row = this.getRow(); let color = '#7C0102'; let offset = this.pxRatio; let offsetNew = 30 let w_0 = paddingX; // å¤´åƒå¼€å§‹ä½ç½® let w_1 = w_0 + avatarWidth + 8 + offsetNew + 10; // t1æ–‡å­—å¼€å§‹ä½ç½® let w_2 = w_1 + Math.ceil(this.ctx.measureText(t1).width) + 8; // t2æ–‡å­—å¼€å§‹ä½ç½® let w_3 = w_2 + Math.ceil(this.ctx.measureText(ellipsisT2).width) + 8; // t3æ–‡å­—å¼€å§‹ä½ç½® let w_4 = w_3 + Math.ceil(this.ctx.measureText(t3).width) + 8; // t4æ–‡å­—å¼€å§‹ä½ç½® let w_5 = w_4 + Math.ceil(this.ctx.measureText(t4).width) + paddingX + 8; // å¼¹å¹•æ€»é•¿åº¦ let barrage = &#123; color, row, offset, top: row * (height + marginBottom), left: this.w, width: [w_0, w_1, w_2, w_3, w_4, w_5], value, ellipsisT2, &#125; this.barrageList.push(barrage); &#125; draw() &#123; if (!this.drawing) &#123; return &#125; if (!!this.barrageList.length) &#123; this.ctx.clearRect(0, 0, this.w, this.h); for (let i = 0, barrage; barrage = this.barrageList[i]; i++) &#123; // å¼¹å¹•æ»šå‡ºå±å¹•ï¼Œä»Žæ•°ç»„ä¸­ç§»é™¤ if (barrage.left + barrage.width[5] &lt;= -25) &#123; this.barrageList.splice(i, 1); this.finishCount ++; i--; continue; &#125; // å¼¹å¹•å®Œå…¨æ»šå…¥å±å¹•ï¼Œå½“å‰è¡Œå¯æ’å…¥ if (!barrage.rowFlag) &#123; if ((barrage.left + barrage.width[5]) &lt; this.w - 45) &#123; // this.rowStatusList[barrage.row] = barrage.row; barrage.rowFlag = true; &#125; &#125; barrage.left -= barrage.offset; this.drawBarrage(barrage); &#125; &#125; this.reqAnimeId = requestAnimationFrame(this.draw.bind(this)); &#125; restartDraw() &#123; this.drawing = true; this.draw() &#125; clearDraw() &#123; this.drawing = false cancelAnimation(this.reqAnimeId) &#125; drawBarrage(barrage) &#123; const &#123; height, avatarWidth, fontSize, ellipsisMaxWidth &#125; = this.style; const &#123; value: &#123; img, sortArr, t1, t3, t4,&#125;, ellipsisT2, color, row, left, top, offset, width, &#125; = barrage; // ç”»æ¡†å­ // roundRect(this.ctx, left, top, width[5], height, height / 2, avatarWidth) // this.ctx.fillStyle = 'rgba(0,0,0,0.45)'; // this.ctx.fill(); // -- ç”»å·¦è¾¹èƒŒæ™¯ leftBg(this.ctx, sortArr[0], left , top, this.style.imgBgWidth, height) middleBg(this.ctx, sortArr[1], left , top, width[2]-width[1], height) rightBg(this.ctx, sortArr[2], left + width[5]- this.style.offsetRight , top, this.style.imgBgWidth, height ) // left, top, width[1], height // ç”»å¤´åƒ // circleImg(this.ctx, img, left + width[0], top + (height - avatarWidth) / 2, avatarWidth/2) circleImg(this.ctx, sortArr[3], left + width[0], top + (height - avatarWidth) / 2, avatarWidth/2) // æ–°çš„topåç§»é‡ 15 const offsetYNew = -4 const paddingTop = (height - fontSize) / 2 - 2 this.ctx.fillStyle = color; this.ctx.fillText(t1, left + width[1], top + fontSize + paddingTop + offsetYNew); this.ctx.fillStyle = '#CFFCFC'; this.ctx.fillText(ellipsisT2, left + width[2], top + fontSize + paddingTop); this.ctx.fillStyle = color; this.ctx.fillText(t3, left + width[3], top + fontSize + paddingTop); this.ctx.fillStyle = '#FFFF33'; this.ctx.fillText(t4, left + width[4], top + fontSize + paddingTop); &#125; getRow() &#123; let emptyRowList = this.rowStatusList.filter(d =&gt; /\d/.test(d)); // æ‰¾å‡ºå¯æ’å…¥è¡Œ let row = emptyRowList[Math.floor(Math.random() * emptyRowList.length)]; // éšæœºé€‰ä¸€è¡Œ this.rowStatusList[row] = false; return row; &#125; haveEmptyRow() &#123; let emptyRowList = this.rowStatusList.filter(d =&gt; /\d/.test(d)); // æ‰¾å‡ºå¯æ’å…¥è¡Œ return !!emptyRowList.length; &#125; getEllipsisText(text) &#123; const &#123; ellipsisMaxWidth: maxWidth &#125; = this.style if (this.ctx.measureText(text).width &lt;= maxWidth) &#123; return text &#125; const textArr = text.split('');//å½“å‰å‰©ä½™çš„å­—ç¬¦ä¸² for (let m = 1; m &lt;= textArr.length; m++) &#123; if (this.ctx.measureText(textArr.slice(0, m)).width &gt; maxWidth) &#123; return textArr.slice(0, m).join('') + '...' &#125; &#125; &#125; &#125; // danmu.tsx å¼¹å¹•ç»„ä»¶ï¼Œå¯ä»¥ç›´æŽ¥è°ƒç”¨ &lt;danmu /&gt; import React, &#123; useEffect, useRef &#125; from 'react' import styled from 'styled-components' import &#123; defAvatarNew &#125; from '@constants' import request from '@core/request' // import &#123; Barrage &#125; from '@utils/barrage' import &#123; Barrage &#125; from '@pages/act_spring_festival/barrage-spring' import &#123; choice &#125; from '@utils/tool' import &#123; actions &#125; from './config' export default (props: any) =&gt; &#123; const storeRef = useRef&lt;any&gt;(&#123; timer: 0, finishCount: 0, barrage: null, &#125;) useEffect(() =&gt; &#123; fetchData() &#125;, []) useEffect(() =&gt; &#123; const barrage = new Barrage(&#123; canvasId: 'act-spring-barrage' &#125;) barrage.draw() storeRef.current.barrage = barrage return () =&gt; &#123; barrage.clearDraw() clearTimeout(storeRef.current.timer) &#125; &#125;, []) const fetchData = () =&gt; &#123; request(actions.wishList).then((resData) =&gt; &#123; const items = resData || [] if (items &amp;&amp; items[0]) &#123; shootBarrage(items[0]) setTimeout(() =&gt; shootBarrage(items[1]), 500) startBarrage(2, items) &#125; &#125;) &#125; const startBarrage = (activeIndex: number, source: any[]) =&gt; &#123; const &#123; timer, barrage &#125; = storeRef.current clearTimeout(timer) storeRef.current.timer = setTimeout(() =&gt; &#123; let flag = false if (source[activeIndex]) &#123; flag = shootBarrage(source[activeIndex]) &#125; if (barrage.finishCount &amp;&amp; barrage.finishCount &gt;= source.length - 3) &#123; barrage.finishCount = 0 fetchData() &#125; startBarrage(!flag ? activeIndex : activeIndex + 1, source) &#125;, choice([1000, 1800])) &#125; const shootBarrage = (currentItem: any) =&gt; &#123; const barrage = storeRef.current.barrage if (!barrage.haveEmptyRow() || !currentItem) &#123; return false &#125; const &#123; pic = defAvatarNew, wish = '' &#125; = currentItem const data = &#123; t1: wish, t2: '', t3: '', t4: '', &#125; // --ä¸€èµ·åˆå§‹åŒ–èƒŒæ™¯å›¾ const imgConf1 = [ 'https://img.sumeme.com/28/4/1612232722204.png', 'https://img.sumeme.com/8/0/1612232705544.png', 'https://img.sumeme.com/14/6/1612232681614.png', pic, ] const imgConf2 = [ 'https://img.sumeme.com/32/0/1612232775520.png', 'https://img.sumeme.com/32/0/1612232762208.png', 'https://img.sumeme.com/54/6/1612232743414.png', pic, ] const imgConf3 = [ 'https://img.sumeme.com/27/3/1612232818395.png', 'https://img.sumeme.com/48/0/1612232804656.png', 'https://img.sumeme.com/32/0/1612232789280.png', pic, ] // const imgConf4 = [ // 'https://img.sumeme.com/25/1/1612232866777.png', // 'https://img.sumeme.com/32/0/1612232846432.png', // 'https://img.sumeme.com/33/1/1612232833441.png', // pic, // ] const imgConfAll = [imgConf1, imgConf2, imgConf3] const imgArray = choice(imgConfAll) const receiveArray: any[] = [] // let $myContent = document.getElementById("myContent"); // let [imgW, imgH] = [300, 300]; // let Canvas = document.createElement('canvas'); // let ctx = Canvas.getContext("2d"); // let scaleBy = 2; // Canvas.width = imgW * scaleBy; // Canvas.height = imgH * scaleBy; imgArray.forEach((e: any, idx: number) =&gt; &#123; const img = new Image() img.src = e img.setAttribute('crossOrigin', 'Anonymous') img.addEventListener('load', () =&gt; &#123; // ctx.drawImage(img, 0, 0, imgW * scaleBy, imgH * scaleBy); img.id = 'img' + idx receiveArray.push(img) // å°†ç»˜åˆ¶çš„imgèŠ‚ç‚¹æ”¶é›†åˆ°æ•°ç»„é‡Œï¼Œè¿™é‡Œçš„é¡ºåºå¯èƒ½å’ŒimgArrayçš„é¡ºåºä¸ä¸€æ · if (receiveArray.length === imgArray.length) &#123; // æ‰€æœ‰å›¾ç‰‡loadå¹¶ç»˜åˆ¶å®Œæˆ const sortArr = new Array() receiveArray.forEach((ex) =&gt; &#123; // å°†æ‰€æœ‰ç»˜åˆ¶å›¾ç‰‡æŒ‰imgArrayé¡ºåºæŽ’åº sortArr[ex.id.split('img')[1]] = ex &#125;) barrage.shoot(&#123; sortArr, ...data, &#125;) // sortArr.forEach(ex2 =&gt; &#123; // $myContent.appendChild(ex2) // &#125;) &#125; &#125;) &#125;) // const img = new Image() // img.setAttribute('crossOrigin', 'anonymous') // const data = &#123; // t1: wish, // t2: '', // t3: '', // t4: '', // &#125; // img.onload = () =&gt; &#123; // barrage.shoot(&#123; // img, // ...data, // &#125;) // &#125; // img.onerror = () =&gt; &#123; // barrage.finishCount++ // &#125; // let pic1 = 'https://img.sumeme.com/27/3/1611904142299.png' // console.log('---', pic) // img.src = pic1 return true &#125; return ( &lt;StyledBarrage&gt; &lt;canvas id="act-spring-barrage" height="250px" /&gt; &lt;/StyledBarrage&gt; ) &#125; export const StyledBarrage = styled.div` position: absolute; bottom: -120px; width: 750px; height: 550px; /* z-index: 99999; */ canvas &#123; width: 100%; height: 100%; &#125; ` æŠ½ç©ºæŠŠè¿™ä¸ªå¼¹å¹•å†™ä¸ª demo ï¼Œå…‰å¹²å·´å·´çš„æ–‡å­—æ˜¯åœ¨éš¾ä»¥ç†è§£å•Š Node çš„ç‰ˆæœ¬æŽ§åˆ¶ è¿™ä¸ªä¸€èˆ¬ä½¿ç”¨ nvm æˆ–è€… n å‘½ä»¤ ç§»åŠ¨ç«¯å’Œ H5 çš„æ¡¥æŽ¥é€šä¿¡ ä½¿ç”¨ jsBridge è¿›è¡Œ H5 å’Œç§»åŠ¨ç«¯çš„é€šä¿¡ã€‚å…·ä½“åŽé¢æ•´ç†ä¸€ä¸‹ã€‚ ç›´æ’­ç¤¼ç‰©çš„åŠ¨ç”»æ’­æ”¾é˜Ÿåˆ—å®žçŽ°Video æ’­æ”¾ mp4 çš„æ³¨æ„ç‚¹ react ä¸­æ’­æ”¾ mp4 æ ¼å¼ï¼Œä¼šæœ‰ä¸€äº› iOS æœºåž‹çš„å…¼å®¹é—®é¢˜ï¼Œä¸å¦‚ iOS ä¸èƒ½è‡ªåŠ¨æ’­æ”¾ç­‰ 12345678910111213141516171819202122//Reactä¸­æ’­æ”¾mp4çš„æƒ…å†µï¼Œä¸€å¸®æƒ…å†µä¸‹æ’­æ”¾GIFæˆ–è€…SVGA// ä»£ç å¦‚ä¸‹&lt;div className="video-box" dangerouslySetInnerHTML=&#123;&#123; __html: ` &lt;video id="entry-video" poster="https://img.sumeme.com/16/0/1624613307152.png" autoPlay x-webkit-airplay="allow" x5-video-player-type="h5" webkit-playsinline playsinline muted style="object-fit:fill" &gt; &lt;source src="https://img.sumeme.com/swf/Render6-16.mp4" type="video/mp4"&gt; &lt;/video&gt; `, &#125;&#125;/&gt; posterå±žæ€§å¯ä»¥åœ¨è§†é¢‘æœªåŠ è½½å®Œæˆå‰å±•ç¤ºä¸€å¼ å°é¢å›¾ç‰‡ï¼Œè§†é¢‘åŠ è½½åŽè‡ªåŠ¨æ’­æ”¾è§†é¢‘ã€‚hooks å°è£…å…¶å®žç›¸æ¯”è‡ªå·±å°è£…æœ‰é’ˆå¯¹æ€§çš„ hooks å¤–ï¼Œé˜¿é‡Œçš„ ahooks3.0 ä¹Ÿå¯ä»¥ä½¿ç”¨ï¼ŒåŠŸèƒ½è¿˜æ˜¯å€¼å¾—æœŸå¾…çš„React ä¸­æŒ‚è½½æ»‘åŠ¨å‡½æ•°æŠ½å¥–ä¸€äº› CSS12345678910111213141516171819202122232425262728-webkit-tap-highlight-color: rgba(0,0,0,0)// è§£å†³iOSå’ŒiPadè®¾å¤‡ä¸Šç‚¹å‡»çŠ¶æ€å‡ºçŽ°é»˜è®¤è“è‰²é«˜äº®ï¼Œå¾ˆå¸¸è§&amp; + &amp; &#123;&#125;å–å·§ï¼Œé€‰æ‹©éžç¬¬ä¸€ä¸ªå¼€å§‹çš„æ‰€æœ‰åŒç±»åž‹å…ƒç´ font-size: 0;çˆ¶å…ƒç´ è®¾ç½®æ”¹å±žæ€§å¯ä»¥æœ‰æ•ˆè§£å†³è¡Œå†…å…ƒç´ çš„é»˜è®¤é—´è·ï¼Œä¾‹å¦‚spanpadding-bottom: 6%;ol li:before &#123; content:counter(sectioncounter) &quot;ã€&quot;; counter-increment:sectioncounter;&#125;//æœ‰åºå…ƒç´ çš„ç¬¦å·æ›¿æ¢å±•ç¤º.gift-show-area[gift-id=&apos;7777&apos;] &#123;&#125;//å¯ä»¥è¿™æ ·æŸ¥æ‰¾å…ƒç´ background-image: linear-gradient(135deg, red, blue);background-clip: text;-webkit-background-clip: text;color: transparent;// æ–‡å­—é¢œè‰²æ¸å˜::-webkit-input-placeholder// placeholderæ ·å¼æ¬¡ä¿®æ”¹ å¤æ‚è¡¨æ ¼é¡¹åˆå¹¶rowSpan colspan è¡Œåˆ—åˆå¹¶ æŒ‰éœ€åŠ è½½ä¼˜åŒ–é¡¹ç›®å·²ç»å¾ˆåºžå¤§çš„æƒ…å†µä¸‹ï¼Œè¿˜è¦è€ƒè™‘hybridçš„ä½“éªŒæƒ…å†µï¼Œéœ€è¦è¿›è¡Œé¡¹ç›®ä¼˜åŒ–ï¼ŒæŒ‰éœ€åŠ è½½æ¯”è¾ƒé€‚åˆæŸäº›åœºæ™¯ä¸‹ï¼Œè¿™é‡Œé‡‡ç”¨ã€Šreact-intersection-observerã€‹ä¸­çš„hooks useInView æ¥åˆ¤æ–­å…ƒç´ æ˜¯å¦åœ¨å¯è§†çª—å£å†…ã€‚è¿›è€Œåˆ¤æ–­æ˜¯å¦æ¸²æŸ“è¯¥å…ƒç´ ã€‚ 123456789101112131415161718192021222324252627282930313233// è¿™é‡Œå°è£…ä¸€ä¸ªå›¾ç‰‡æŒ‰éœ€åŠ è½½çš„å…¬ç”¨ç»„å»ºimport React from 'react'import &#123; useInView, IntersectionOptions &#125; from 'react-intersection-observer'import styled from 'styled-components' const StyledImg = styled.div` width: 100%; height: 100%;`type Props = IntersectionOptions &amp; &#123; src: string title?: string className?: string children?: any&#125;const LazyImg = (props: Props) =&gt; &#123; const &#123; src, title, className, children, ...configProps &#125; = props const [res, inView] = useInView(&#123; triggerOnce: true, rootMargin: '20px 0', ...configProps, &#125;) return ( &lt;StyledImg ref=&#123;ref&#125; className=&#123;className&#125; title=&#123;title&#125;&gt; &#123;children&#125; &#123;inView &amp;&amp; &lt;img src=&#123;src&#125;/&gt;&#125; &lt;/StyledImg&gt; )&#125;export default LazyImg Modalå°è£…ä¸è®ºæ˜¯PCé¡µé¢ï¼Œè¿˜æ˜¯hybridåŽŸç”Ÿé¡µé¢ï¼Œéƒ½éœ€è¦å¤§é‡å½¢å½¢è‰²è‰²çš„å¼¹çª—æ¥é€šçŸ¥ç”¨æˆ·å¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œå°è£…å‡ ç§å¸¸è§çš„Modal CSS ç‚¹ä¹å›¾æœ€è¿‘å¹´ä¸­å’Œå‘¨å¹´åº†å¼€å§‹ï¼Œé“ºå¤©ç›–åœ°çš„æ´»åŠ¨ã€‚UI è®¾è®¡çš„é£Žæ ¼å’Œä¸€å¾€ä¸å¤ªä¸€æ ·ï¼Œä¸¾ä¸€ä¸ªæ —å­ï¼š åœ¨æŠ•ç¥¨é¡µé¢ä¸­ï¼Œæ¯ä¸ªè¢«æŠ•ç¥¨çš„ä¸»æ’­éƒ½æ˜¯å•ç‹¬çš„ä¸€å¼ ç‰¹æ®ŠèƒŒæ™¯å›¾åŒ…è£¹ï¼Œè¯¥å®¹å™¨å¯èƒ½ä¼šæ ¹æ®è¢«æŠ•ç¥¨äººçš„ä¿¡æ¯é•¿çŸ­ä¸ä¸€ï¼Œä¸è§„åˆ™èƒŒæ™¯è¾¹æ¡†å›¾ä¹Ÿè¦è‡ªåŠ¨é€‚åº”ã€‚ç±»ä¼¼è¿™æ ·çš„éœ€æ±‚ï¼Œä¸€èˆ¬æœ‰è¿™ä¹ˆå‡ ç§æ–¹æ³•å®žçŽ°ï¼š ä¸‰æ®µå›¾é‡å¤å°±æ˜¯æŠŠä¸è§„åˆ™çš„èƒŒæ™¯å›¾åˆ‡æˆä¸‰æ®µã€‚å¤´éƒ¨ã€ä¸­é—´éƒ¨åˆ†ã€åº•éƒ¨ï¼Œä¸­é—´éƒ¨åˆ†åˆ©ç”¨èƒŒæ™¯å›¾çš„ repeat æ¥è‡ªé€‚åº”ï¼Œç¼ºç‚¹å°±æ˜¯ä¸çµæ´»ï¼Œéœ€è¦æ‰¾ UI åˆ‡å›¾ï¼Œé‡Œé¢å†…å®¹çš„é—´è·æŽ§åˆ¶ä¸ç²¾å‡† ç‚¹ä¹å›¾ç‚¹ä¹å›¾æ˜¯ç§»åŠ¨ç«¯çš„ä¸€ç§åšæ³•ï¼Œå°±æ˜¯ä¸€å¼ å›¾åˆ‡å››åˆ€ï¼Œå››ä¸ªè§’ä¸ä¼¸ç¼©ï¼Œä¿æŒåŽŸå›¾æ¯”ä¾‹ã€‚å››æ¡è¾¹è¿›è¡Œä¼¸ç¼©ï¼Œä¸­é—´çš„éƒ¨åˆ†ç”¨æ¥å¡«å……ï¼Œä¸€å…±ä¹ä¸ªéƒ¨åˆ†ï¼Œæ‰€ä»¥ç§°ç‚¹ä¹å›¾ã€‚CSS3 ä¹Ÿå¯ä»¥å®žçŽ°ç‚¹ä¹å›¾ï¼Œä¸”æ•ˆæžœä¸é”™ï¼Œä¸¾ä¸ªä¾‹å­ï¼šå†™ä¸€ä¸ªä¸šåŠ¡ç»„ä»¶ï¼Œåªç”¨æ¥åš wrap åŒ…è£¹ï¼Œç”¨ç‚¹ä¹å›¾ï¼Œè¿™æ ·å…¶ä»–çš„åŒæ ·å¼çš„ç»„ä»¶éƒ½å¯ä»¥å¤ç”¨ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091import React from 'react'import styled from 'styled-components'import &#123; StyledBaseWrap &#125; from '../styled'type Props = &#123; children: any title?: string // title?: string // headerType?: 'icon' | 'pureString'&#125;export default (props: Props) =&gt; &#123; const &#123; children, title = '' &#125; = props if (!children) &#123; return null &#125; return ( &lt;StyledBaseWrap&gt; &lt;i className="bg" /&gt; &#123; title &amp;&amp; ( &lt;div className="title-bg-box"&gt; &lt;i className="title-bg" /&gt; &#123;/* &lt;p className="you-she"&gt;&#123;title&#125;&lt;/p&gt; */&#125; &lt;div className="you-she"&gt;&#123;title&#125;&lt;/div&gt; &lt;/div&gt; ) &#125; &#123;children&#125; &lt;/StyledBaseWrap&gt; )&#125;const StyledBaseWrap = styled.div` position: relative; width: 680px; margin: 0 auto; min-height: 320px; &amp; &gt; * &#123; margin: 0 auto; &#125; .bg &#123; position: absolute; left: 0; right: 0; top: 0; bottom: 0; display: block; border-style: solid; border-width: 130px 340px 190px 340px; border-image-source: url($&#123;require('./images/bg_wrap.png')&#125;); border-image-slice: 130 340 190 340 fill; border-image-width: 1; border-image-repeat: repeat; &#125; .title-bg-box &#123; position: absolute; min-width: 380px; top: -20px; margin: 0 auto; font-size: 32px; left: 50%; transform: translateX(-50%); padding: 0 100px; box-sizing: border-box; div &#123; position: relative; height: 52px; line-height: 52px; white-space: nowrap; &#125; &#125; .title-bg &#123; position: absolute; left: 0; right: 0; top: 0; bottom: 0; display: block; border-style: solid; border-width: 24px 172px 24px 172px; border-image-source: url($&#123;require('./images/title_bg.png')&#125;); border-image-slice: 24 172 24 172 fill; border-image-width: 1; border-image-repeat: repeat; margin: 0 auto; &#125;` ä½¿ç”¨ â€˜border-image-sliceâ€™ å±žæ€§æ¥å®Œæˆç‚¹ä¹å›¾ï¼Œå®ƒæŽ¥å— 4 ä¸ªå‚æ•°ï¼Œåˆ†åˆ«åœ¨å›¾ç‰‡çš„ä¸Šå³ä¸‹å·¦åˆ‡ä¸€åˆ€ï¼ŒæŠŠå›¾ç‰‡åˆ†ä¸º 9 ä¸ªéƒ¨åˆ†ï¼Œä¸€ä¸­å¿ƒï¼Œå››ä¸ªè§’ï¼Œå››ä¸ªè¾¹ã€‚ä¼¸ç¼©åªä¼šè®©è¾¹è¿›è¡Œä¼¸ç¼©ï¼Œæ‰€ä»¥éœ€è¦è°ƒæ•´åˆ‡çš„ä½ç½®ï¼Œå°½é‡åœ¨è§„åˆ™çš„åœ°æ–¹ä¸‹åˆ€ã€‚æ­¤æ—¶ï¼Œè‹¥çˆ¶å®¹å™¨çš„å®½é«˜æœªç»™å®šï¼Œåˆ™å®Œå…¨ç”±å†…å®¹æ’‘å¼€å®½é«˜ï¼Œä¸Šé¢æ —å­ä¸­ï¼Œå®½åº¦åšäº†é™åˆ¶ï¼Œé«˜åº¦æœªé™åˆ¶ï¼Œä¼ å…¥çš„ children ä¼šæ’‘å¼€ç‚¹ä¹å›¾ç»„ä»¶çš„é«˜åº¦ï¼Œåšåˆ°æ¯ä¸ªå­ç»„ä»¶é«˜åº¦æ ¹æ®å†…å®¹è‡ªé€‚åº”ï¼Œä½†æ•´ä½“çš„æ ·å¼ä¸ä¼šå‘ç”Ÿå˜åŒ–ã€‚ Hybridå…¨é¢å±H5é¡µé¢åœ¨iOSå’Œå®‰å“åº”ç”¨ï¼Œé€šå¸¸æ˜¯ç§»åŠ¨ç«¯ç»™äº†å±å¹•ç©ºé—´ï¼Œç”¨æ¥å±•ç¤ºH5é¡µé¢ï¼Œä¸åŒ…å«é¡¶éƒ¨ç”µæ± æ tabï¼Œæ–°çš„æ²‰æµ¸å¼ä½“éªŒåˆ™éœ€è¦H5é¡µé¢ä¹Ÿè¦æŽ§åˆ¶ç”µæ± åŒºåŸŸï¼Œé“ºæ»¡æ•´ä¸ªç§»åŠ¨ç«¯å±å¹•ã€‚ æ¯ä¸ªæ‰‹æœºè®¾å¤‡çš„ç”µæ± åŒºåŸŸé«˜åº¦ä¸å°½ç›¸åŒï¼Œä¸”è®¾å¤‡çš„dpiä¹Ÿä¸ä¸€è‡´ï¼ŒiOSæ˜¯ç›¸å¯¹å›ºå®šçš„22åƒç´ ï¼Œå®‰å“åˆ™æ˜¯äº”èŠ±å…«é—¨ï¼Œè¿™é‡Œéœ€è¦æ¡¥æŽ¥é€šä¿¡æ‹¿åˆ°ç§»åŠ¨ç«¯çš„â€œtabé«˜åº¦â€å’Œè®¾å¤‡dpiï¼Œæœ‰è¿™ä¸¤ä¸ªå‚æ•°ï¼ŒH5é¡µé¢åˆ™å¯ä»¥å®žçŽ°ç»Ÿä¸€çš„å…¨é¢å±å¹•æ²‰æµ¸å¼ä½“éªŒã€‚ dpi ï¼šå½“å‰æ˜¾ç¤ºè®¾å¤‡çš„ç‰©ç†åƒç´ åˆ†è¾¨çŽ‡ä¸ŽCSSåƒç´ åˆ†è¾¨çŽ‡ä¹‹æ¯”ï¼Œéœ€è¦è¿›è¡Œè½¬åŒ–ä¸ºH5çš„pxå•ä½ï¼ŒåŸºæœ¬ç®—æ³•åˆ†ä¸ºï¼š 123456789101112131415// res ä¸ºæ¡¥æŽ¥é€šä¿¡ç§»åŠ¨ç«¯è¿”å›žçš„æ•°æ®// statusBarHeightä¸ºçŠ¶æ€æ ç§»åŠ¨ç«¯é«˜åº¦if (res.data.statusBarHeight) &#123; if (client.instance.inIOsNative() ) &#123; statusBarHeight.setValue(res.data.statusBarHeight) &#125; else &#123; statusBarHeight.setValue(res.data.statusBarHeight / window.devicePixelRatio) &#125;&#125;// react&lt;HeaderBar style=&#123;&#123; paddingTop: `$&#123;statusBarHeight.value&#125;px`, ...style &#125;&#125; className=&#123;`$&#123;className&#125; `&#125;&gt; iOSçš„é«˜åº¦ä¸éœ€è¦é¢å¤–è½¬æ¢ï¼Œä¸€èˆ¬iOSæœºåž‹è¿”å›žéƒ½æ˜¯22pxï¼Œå®‰å“åˆ™éœ€è¦é™¤ä»¥dpiå¾—åˆ°CSSåƒç´ ã€‚ æ‹¿åˆ°æœ€ç»ˆçš„çŠ¶æ€æ é«˜åº¦ï¼Œè¿›è¡Œapp-headerçš„å¸ƒå±€ï¼ŒåŸºæœ¬tabæ é«˜åº¦ä¸€èˆ¬ä¸º 88 åƒç´ ï¼Œå†åŠ ä¸ŠçŠ¶æ€æ ï¼ˆç”µæ± æ ï¼‰çš„é«˜åº¦ï¼Œå¦‚æžœæ•´ä¸ªå¤´éƒ¨æ•´ä½“éœ€è¦fixedå¸ƒå±€ï¼Œå…¨å±€åˆ™å¢žåŠ padding-top å–å·§å®žçŽ°ã€‚æ•´ä¸ªH5é¡µé¢æ€»ä½“åˆ†ä¸ºä¸¤ä¸ªåŒºåŸŸï¼Œtabæ å’Œcontentå†…å®¹é¡µï¼Œä¸€èˆ¬tabæ ä½¿ç”¨çº¯è‰²èƒŒæ™¯ï¼Œå†…å®¹é¡µåˆ™æœ‰æ—¶å€™ä¼šä½¿ç”¨æ¸å˜è‰²ï¼Œæ­¤æ—¶ï¼Œcontentçš„é«˜åº¦æ— æ³•ç¡®å®šï¼Œåˆ™æ•´ä½“é¡µé¢ä½¿ç”¨ flexå¸ƒå±€ï¼Œtabæ ä½¿ç”¨ shrinkï¼š 0 ï¼› ç¦æ­¢ç¼©æ”¾ï¼Œcontentåˆ™ä½¿ç”¨ flex: 1; è‡ªåŠ¨å¡«å……æ»¡è§†å£ï¼Œè¿™æ ·ï¼Œå†…å®¹é¡µçš„æ¸å˜è‰²åˆ™å’Œtabé¡µæ— ç¼è¡”æŽ¥ã€‚ hybrid touch baråˆ¤æ–­jsåˆ¤æ–­å½“å‰æ‰‹æœºæ˜¯å¦æœ‰touch barï¼Œå¦‚æžœå­˜åœ¨ touch bar ï¼Œåˆ™Appå…¨å±€å¤´éƒ¨æ·»åŠ æ ·å¼ç±»åï¼ŒåŽç»­ä¸šåŠ¡åªéœ€æ ¹æ®å¯¹åº”CSSæ ‡è¯†å¤„ç†ä¸åŒçš„æ ·å¼ã€‚ è§£å†³ï¼š iOS æ‰‹æœºå±å¹•åº•éƒ¨å­˜åœ¨ç™½çº¿ï¼ˆæ“ä½œæ ï¼‰ï¼Œä¼šé®æŒ¡é¡µé¢çš„ä¸€éƒ¨åˆ†ï¼Œå¸¸è§çš„é¡µé¢åº•éƒ¨ä¼šå­˜åœ¨ç”¨æˆ·ç‚¹å‡»æŒ‰é’®æˆ–å…¶ä»–UIï¼Œæ“ä½œæ ä¼šé™ä½Žç”¨æˆ·çš„ä½“éªŒã€‚åˆ¤æ–­iOSå­˜åœ¨ touch bar ï¼Œåˆ™å¢žåŠ å…¨å±€æ ·å¼ï¼Œåœ¨å¯¹åº”å­ä¸šåŠ¡ä¸­ä¿®æ”¹æ ·å¼å³å¯é¿å…ã€‚ 123456789101112131415&lt;!-- Appå…¨å±€æ ·å¼ï¼ˆapp.jsï¼‰ --&gt;if ( /iphone/gi.test(navigator.userAgent) &amp;&amp; window.devicePixelRatio &amp;&amp; window.devicePixelRatio &gt;= 2 &amp;&amp; window.screen.height &gt;= 812) &#123; document.querySelector('html').classList.add('fix-bottom');&#125;&lt;!-- å…·ä½“å­ä¸šåŠ¡ --&gt;.fix-bottom &amp; &#123; padding-bottom: 60px;&#125; iframe è·¨åŸŸé€šä¿¡åœ¨å¯¹æŽ¥ä¸€äº›ç¬¬ä¸‰æ–¹çš„æ¸¸æˆæ—¶ï¼Œé‡‡ç”¨ Appå®¢æˆ·ç«¯ åµŒå…¥ Hybrid H5å‰ç«¯ï¼Œå‰ç«¯å¯¹æŽ¥ç¬¬ä¸‰æ–¹ã€‚æ¯”å¦‚ï¼ŒæŠ–éŸ³ç›´æ’­é—´ç«èµ·æ¥çš„å¼¹å¹•æ¸¸æˆå’Œå…¶ä»–è¶£å‘³æ¸¸æˆï¼Œåœ¨ç›´æ’­é—´æŽ¥å…¥è¿™äº›ä¸‰æ–¹æ¸¸æˆï¼Œåœ¨å…³é—­æ¸¸æˆã€æ”¯ä»˜ç­‰æ–¹é¢ï¼Œæ¶‰åŠä¸‰ç«¯è·¨åŸŸé€šä¿¡ã€‚ è¿™é‡Œæœ‰ä¸€ä¸ªæ¡ˆä¾‹ï¼Œæ¸¸æˆæ˜¯ç¬¬ä¸‰æ–¹çš„ï¼Œä½†æ¸¸æˆå†…å……å€¼å…‘æ¢è´§å¸çš„é¡µé¢æ˜¯æˆ‘ä»¬çš„ã€‚æ¸¸æˆæœ€ç»ˆéœ€è¦åœ¨å®¢æˆ·ç«¯ã€Webç«¯ã€æ¡Œé¢ç«¯ï¼ˆwindow app, ä¸»è¦æ˜¯å¼€æ’­å·¥å…·ï¼‰ä¸‰ç«¯å±•ç¤ºã€‚è¿™é‡Œé¡µé¢äº’ç›¸åµŒå¥—ï¼Œä½†æœ¬è´¨å°±æ˜¯å­çˆ¶é¡µé¢é€šä¿¡ã€‚ // çˆ¶é¡µé¢ç›‘å¬å•ä¸ªäº‹ä»¶ window.addEventListener('message', _handleMsg) const _handleMsg = (event) =&gt; { // doSomeThing } // å­é¡µé¢å‘é€äº‹ä»¶ // window.parent.postMessage('ä½ çš„å‚æ•°, '*') ç¬¬äºŒä¸ªå‚æ•°å³è§£å†³è·¨åŸŸé—®é¢˜ï¼Œä¹Ÿå¯å¡«å†™çˆ¶çª—å£çš„åŸŸå window.parent.postMessage('ä½ çš„å‚æ•°, 'https://0.0.0.9200') // window.parent è¿”å›žçˆ¶çª—å£ // window.top è¿”å›žæœ€é¡¶å±‚çª—å£ï¼Œä¸ä¸€å®šæ˜¯çˆ¶çª—å£ const closeWebView = () =&gt; { window.parent.postMessage( { type: 'webViewEvent', source: 'xxx', event: 'close', }, '*', ); }; è‡ªå®šä¹‰hooks åœ¨æ‰‹å†™è¾ƒå¤šçš„ useEffect çš„æ—¶å€™ï¼Œå°±åº”è¯¥æŠ½ä¸€ä¸ª hooks å‡ºæ¥ã€‚ Reactçš„å®˜ç½‘åŽŸè¯ä¹Ÿæœ‰ï¼š å¦‚æžœä½ å‘çŽ°è‡ªå·±ç»å¸¸éœ€è¦æ‰‹åŠ¨ç¼–å†™ Effectï¼Œé‚£ä¹ˆè¿™é€šå¸¸è¡¨æ˜Žä½ éœ€è¦ä¸ºç»„ä»¶æ‰€ä¾èµ–çš„é€šç”¨è¡Œä¸ºæå–ä¸€äº› è‡ªå®šä¹‰ Hookã€‚]]></content>
      <categories>
        <category>Programming</category>
      </categories>
      <tags>
        <tag>ä¹ˆä¹ˆç›´æ’­</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ES6]]></title>
    <url>%2F2021%2F04%2F13%2FES6%2F</url>
    <content type="text"><![CDATA[nodeç‰ˆæœ¬ç®¡ç†ä¸åŒé¡¹ç›®äº¤å‰å¼€å‘æ—¶ï¼Œå¯èƒ½ä¼šå‡ºçŽ°nodeç‰ˆæœ¬çš„å†²çªï¼Œå¸¸è§æœ‰ nvm æ’ä»¶æ¥è§£å†³ï¼Œä½† nvm å¹¶ä¸æ˜¯å…¨è‡ªåŠ¨ï¼Œéœ€è¦æ‰‹åŠ¨åˆ‡æ¢ç‰ˆæœ¬ nvm use â€¦ ï¼Œè¿™é‡Œé‡‡ç”¨ç¤¾åŒºæä¾›çš„ avn (avn)[https://github.com/wbyoung/avn],æ€è·¯ä¸ºï¼š é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»º .node-versionæ–‡ä»¶ï¼Œä»¥ server æ ¼å¼çº¦å®šå¥½ Node ç‰ˆæœ¬ï¼Œå¦‚ï¼š 9.8.0ï¼Œåœ¨CDåˆ°é¡¹ç›®ç›®å½•æ—¶ï¼Œavnä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°åˆ¶å®šçš„Nodeç‰ˆæœ¬ã€‚ nå‘½ä»¤nå‘½ä»¤æ¥ç®¡ç†nodeçš„ä¸åŒç‰ˆæœ¬ï¼ŒåŸºæœ¬ä¸º 123456789101112131415161718192021222324252627282930313233$ npm i -g n$ n ls-remote --all // æŸ¥çœ‹æ‰€æœ‰å¯å®‰è£…çš„ç‰ˆæœ¬$ n &lt;version&gt; // å®‰è£…nodeï¼Œex: n 10.15.0$ n ls // æœ¬åœ°å·²å®‰è£…çš„ç‰ˆæœ¬sudo n run &lt;version&gt; // ä½¿ç”¨æŸä¸ªç‰ˆæœ¬n // ç›´æŽ¥n ä¹Ÿå¯ä»¥é€‰æ‹©ç‰ˆæœ¬sudo n rm &lt;version&gt; // åˆ é™¤å¤šä½™çš„ç‰ˆæœ¬``` ç®€å•è¯´ä¸‹ä¼˜ç¼ºç‚¹å§ ä¼˜ç‚¹ï¼š æ–¹ä¾¿ï¼Œå¿«é€Ÿï¼Œç›¸å¯¹avnæ¥è¯´ï¼Œ nå‘½ä»¤å®‰è£…æ–¹ä¾¿ï¼Œä¸€æ¡å‘½ä»¤è§£å†³ï¼Œavnåˆ™éœ€è¦æ”¹IPåœ°å€æˆ–è€…ç§‘å­¦ä¸Šç½‘ç­‰ï¼Œ ç¼ºç‚¹ï¼š è¿™ç‰ˆæœ¬æ˜¯å…¨å±€ä¸”æ‰‹åŠ¨çš„ï¼Œè‡ªå·±çš„é¡¹ç›®å¯ä»¥ç”¨ç”¨ï¼Œè¦æ˜¯å¤§åž‹å¼€å‘é¡¹ç›®ï¼Œå»ºè®®ç”¨nvmç¼–å†™ script å¯åŠ¨å‘½ä»¤æ¥æŽ§åˆ¶ç‰ˆæœ¬ï¼Œå¦åˆ™é¡¹ç›®ä¹‹é—´å¯èƒ½å‡ºçŽ°nodeç‰ˆæœ¬å†²çªã€‚ PSï¼š n å‘½ä»¤å¤§éƒ¨åˆ†éƒ½éœ€è¦ä½¿ç”¨ sudo æ‰“å¼€ ## æ•°ç»„ç§»é™¤falseç±»åž‹ ç®€å•è®°å½•ä¸€ä¸ªæ•°ç»„çš„ç§»é™¤ false æ–¹æ³• ```javascriptconst arr = [1, &quot;str&quot;, false, NaN, undefined, null]const res = arr.filter(Boolean)// Reactconst hideSomething ?: booleanconst options: any = [ hideSomething !== true &amp;&amp; &#123; otherOption: &apos;test&apos; &#125;, &#123; normalOptions: &apos;normal&apos; &#125;,].filter(Boolean) è§£æž„é™„å€¼log123const &#123; log, warn &#125; = consolelog('something')]]></content>
      <categories>
        <category>é»˜è®¤</category>
      </categories>
      <tags>
        <tag>é»˜è®¤</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Amis]]></title>
    <url>%2F2021%2F02%2F24%2Famis%2F</url>
    <content type="text"><![CDATA[Aimsç³»åˆ—çš„é«˜çº§ç”¨æ³•Amisæ˜¯ç™¾åº¦å¼€æºçš„ä¸€å¥—ä¼ä¸šçº§ç®¡ç†ç³»ç»Ÿï¼Œä¸€ä¸ªä½Žä»£ç å‰ç«¯æ¡†æž¶ï¼Œå®ƒä½¿ç”¨ JSON é…ç½®æ¥ç”Ÿæˆé¡µé¢ï¼Œå¯ä»¥å‡å°‘é¡µé¢å¼€å‘å·¥ä½œé‡ï¼Œæžå¤§æå‡æ•ˆçŽ‡ã€‚ Ovineä¸€ä¸ªæ”¯æŒä½¿ç”¨ Json æž„å»ºå®Œæ•´ç®¡ç†ç³»ç»Ÿ UI çš„æ¡†æž¶ï¼ŒåŸºäºŽ Amis äºŒæ¬¡å¼€å‘ã€‚ ç›¸å…³æ–‡æ¡£ä¾èµ– ReactAmisstyled-componentimmerfont-awesome iconä½¿ç”¨åœ¨Oviené¡¹ç›®ä¸­ï¼Œiconçš„ä½¿ç”¨å¾ˆç®€å•ä¹Ÿéžå¸¸ä¸°å¯Œï¼Œåœ¨[font-awesome](https://fontawesome.dashgame.com/)ä¸­é€‰å–é€‚åˆä½ çš„iconåç§°å³å¯ 1icon: &apos;fa fa-$&#123;icon_name&#125;&apos;onFakeRequeståº”ç”¨amiså¯¹åŽç«¯æˆ–è€…è¯´ä¸­å°è½¬æ¢ä¾èµ–æ¯”è¾ƒå¼ºï¼Œè¿”å›žçš„APIæ•°æ®ä¸€èˆ¬æ˜¯åŽç«¯ç»„è£…å¥½çš„JSONæ•°æ®ï¼Œç›´æŽ¥æ¸²æŸ“ï¼Œä½†æ˜¯å¯¹äºŽå…¶ä»–åŽç«¯ä¸æ˜¯å¾ˆå¼ºå¤§çš„é¡¹ç›®æ¥è¯´ï¼ŒonFakeRequeståº”ç”¨å°±å¾ˆæœ‰å¿…è¦ï¼Œå®ƒå®žçŽ°äº†å‡è¯·æ±‚ï¼Œåœ¨å‡è¯·æ±‚é‡Œæ ¹æ®è¿”å›žçš„æ•°æ®æ‹¼æŽ¥æˆ‘ä»¬éœ€è¦çš„schemaï¼Œæœ€åŽè¿”å›žå‡ºåŽ»è¿›è¡Œæ¸²æŸ“ï¼Œå¦‚ä¸‹åŠ¨æ€æ¸²æŸ“ åŠ¨æ€æ¸²æŸ“åŠ¨æ€æ¸²æŸ“ç›®å‰åªèƒ½åœ¨ Service å®¹å™¨ä¸­å®žçŽ°ï¼Œæ ¸å¿ƒæ€è·¯æ˜¯ç”±åŽå°è¿”å›žéœ€è¦çš„æ•°æ®ï¼Œå†åŠ ä»¥æ‹¼æŽ¥è¿”å›žä¸€ä¸ªSchemaè¿›è¡Œæ¸²æŸ“è€Œæˆã€‚å¸¸è§éœ€æ±‚ä¸ºï¼š æŸä¸€ä¸ªç®¡ç†é¡µé¢çš„è¡Œçš„æ¯ä¸€é¡¹ä¸æ˜¯å›ºå®šçš„ï¼Œæ˜¯æ ¹æ®å…¶ä»–é…ç½®é¡µæ•°æ®æ¥æ¸²æŸ“çš„ï¼Œä¾‹å¦‚ç›´æ’­é“å…·çš„ä½¿ç”¨æƒ…å†µï¼Œé“å…·å¹¶ä¸æ˜¯äº‹å…ˆå°±çº¦å®šå¥½çš„ï¼Œæ˜¯å¯é…ç½®çš„ï¼Œæƒ³è¦æ¸²æŸ“é“å…·çš„ä½¿ç”¨æ•°æ®è¡¨å°±å¾—åŠ¨æ€æ¸²æŸ“è¡¨å¤´ã€‚è¡¨å¤´çš„æ•°æ®æŽ¥å£åªè¿”å›žäº†ç®€å•çš„æ ‡è¯†ï¼Œæœªè¿”å›žschemaèŠ‚ç‚¹ï¼Œæˆ‘ä»¬åœ¨ onFakeRequest é‡Œæ‹¼æŽ¥schemaè¿”å›žæ¸²æŸ“ï¼Œå…·ä½“çœ‹ä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134schemaApi: &#123;$preset: 'apis.tabConf',url: 'fakeRequest',onFakeRequest: async (source) =&gt; &#123; // å‡è¯·æ±‚ï¼ˆOvienå®žçŽ°ï¼‰ const confData = await app.request(&#123; url: 'GET api/v1/apps/meme/hot-card', domain: 'flint', &#125;) const cardConf = confData.data.data['hot-card']['hot-cards'] || &#123;&#125; const colConf = [ &#123; name: 'nickname', label: 'ç”¨æˆ·æ˜µç§°(ID)', type: 'tpl', tpl: '$&#123;nickname&#125;(ID:$&#123;_id&#125;)' &#125; ] const selectConf = [] Object.keys(cardConf).map((key) =&gt; &#123; const item = cardConf[key] const colOpt = &#123; label: `$&#123;item['gift-name']&#125;(æœªä½¿ç”¨)` || '-', name: key, type: 'tpl', // tpl: `&lt;%= (data.remain[$&#123;key&#125;] || '-') + '/' + (data.total[$&#123;key&#125;] || '-') %&gt;`, tpl: `&lt;%= (data.remain[$&#123;key&#125;] || '/') %&gt;`, &#125; const selectOpt = &#123; label: `$&#123;item['gift-name']&#125; ($&#123;item['hot-value']&#125;çƒ­åº¦/å¼ ï¼Œç”Ÿæ•ˆ$&#123;item.duration&#125;åˆ†é’Ÿ)`, value: key &#125; selectConf.push(selectOpt) colConf.push(colOpt) return true &#125;) // äºŒæ¬¡å¼¹çª—å†…å®¹ const retrieveCard = &#123; api: &#123; url: 'GET hotcard/del.json', data: &#123; user_id: '$_id', gift_id: '$giftSelect', num: '$delNum', &#125; &#125;, type: 'form', horizontal: &#123; left: 'col-sm-3', right: 'col-sm-8', &#125;, controls: [ &#123; type: 'select', label: 'çƒ­åº¦å¡ç±»åž‹', name: 'giftSelect', required: true, options: selectConf, &#125;, &#123; type: 'number', name: 'delNum', label: 'å›žæ”¶æ•°é‡', description: 'è¯·è¾“å…¥æ¯äººå›žæ”¶çƒ­åº¦å¡çš„æ•°é‡', required: true, // min: 1, precision: 0, &#125;, ] &#125; const retrieve: any = &#123; type: 'action', label: 'å›žæ”¶çƒ­åº¦å¡', level: 'danger', // visibleOn: '!data.status', actionType: 'dialog', dialog: &#123; title: 'å›žæ”¶çƒ­åº¦å¡', body: retrieveCard, &#125;, &#125; colConf.push(retrieve) const schemaNode = &#123; type: 'lib-crud', syncLocation: false, // api: '$preset.apis.remainList', primaryField: '_id', perPageField: 'size', pageField: 'page', perPageAvailable: [50, 100, 200], defaultParams: &#123; size: 50, &#125;, api: &#123; url: 'GET hotcard/remain.json' &#125;, // source: '$rows', headerToolbar: [ &#123; type: 'columns-toggler', align: 'left', &#125;, // &#123; // $preset: 'actions.add', // align: 'right', // &#125;, ], footerToolbar: ['statistics', 'switch-per-page', 'pagination'], columns: colConf, filter: &#123; type: 'form', title: 'æœç´¢', controls: [ &#123; type: 'text', name: 'user_id', value: '', placeholder: 'è¾“å…¥ç”¨æˆ·IDæœç´¢', &#125;, &#123; type: 'submit', className: 'm-l', label: 'æœç´¢', &#125;, ] &#125;, &#125; source.data = schemaNode return source&#125;&#125;,]]></content>
      <categories>
        <category>é»˜è®¤</category>
      </categories>
      <tags>
        <tag>é»˜è®¤</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Reactå¼€å‘æ€»ç»“]]></title>
    <url>%2F2020%2F11%2F11%2FReact%2F</url>
    <content type="text"><![CDATA[ä¼ é€é—¨ React Mobx Mobx-state-tree React-Hooks Typescript VAP react-query SVGR polished immerjs åºè¨€å°ç¨‹åºå’ŒVueè¦å‘Šä¸€æ®µè½äº†ï¼ŒæŽ¥ä¸‹æ¥è¦è¿›è¡Œ React ã€typescriptã€ Express å¼€å‘äº†ã€‚é¡¹ç›®ä¸»è¦æ˜¯ä¸€ä¸ª2013å¹´çš„ç›´æ’­é¡¹ç›®ï¼Œå½“æ—¶é‡‡ç”¨çš„æ˜¯ Express \ Ejs å®žçŽ°çš„ï¼ŒçŽ°åœ¨V2ç‰ˆæœ¬ä¸€ç›´é™†ç»­å†å¾€Reactã€typescriptæ–¹é¢é‡æž„ã€‚V2ç‰ˆæœ¬é‡‡ç”¨æœ€æ–°çš„Reactç³»åˆ—å¼€å‘ã€‚çŸ¥è¯†ç‚¹åŒ…æ‹¬ä»¥ä¸Šä¼ é€é—¨ç­‰ã€‚ React]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>Programming</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸€äº›ä¸‰æ–¹åº“]]></title>
    <url>%2F2020%2F10%2F07%2F%E4%B8%80%E4%BA%9B%E4%B8%89%E6%96%B9%E5%BA%93%2F</url>
    <content type="text"><![CDATA[ç²˜è´´å¤åˆ¶clipboard.js çŽ°ä»£åŒ–çš„æ‹·è´æ–‡å­—ï¼Œä¸ä¾èµ– flash, ä¸ä¾èµ–å…¶ä»–æ¡†æž¶ï¼Œgzip åŽ‹ç¼©åŽåªæœ‰ 3kb å¤§å° 12yarn add clipboard npm install clipboard --save 123456789101112131415161718import ClipboardJS from 'lib/clipboard.min';useEffect(() =&gt; &#123; const clipboard = new ClipboardJS('id'); clipboard.on('success', (e) =&gt; &#123; UiToast.text('å¤åˆ¶æˆåŠŸ'); e.clearSelection(); &#125;); clipboard.on('error', (e) =&gt; &#123; UiToast.fail('å¤åˆ¶å¤±è´¥'); # doSomeThing() &#125;); return () =&gt; &#123; clipboard.destroy(); &#125;;&#125;, [codeStr.value]); React æ‹–æ‹½]]></content>
      <categories>
        <category>ä¸‰æ–¹åº“</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Vue]]></title>
    <url>%2F2020%2F09%2F27%2FVue%2F</url>
    <content type="text"><![CDATA[Vueå“åº”å¼åŽŸç†Vueçš„æ•°æ®å“åº”å¼åŽŸç†ä¸»è¦åŸºäºŽ Object.defineProperty() å‡½æ•°æ¥åŠ«æŒæ•°æ®å˜åŒ–ï¼Œä»¥åŠä½¿ç”¨å‘å¸ƒ-è®¢é˜…è€…æ¨¡å¼è¾¾åˆ°æ›´æ–°æ•°æ®çš„åšæ³•ã€‚é¦–å…ˆè¦è®¾ç½®ä¸€ä¸ªç›‘å¬å™¨Observer,ç”¨æ¥ç›‘å¬æ‰€æœ‰çš„å±žæ€§ï¼Œå½“å±žæ€§å˜åŒ–æ—¶ï¼Œå°±éœ€è¦é€šçŸ¥è®¢é˜…è€…Watcher,çœ‹æ˜¯å¦éœ€è¦æ›´æ–°ï¼Žå› ä¸ºå±žæ€§å¯èƒ½æ˜¯å¤šä¸ªï¼Œæ‰€ä»¥ä¼šæœ‰å¤šä¸ªè®¢é˜…è€…ï¼Œæ•…æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ¶ˆæ¯è®¢é˜…å™¨Depæ¥ä¸“é—¨æ”¶é›†è¿™äº›è®¢é˜…è€…ï¼Œå¹¶åœ¨ç›‘å¬å™¨Observerå’Œè®¢é˜…è€…Watcherä¹‹é—´è¿›è¡Œç»Ÿä¸€çš„ç®¡ç†ï¼Žä»¥ä¸ºåœ¨èŠ‚ç‚¹å…ƒç´ ä¸Šå¯èƒ½å­˜åœ¨ä¸€äº›æŒ‡ä»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦æœ‰ä¸€ä¸ªæŒ‡ä»¤è§£æžå™¨Compileï¼Œå¯¹æ¯ä¸ªèŠ‚ç‚¹å…ƒç´ è¿›è¡Œæ‰«æå’Œè§£æžï¼Œå°†ç›¸å…³æŒ‡ä»¤åˆå§‹åŒ–æˆä¸€ä¸ªè®¢é˜…è€…Watcherï¼Œå¹¶æ›¿æ¢æ¨¡æ¿æ•°æ®å¹¶ç»‘å®šç›¸åº”çš„å‡½æ•°ï¼Œè¿™æ—¶å€™å½“è®¢é˜…è€…WatcheræŽ¥å—åˆ°ç›¸åº”å±žæ€§çš„å˜åŒ–ï¼Œå°±ä¼šæ‰§è¡Œç›¸å¯¹åº”çš„æ›´æ–°å‡½æ•°ï¼Œä»Žè€Œæ›´æ–°è§†å›¾ï¼Ž æ•´ç†ä¸Šé¢çš„æ€è·¯ï¼Œæˆ‘ä»¬éœ€è¦å®žçŽ°ä¸‰ä¸ªæ­¥éª¤ï¼Œæ¥å®ŒæˆåŒå‘ç»‘å®šï¼š å®žçŽ°ä¸€ä¸ªç›‘å¬å™¨Observerï¼Œç”¨æ¥åŠ«æŒå¹¶ç›‘å¬æ‰€æœ‰å±žæ€§ï¼Œå¦‚æžœæœ‰å˜åŠ¨çš„ï¼Œå°±é€šçŸ¥è®¢é˜…è€…ã€‚ å®žçŽ°ä¸€ä¸ªè®¢é˜…è€…Watcherï¼Œå¯ä»¥æ”¶åˆ°å±žæ€§çš„å˜åŒ–é€šçŸ¥å¹¶æ‰§è¡Œç›¸åº”çš„å‡½æ•°ï¼Œä»Žè€Œæ›´æ–°è§†å›¾ã€‚ å®žçŽ°ä¸€ä¸ªè§£æžå™¨Compileï¼Œå¯ä»¥æ‰«æå’Œè§£æžæ¯ä¸ªèŠ‚ç‚¹çš„ç›¸å…³æŒ‡ä»¤ï¼Œå¹¶æ ¹æ®åˆå§‹åŒ–æ¨¡æ¿æ•°æ®ä»¥åŠåˆå§‹åŒ–ç›¸åº”çš„è®¢é˜…å™¨ã€‚ let {log} = console function defineReactive(data,key,val) { observe(val); //é€’å½’éåŽ†æ‰€æœ‰çš„å±žæ€§ Object.defineProperty(data,key,{ enumerable:true, //å½“ä¸”ä»…å½“è¯¥å±žæ€§çš„ configurable ä¸º true æ—¶ï¼Œè¯¥å±žæ€§æè¿°ç¬¦æ‰èƒ½å¤Ÿè¢«æ”¹å˜ï¼ŒåŒæ—¶è¯¥å±žæ€§ä¹Ÿèƒ½ä»Žå¯¹åº”çš„å¯¹è±¡ä¸Šè¢«åˆ é™¤ã€‚ configurable:true, //å½“ä¸”ä»…å½“è¯¥å±žæ€§çš„enumerableä¸ºtrueæ—¶ï¼Œè¯¥å±žæ€§æ‰èƒ½å¤Ÿå‡ºçŽ°åœ¨å¯¹è±¡çš„æžšä¸¾å±žæ€§ä¸­ get() { return val; }, set(newVal) { val = newVal; log(`å±žæ€§${key}å·²è¢«ç›‘å¬ï¼ŒçŽ°åœ¨å€¼ä¸º"${newVal.toString()}"`) } }) } function observe(data) { if(!data || typeof data !== 'object') { return; } Object.keys(data).forEach(function(key){ //éåŽ†æ¯ä¸€ä¸ªæ•°æ® defineReactive(data,key,data[key]); }); } let data = { user1: { name: '' }, user2: '' }; observe(data); data.user1.name = 'çº¦ç¿°'; // å±žæ€§nameå·²ç»è¢«ç›‘å¬äº†ï¼ŒçŽ°åœ¨å€¼ä¸ºï¼šâ€œçº¦ç¿°â€ data.user2 = 'é²å‹ƒ'; // å±žæ€§book2å·²ç»è¢«ç›‘å¬äº†ï¼ŒçŽ°åœ¨å€¼ä¸ºï¼šâ€œé²å‹ƒâ€ é€šè¿‡ä¸Šé¢çš„ä»£ç ï¼Œæˆ‘ä»¬æ¨¡æ‹Ÿäº†Vueå®žä¾‹çš„æ•°æ®ç›‘å¬å®žçŽ°è¿‡ç¨‹ï¼Œè¿™é‡Œä¹Ÿå¾ˆå¥½çš„è§£é‡Šäº†ä¸ºä»€ä¹ˆé¡µé¢éœ€è¦çš„æ•°æ®å­—æ®µå¿…é¡»å¾—åœ¨Vueå®žä¾‹æŒ‚è½½å‰å°±è¦æ³¨å†Œåœ¨ data å¯¹è±¡ä¸­ï¼Œä¸èƒ½åŠ¨æ€çš„åœ¨dataä¸­è®¾ç½®æ•°æ®å­—æ®µï¼Œæˆ–è€…è¯´åŠ¨æ€çš„åœ¨ data ä¸­è®¾ç½®å­—æ®µï¼Œè¯¥å­—æ®µæ˜¯ä¸èƒ½åŒå‘ç»‘å®šçš„ã€‚åŽŸå› å°±åœ¨äºŽVueå®žä¾‹æŒ‚è½½æ—¶ï¼Œå·²ç»éåŽ†äº†data å¹¶ä¸ºdataä¸­æ¯ä¸ªå€¼éƒ½æ‰§è¡Œäº†Object.defineProperty(),è€Œä¹‹åŽdataä¸­çš„æ•°æ®è‡ªç„¶å°±ä¸ä¼šç›‘å¬ã€‚]]></content>
      <categories>
        <category>Vue</category>
      </categories>
      <tags>
        <tag>Programming</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ¯æ—¥ä¸€é¢˜]]></title>
    <url>%2F2020%2F09%2F20%2F%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%2F</url>
    <content type="text"><![CDATA[###æ¯æ—¥ä¸€é¢˜ï¼Œæ•´ç†ç¨‹åºæ€ç»´çš„ç»å…¸æ¡ˆä¾‹ é“¾å¼è°ƒç”¨12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576/** * * é“¾å¼è°ƒç”¨ * * åŽŸç†ï¼š éƒ½æ˜¯é€šè¿‡è¿”å›žå¯¹è±¡ä¾›ä¹‹åŽè¿›è¡Œè°ƒç”¨ã€‚ * 1ã€thisçš„ä½œç”¨åŸŸé“¾ï¼ŒjQueryçš„å®žçŽ°æ–¹å¼ï¼Œé€šå¸¸é“¾å¼è°ƒç”¨éƒ½æ˜¯é‡‡ç”¨è¿™ç§æ–¹å¼ã€‚ * 2ã€è¿”å›žå¯¹è±¡æœ¬èº«ï¼ŒåŒ this çš„åŒºåˆ«å°±æ˜¯æ˜¾å¼è¿”å›žé“¾å¼å¯¹è±¡ * 3ã€é—­åŒ…è¿”å›žå¯¹è±¡çš„æ–¹å¼å®žçŽ°ï¼Œä¸Žå‡½æ•°æŸ¯é‡ŒåŒ–ç±»ä¼¼ * * !!! ç®­å¤´å‡½æ•°thisæŒ‡å‘ */let Person = function() &#123;&#125;;Person.prototype.setAge = function(age)&#123; this.age = age; log(`ta$&#123;age&#125;å²`) return this;&#125;Person.prototype.setWeight = function(weight)&#123; this.weight = weight; log(`ä½“é‡$&#123;weight&#125;kg`) return this;&#125;Person.prototype.eat = function (food) &#123; this.food = food log(`eat $&#123;food&#125;`) return this &#125;Person.prototype.run = function(merter) &#123; this.merter = merter log(`run $&#123;merter&#125;ç±³`) return this &#125;Person.prototype.sleep = function (hour) &#123; this.hour = hour log(`sleep $&#123;hour&#125; hours`) return this &#125;var person = new Person();person.setAge(19).setWeight(110).eat('apple').run(30).sleep(8)// ä½¿ç”¨å¯¹è±¡å½¢å¼const Monkey = &#123; name: null, age: null, weight: null, setName: function(name) &#123; this.name = name return this &#125;, setAge: function(age) &#123; this.age = age; return this &#125;, setWeight: function(weight) &#123; this.weight = weight return this &#125;, get: function() &#123; let desc = `TA is $&#123;this.name&#125; and $&#123;this.age&#125;å² ã€ $&#123;this.weight&#125;kg` log(desc) &#125;&#125;Monkey.setName('monkey').setAge(9).setWeight(23).get() jsç‰ˆæœ¬ sleep å‡½æ•°sleep å‡½æ•°,ä½œç”¨æ˜¯ä½¿ç¨‹åºæš‚åœæŒ‡å®šçš„æ—¶é—´,å…¶ä»–è¯­è¨€è‡ªå¸¦sleepå‡½æ•°ï¼Œè€ŒJSå´éœ€è¦ç¨å¾®æ”¹é€ ä¸€ä¸‹ï¼Œå·²å®žçŽ°sleepå‡½æ•° 12345678910111213141516171819202122232425262728// é€šè¿‡ whileï¼ˆtrueï¼‰æ­»å¾ªçŽ¯å®žçŽ°function sleep (time) &#123; let timeStamp = new Date().getTime(); let endTime = timeStamp + time; while(true) &#123; if ( new Date().getTime() &gt; endTime) &#123; return &#125; &#125;&#125;// Promise å®žçŽ°function sleep2 (delay) &#123; return new Promise((res, rej) =&gt; &#123; setTimeout(res, delay) &#125;)&#125;// æ€è€ƒï¼š ä»¥ä¸‹æ‰§è¡Œé¡ºåºæ˜¯ä»€ä¹ˆï¼ŸåŽŸç†log(1)sleep2(1000).then(log(2))log(3)sleep(1000)log(4) å‘å¸ƒè®¢é˜…è€…æ¨¡å¼è¿™æ˜¯ç»å…¸çš„ä¸€ä¸ªå¼€å‘æ¨¡å¼ï¼Œå¾ˆå¤šåœºæ™¯ä»¥åŠsdkä¼šä½¿ç”¨å®ƒ 1ã€åˆ›å»ºä¸€ä¸ª EventEmitter ç±»2ã€åœ¨è¯¥ç±»ä¸Šåˆ›å»ºä¸€ä¸ªäº‹ä»¶ä¸­å¿ƒï¼ˆMapï¼‰3ã€on æ–¹æ³•ç”¨æ¥æŠŠå‡½æ•° fn éƒ½åŠ åˆ°äº‹ä»¶ä¸­å¿ƒä¸­ï¼ˆè®¢é˜…è€…æ³¨å†Œäº‹ä»¶åˆ°è°ƒåº¦ä¸­å¿ƒï¼‰4ã€emit æ–¹æ³•å–åˆ° arguments é‡Œç¬¬ä¸€ä¸ªå½“åš eventï¼Œæ ¹æ® event å€¼åŽ»æ‰§è¡Œå¯¹åº”äº‹ä»¶ä¸­å¿ƒä¸­çš„å‡½æ•°ï¼ˆå‘å¸ƒè€…å‘å¸ƒäº‹ä»¶åˆ°è°ƒåº¦ä¸­å¿ƒï¼Œè°ƒåº¦ä¸­å¿ƒå¤„ç†ä»£ç ï¼‰5ã€off æ–¹æ³•å¯ä»¥æ ¹æ® event å€¼å–æ¶ˆè®¢é˜…ï¼ˆå–æ¶ˆè®¢é˜…ï¼‰6ã€once æ–¹æ³•åªç›‘å¬ä¸€æ¬¡ï¼Œè°ƒç”¨å®Œæ¯•åŽåˆ é™¤ç¼“å­˜å‡½æ•°ï¼ˆè®¢é˜…ä¸€æ¬¡ï¼‰7ã€æ³¨å†Œä¸€ä¸ª newListener ç”¨äºŽç›‘å¬æ–°çš„äº‹ä»¶è®¢é˜… 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051class EventEmitter &#123; // ç”¨æ¥å­˜æ”¾æ³¨å†Œçš„äº‹ä»¶ä¸Žå›žè°ƒ constructor() &#123; this._events = &#123;&#125; &#125; // å°†äº‹ä»¶å›žè°ƒå‡½æ•°å­˜å‚¨åˆ°å¯¹åº”çš„äº‹ä»¶ä¸Š on (eventName, callback) &#123; // å¦‚æžœç»‘å®šçš„äº‹ä»¶ä¸æ˜¯newListener å°±è§¦å‘æ”¹å›žè°ƒ if (this._events[eventName]) &#123; if(this.eventName !== "newListener")&#123; this.emit("newListener", eventName) &#125; &#125; // ç”±äºŽä¸€ä¸ªäº‹ä»¶å¯èƒ½æ³¨å†Œå¤šä¸ªå›žè°ƒå‡½æ•°ï¼Œæ‰€ä»¥ä½¿ç”¨æ•°ç»„æ¥å­˜å‚¨äº‹ä»¶é˜Ÿåˆ— const callbacks = this._events[eventName] || [] callbacks.push(callback) this._events[eventName] = callbacks &#125; // args ç”¨äºŽæ”¶é›†å‘å¸ƒäº‹ä»¶æ—¶ä¼ é€’çš„å‚æ•° emit (eventName, ...args) &#123; const callbacks = this._events[eventName] || [] // èŽ·å–åˆ°äº‹ä»¶å¯¹åº”çš„å›žè°ƒå‡½æ•°ä¾æ¬¡æ‰§è¡Œ callbacks.forEach(cb =&gt; cb(...args)) &#125; // æ‰¾åˆ°äº‹ä»¶å¯¹åº”çš„å›žè°ƒå‡½æ•°ï¼Œåˆ é™¤å¯¹åº”çš„å›žè°ƒå‡½æ•° off (eventName, callback) &#123; const callbacks = this._events[eventName] || [] const newCallBacks = callbacks.filter(cb =&gt; cb != callback &amp;&amp; cb.initialCallback != callback ) // åŸºæœ¬æ€è·¯ï¼š æœªæ³¨é”€çš„å‡½æ•°ä¾æ—§ä¿ç•™ this._events[eventName] = newCallBacks &#125; once (eventName, callback ) &#123; // ç”±äºŽéœ€è¦åœ¨å›žè°ƒå‡½æ•°æ‰§è¡ŒåŽï¼Œå–æ¶ˆè®¢é˜…å½“å‰äº‹ä»¶ï¼Œæ‰€ä»¥éœ€è¦å¯¹ä¼ å…¥çš„å›žè°ƒå‡½æ•°åšä¸€å±‚åŒ…è£…,ç„¶åŽç»‘å®šåŒ…è£…åŽçš„å‡½æ•° const one = (...args) =&gt; &#123; callback(...args) this.off(eventName, one) &#125; // ç”±äºŽï¼šæˆ‘ä»¬è®¢é˜…äº‹ä»¶çš„æ—¶å€™ï¼Œä¿®æ”¹äº†åŽŸå›žè°ƒå‡½æ•°çš„å¼•ç”¨ï¼Œæ‰€ä»¥ï¼Œç”¨æˆ·è§¦å‘ off çš„æ—¶å€™ä¸èƒ½æ‰¾åˆ°å¯¹åº”çš„å›žè°ƒå‡½æ•° // æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦åœ¨å½“å‰å‡½æ•°ä¸Žç”¨æˆ·ä¼ å…¥çš„å›žè°ƒå‡½æ•°åšä¸€ä¸ªç»‘å®šï¼Œæˆ‘ä»¬é€šè¿‡è‡ªå®šä¹‰å±žæ€§æ¥å®žçŽ° one.initialCallback = callback this.on(eventName, one) &#125;&#125; æ‰‹å†™Promise.allPromiseæ˜¯å¸¸ç”¨çš„å¼‚æ­¥å¤„ç†æ–¹å¼ï¼Œä»–æœ‰ allã€allSettledã€race ä¸‰ä¸ªæ–¹æ³• å…±åŒç‚¹ï¼š éƒ½æ˜¯å°†å¤šä¸ªPromiseç»„åˆæˆä¸€ä¸ªè¿”å›ž ä¸åŒç‚¹ï¼š race è°å…ˆè¿”å›žè°å…ˆè¾“å‡ºï¼›all åªæœ‰æœ‰ä¸€ä¸ªå¤±è´¥åŠå…¨éƒ¨å¤±è´¥ï¼Œå…¨éƒ¨æˆåŠŸæ‰ä¼šè¿”å›žï¼›allSettled ä¸ç®¡æ˜¯å¦æˆåŠŸéƒ½ä¼šè¿”å›žï¼Œä¸”æ¯ä¸ªè¿”å›žæºå¸¦ Promise çŠ¶æ€ã€‚ è¿™é‡Œæˆ‘ä»¬å®žçŽ° Promise.all å‡½æ•°æ ¸å¿ƒæ€è·¯ï¼š è¿”å›žä¸€ä¸ªå¤§Promiseï¼Œç„¶åŽéåŽ†å†…éƒ¨promiseå‡½æ•°ï¼Œæ‰§è¡ŒæˆåŠŸè®¡æ•°å™¨åŠ ä¸€ï¼Œå…¨éƒ¨æ‰§è¡Œå®Œæ¯•åˆ™è¿”å›ž 123456789101112131415161718192021222324252627282930313233343536const PromiseAll = function(promiseArr=[]) &#123; return new Promise((resolve, reject) =&gt; &#123; let result = [] let completeIndex = 0 if (!Array.isArray(promiseArr)) &#123; const type = typeof promiseArr reject(`TypeError: $&#123;type&#125; $&#123;promiseArr&#125; is not iterable`) &#125; promiseArr.forEach((promise, index) =&gt; &#123; Promise.resolve(promise).then(res =&gt; &#123; result[index] = res completeIndex++ if (promiseArr.length === completeIndex ) &#123; resolve(result) &#125; &#125;).catch(err =&gt; &#123; reject(err) &#125;) &#125;) &#125;)&#125;// ç¤ºä¾‹ç”¨æ³•const promise1 = Promise.resolve(3);const promise2 = 42;const promise3 = new Promise((resolve, reject) =&gt; &#123; setTimeout(resolve, 1000, 'foo');&#125;);promiseAll([promise1, promise2, promise3]) .then((results) =&gt; &#123; console.log(results); // [3, 42, 'foo'] &#125;) .catch((error) =&gt; &#123; console.error(error); &#125;);]]></content>
      <categories>
        <category>æ¯æ—¥ä¸€é¢˜</category>
      </categories>
      <tags>
        <tag>è…¾è®¯</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æœåŠ¡å™¨éƒ¨ç½²-flask]]></title>
    <url>%2F2020%2F09%2F17%2Fflask-deploy%2F</url>
    <content type="text"><![CDATA[å‰è¨€centos ç³»åˆ—çš„äº‘æœåŠ¡å™¨ä¸€èˆ¬è‡ªå¸¦Python3.6ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹Pythonæ˜¯å¦æå‰å®‰è£… whereis python æœåŠ¡å™¨çš„åŸºæœ¬é…ç½®å¯å‚è€ƒä¹‹å‰çš„ æœåŠ¡å™¨éƒ¨ç½²-Node ä¸€æ–‡ å·¥å…·ï¼š äº‘æœåŠ¡å™¨ Xshell Navicat Postman è™šæ‹ŸçŽ¯å¢ƒæœ¬åœ°æµ‹è¯•è·‘é€šçš„é¡¹ç›®ï¼Œç”Ÿæˆ requirement.txt æˆ– Pipfileæ–‡ä»¶ï¼Œé€šè¿‡Xshellå¯¼å…¥åˆ°æœåŠ¡å™¨ç›®å½•ä¸‹ï¼Œä½¿ç”¨ pipenv install åˆ›å»ºè™šæ‹ŸçŽ¯å¢ƒï¼Œå¹¶å®‰è£…ä¾èµ–ã€‚ å®‰è£…ä¾èµ–å¼‚å¸¸è¿™é‡Œå¸¸è§çš„æŠ¥é”™ä¸ºå®‰è£…è¶…æ—¶ timeout ï¼Œ pip å¯ä»¥æŒ‡å®šå®‰è£…æºã€‚ é˜¿é‡Œäº‘ http://mirrors.aliyun.com/pypi/simple/ ä¸­å›½ç§‘æŠ€å¤§å­¦ https://pypi.mirrors.ustc.edu.cn/simple/ è±†ç“£(douban) http://pypi.douban.com/simple/ æ¸…åŽå¤§å­¦ https://pypi.tuna.tsinghua.edu.cn/simple/ ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦ http://pypi.mirrors.ustc.edu.cn/simple/ ä¸´æ—¶æŒ‡å®šå®‰è£…æº pip install -i https://pypi.tuna.tsinghua.edu.cn/simple æ°¸ä¹…æŒ‡å®šå®‰è£…æº linux ä¿®æ”¹ ~/.pip/pip.conf (æ²¡æœ‰å°±åˆ›å»ºä¸€ä¸ª)ï¼Œ å†…å®¹å¦‚ä¸‹ [global]index-url = https://pypi.tuna.tsinghua.edu.cn/simple windows ç›´æŽ¥åœ¨userç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªpipç›®å½•ï¼Œå¦‚ï¼šC:\Users\xx\pipï¼Œæ–°å»ºæ–‡ä»¶pip.ini [global]index-url = https://pypi.tuna.tsinghua.edu.cn/simple æœåŠ¡å™¨è¿è¡Œä¾èµ–éƒ½å·²ç»å¯¼å…¥åŽï¼Œå°è¯•è¿è¡Œé¡¹ç›®çš„å…¥å£æ–‡ä»¶ï¼Œå¦‚æžœæŠ¥é”™ï¼Œè¯·å…ˆè§£å†³é”™è¯¯ã€‚ å¦‚æžœæ²¡æœ‰é”™è¯¯ï¼Œæ­¤æ—¶çš„é¡¹ç›®è¿è¡Œåœ¨ localhost:5000 ç«¯å£ï¼Œæˆ‘ä»¬åœ¨å¤–éƒ¨æ˜¯æ— æ³•è®¿é—®çš„ï¼Œæˆ‘ä»¬ä¿®æ”¹é¡¹ç›®å…¥å£æ–‡ä»¶host: 12if __name__ == "__main__": app.run(host="0.0.0.0", port=5000, debug=True) æ¥ç›‘å¬æ‰€æœ‰çš„ç«¯å£è¯·æ±‚ã€‚ ç«¯å£å®‰å…¨ç»„é¡¹ç›®ç›‘å¬0.0.0.0ï¼Œå´åœ¨å¤–é¢è¿˜æ˜¯æ— æ³•è®¿é—®ï¼ä½¿ç”¨ nmap your ipAddress æ¥æŸ¥çœ‹å¼€æ”¾çš„æŽ¥å£ï¼Œè¿™é‡Œ5000ç«¯å£æ˜¯ä¸å­˜åœ¨çš„ï¼Œeg: nmap 108.16.12.26 5000ç«¯å£æœªè¢«å¼€æ”¾ï¼Œå¯ä»¥ä½¿ç”¨é˜²ç«å¢™å‘½ä»¤å¼€å¯5000ç«¯å£ï¼Œé˜²ç«å¢™å‘½ä»¤è§ æœåŠ¡å™¨éƒ¨ç½²-Node å¼€å¯äº†é˜²ç«å¢™ä¹‹åŽï¼Œå¦‚æžœå¯ä»¥è®¿é—®5000ç«¯å£äº†ï¼Œé‚£ä¹ˆæ­å–œä½ ã€‚å¦‚æžœé˜²ç«å¢™å¼€å¯5000ç«¯å£æˆ–è€…å…³é—­é˜²ç«å¢™ä¾ç„¶æ— æ³•è®¿é—®ï¼Œé‚£ä¹ˆè¿™é‡Œéœ€è¦åŽ»äº‘æœåŠ¡å™¨æ‰¾åˆ°å®‰å…¨ç»„ -&gt; åˆ›å»ºå®‰å…¨ç»„ -&gt; å…è®¸è®¿é—®æ‰€æœ‰ç«¯å£ï¼Œä¹‹åŽåœ¨åˆ›å»ºå¥½çš„å®‰å…¨ç»„ï¼Œç‚¹å‡»è¿›åŽ»çœ‹åˆ° å…³è”äº‘æœåŠ¡å™¨ ï¼Œé€‰æ‹©ä½ çš„æœåŠ¡å™¨å®žä¾‹å³å¯ã€‚å¦‚æ­¤ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥åœ¨å¤–ç½‘è®¿é—®åˆ°ç¨‹åº gunicorn gevevntå¯ä»¥è®¿é—®é¡¹ç›®åŽï¼Œå½“å…³é—­ Xshell åŽï¼Œé¡¹ç›®ä»ç„¶æ— æ³•è¢«è®¿é—®ï¼Œæ‰€ä»¥æ‰€ä»¥è¿™é‡Œä½¿ç”¨ gunicorn æ¥åšæŒä¹…è®¿é—®ã€‚ å®‰è£…gunicorn gevevntï¼Œ gevent å¯¹Windowså…¼å®¹ä¸æ˜¯å¾ˆå¥½ã€‚ pip install gunicorn gevevnt å®‰è£…å¥½ä¹‹åŽï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•å»ºç«‹ gunicorn.conf.py å†…å®¹å¦‚ä¸‹ï¼š 123workers = 5 # å®šä¹‰åŒæ—¶å¼€å¯çš„å¤„ç†è¯·æ±‚çš„è¿›ç¨‹æ•°é‡ï¼Œæ ¹æ®ç½‘ç«™æµé‡é€‚å½“è°ƒæ•´worker_class = &quot;gevent&quot; # é‡‡ç”¨geventåº“ï¼Œæ”¯æŒå¼‚æ­¥å¤„ç†è¯·æ±‚ï¼Œæé«˜åžåé‡bind = &quot;0.0.0.0:5000&quot; ä½¿ç”¨å‘½ä»¤éƒ¨ç½²é¡¹ç›® gunicorn run:app -c gunicorn.conf.py # run:app è¿™é‡Œçš„ run æ˜¯ä½ é¡¹ç›®å…¥å£æ–‡ä»¶ å¯åŠ¨åŽï¼Œå…³é—­ Xshell åŽä¾æ—§å¯ä»¥è®¿é—® é‡å¯å’Œå…³é—­ å…ˆæŸ¥çœ‹è¿›ç¨‹ pstree -ap|grep gunicorn å¾—åˆ°çš„ç»“æžœåŒ…å«æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹å’Œæˆ‘ä»¬ä¹‹å‰é…ç½®çš„çº¿ç¨‹æ•°ï¼Œè¿™é‡Œæ“ä½œçš„æ˜¯è¿›ç¨‹pidã€‚ kill -9 pid # å…³é—­è¿›ç¨‹ kill -HUP pid # é‡å¯è¿›ç¨‹ dockerå®¹å™¨éƒ¨ç½² dockerå®‰è£…å‡ºçŽ°äº†æŠ¥é”™ â€œProblem: package docker-ce-3:19.03.8-3.el7.x86_64 requires containerd.io &gt;= 1.2.2-3, but none of the providers can be installedâ€è§£å†³åŠžæ³• åœ¨è¿™é‡Œ å¯åŠ¨docker service docker start åˆ›å»º Dockerfile æ–‡ä»¶ 123456789FROM python:3.6WORKDIR /project/PythonProjectCOPY requirements.txt ./RUN pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simpleCOPY . .CMD [&quot;gunicorn&quot;, &quot;ginger:app&quot;, &quot;-c&quot;, &quot;./gunicorn.conf.py&quot;] æž„å»º docker é•œåƒ (æ—¶é—´è¾ƒé•¿) docker build -t â€˜testflaskâ€™ . å®Œæˆé•œåƒåŽï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹ docker images ä¼šå‘çŽ°å­˜åœ¨ä¸€ä¸ª â€˜testflaskâ€™é•œåƒå­˜åœ¨ é…ç½®é˜¿é‡Œäº‘é•œåƒä»“åº“ åœ¨é˜¿é‡Œäº‘dockerhub ç‚¹å‡»è¿™é‡Œ , æ³¨å†Œè´¦å·ï¼Œä»–ä¼šç”Ÿæˆä¸€ä¸ªé˜¿é‡Œäº‘é•œåƒåŠ é€Ÿé“¾æŽ¥ï¼Œï¼ˆä¸é€‚ç”¨å›½å¤–çš„dockerhubï¼ŒåŽŸå› ä½ æ‡‚çš„ï¼Œç½‘ç»œé—®é¢˜ï¼‰ï¼Œ å°†è¿™ä¸ª åŠ é€Ÿé“¾æŽ¥ é…ç½®åœ¨æˆ‘ä»¬çš„æœåŠ¡å™¨ä¸Š /etc/docker/daemon.json æ³¨æ„ï¼š ä¸å­˜åœ¨ /etc/docker/daemon.json åˆ™åˆ›å»ºè¯¥æ–‡ä»¶ï¼å¹¶å¤åˆ¶é“¾æŽ¥è¿›åŽ» &lt;!-- /etc/docker/daemon.json --&gt; { &quot;registry-mirrors&quot;: [&quot;https:********.liyuncs.com&quot;] } é‡æ–°åŠ è½½æœåŠ¡é…ç½®æ–‡ä»¶ systemctl daemon-reload é‡å¯Docker systemctl restart docker æŸ¥çœ‹æœ¬åœ°é•œåƒ docker inages æŽ¨é€é•œåƒåˆ°é˜¿é‡Œäº‘é•œåƒä»“åº“ docker tag 70517a163731 registry.cn-hangzhou.aliyuncs.com/å‘½åç©ºé—´/ä»“åº“åç§°:[é•œåƒç‰ˆæœ¬å·]docker push registry.cn-hangzhou.aliyuncs.com/å‘½åç©ºé—´/ä»“åº“åç§°:[é•œåƒç‰ˆæœ¬å·] è¿è¡Œtestginger ä½¿æˆ‘ä»¬çš„ docker imagesï¼Œç«¯å£æ˜ å°„å‰é¢æ˜¯å®¹å™¨çš„ç«¯å£ã€åŽé¢æ˜¯é¡¹ç›®æš´éœ²å¤„çš„ç«¯å£ï¼Œç›¸å½“äºŽä¸€å±‚ä»£ç†ã€‚ docker run -d -p 8080:5000 testgingeræ­¤æ—¶ï¼Œä½¿ç”¨ nmap your id address æŸ¥çœ‹æœåŠ¡å™¨ç«¯æŽ¥å£å ç”¨ï¼Œ8080æ˜¯å¼€å¯çš„ã€‚ æ—¥å¿— docker logs [options]docker logs â€“tail=â€10â€ CONTAINER ID é‡æ–°build docker build -t ginger:test . åˆ é™¤é•œåƒåˆæ¬¡éƒ¨ç½²æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šåˆ›é€ å¤šä¸ªé•œåƒï¼Œå¾…æˆåŠŸéƒ¨ç½²åŽï¼Œæˆ‘ä»¬å¯ä»¥åˆ é™¤å¤šæœ‰çš„æ— ç”¨é•œåƒå®¹å™¨ã€‚ docker rmi -f image_id å‘½ä»¤ æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„é•œåƒå®¹å™¨ docker ps æŸ¥çœ‹æ‰€æœ‰å­˜åœ¨çš„é•œåƒå®¹å™¨ docker ps -a åœæ­¢é•œåƒå®¹å™¨ docker stop image_id]]></content>
      <categories>
        <category>é»˜è®¤</category>
      </categories>
      <tags>
        <tag>é»˜è®¤</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æœåŠ¡å™¨éƒ¨ç½²-Node]]></title>
    <url>%2F2020%2F06%2F09%2Fserver%2F</url>
    <content type="text"><![CDATA[é…ç½®æœåŠ¡å™¨è´­ä¹°çš„æœåŠ¡å™¨ï¼Œå±žäºŽä¸€ä¸ªç©ºå£³å­ï¼Œå®‰è£…æˆ‘ä»¬éœ€è¦çš„Gitã€nodeç­‰ç¨‹åºï¼Œä½¿ç”¨Xshellè¿›è¡ŒæŽ§åˆ¶ã€‚ Gitè¿žæŽ¥ä»“åº“ ç”Ÿæˆç§˜é’¥ï¼Œå¹¶å°†å…¬é’¥æ³¨å†Œåœ¨Gitä»“åº“å³å¯ cd ~/.ssh å®‰è£…MySQL ç›®å½•åˆ‡æ¢è‡³rootä¸‹ï¼Œ cd ~ ä¸‹è½½ä¸Žå®‰è£…mysql, æ­¥éª¤å¦‚ä¸‹ å®‰è£…MySQLå®˜æ–¹çš„yum repositoryï¼š wget -i -c http://dev.mysql.com/get/mysql57-community-release-el7-10.noarch.rpm ä¸‹è½½rpmåŒ… yum -y install mysql57-community-release-el7-10.noarch.rpm å®‰è£…MySQLæœåŠ¡ yum -y install mysql-community-server,éœ€è¦ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œæœ€åŽå‡ºçŽ° completeï¼ å¯åŠ¨MySQLæœåŠ¡ systemctl start mysqld.service æŸ¥çœ‹MySQLçŠ¶æ€ systemctl status mysqld.service èŽ·å–åˆå§‹å¯†ç  grep &quot;password&quot; /var/log/mysqld.log,å¤åˆ¶ä¸‹æ¥ï¼Œå¾…ä¼šä¿®æ”¹å¯†ç è¦ç”¨åˆ° ç™»å½•MySQL mysql -u root -pï¼Œæ‰§è¡ŒåŽè¾“å…¥åˆšåˆšå¤åˆ¶çš„å¯†ç å³å¯ç™»å½•æˆåŠŸï¼ŒæˆåŠŸåŽä¼šå±•ç¤ºMySQLçš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œè¿™é‡Œæ˜¯5.7.X æ‰§è¡ŒMySQLè¯­å¥ set global validate_password_policy=0;set global validate_password_length=1;ä¹‹åŽæ‰å¯ä»¥ä¿®æ”¹å¯†ç ï¼ˆè¿™é‡Œæ˜¯5.7ç‰ˆæœ¬çš„ä¿®æ”¹å¯†ç æ–¹æ³•ï¼‰ ä¿®æ”¹MySQLå¯†ç  set password for root@localhost = password(&#39;123456&#39;); rootæ˜¯ç”¨æˆ·åï¼Œå¯è‡ªå®šä¹‰ã€‚ é€€å‡ºä½¿ç”¨æ–°å¯†ç é‡æ–°ç™»å½• é…ç½®mysqlï¼Œåœ¨etc/ç›®å½•ä¸‹,ç¼–è¾‘ï¼ˆä¸å­˜åœ¨åˆ™æ–°å»ºï¼‰my.cnfæ–‡ä»¶ï¼Œé‡å¯MySQL é…ç½®ç”¨æˆ·ï¼Œä½¿å¾—rootç”¨æˆ·åœ¨å¤–ç½‘ä¹Ÿå¯ä»¥è®¿é—®åˆ°mysqlï¼Œ # mysql -h 127.0.0.1 -u root # mysql&gt;use mysql; # mysql&gt;update user set host = &apos;%&apos; where user =&apos;root&apos;; # mysql&gt;select host, user from user; # mysql&gt;flush privileges; é‡å¯mysqlæœåŠ¡ service mysqld restart; mysqlå¼‚å¸¸é›†åˆ è¿è¡Œç¨‹åºmysqlæŠ¥é”™ (node:6280) UnhandledPromiseRejectionWarning: SequelizeDatabaseError: Illegal mix of collations (latin1_swedish_ci,IMPLICIT) and (utf8mb4_unicode_ci,COERCIBLE) forï¼ŒåŽŸå› ä¸ºsequelizeåˆ›å»ºçš„mysqlé»˜è®¤å­—ç¬¦é›†æ˜¯ latin1 è€Œä¸æ˜¯ utf8ï¼Œæ›´æ”¹å³å¯ã€‚ rootç”¨æˆ·ä¸¢å¤±è¡¨çŽ°: è¾“å…¥å¯†ç é¡µæ— æ³•è®¿é—®mysql.useré‡Œé¢ï¼Œrootç”¨æˆ·ç”±äºŽæœªçŸ¥åŽŸå› ä¸åœ¨äº†ï¼Œé‡æ–°å»ºç«‹rootç”¨æˆ· å¿½ç•¥å¯†ç ç™»å½•- vim etc/my.cnf skip-grant-tables åˆ›å»ºrootç”¨æˆ· create user â€˜rootâ€™@â€™localhostâ€™ identified by â€˜123456â€™; æ­¤æ­¥éª¤å¯èƒ½ä¼šæŠ¥ä»¥ä¸‹é”™è¯¯: æ²¡æŠ¥é”™çš„è·³è¿‡ï¼ˆç›´æŽ¥åˆ°æƒé™é‚£ä¸€æ­¥ï¼‰ï¼Œç”¨ä»¥ä¸‹æ–¹æ³•è§£å†³ï¼š ERROR 1290 (HY000): The MySQL server is running with the â€“skip-grant-tables option so it cannot execute this statement è§£å†³ï¼š flush privileges; å†æ¬¡åˆ›å»ºrootç”¨æˆ· create user â€˜rootâ€™@â€™localhostâ€™ identified by â€˜123456â€™; ç”±äºŽå¯èƒ½å­˜åœ¨rootç”¨æˆ·ï¼Œå¯¼è‡´ä¼šæŠ¥é”™ï¼Œåˆ é™¤ç”¨æˆ·åœ¨åˆ›å»º drop user â€˜rootâ€™@â€™localhostâ€™;create user â€˜rootâ€™@â€™localhostâ€™ identified by â€˜123456â€™; èµ‹äºˆrootç”¨æˆ·å…¨éƒ¨æƒé™ GRANT ALL PRIVILEGES ON . TO â€˜rootâ€™@â€™%â€™ IDENTIFIED BY â€˜123456â€™flush privileges; 1396 æŠ¥é”™ flush privileges;drop user â€˜dlâ€™@â€™%â€™;create user â€˜dlâ€™@â€™%â€™ identified by â€˜123â€™; nmapä½¿ç”¨è¯¥å‘½ä»¤æŸ¥çœ‹æœåŠ¡å™¨å¼€æ”¾çš„ç«¯å£ï¼ŒæŸ¥çœ‹3306ç«¯å£æ˜¯å¦é˜²ç«å¢™ä¸­å…è®¸è®¿é—®ã€‚ yum -y install nmapnmap 192.168.1.56 telnetæ£€æŸ¥æˆ‘ä»¬çš„IPæ˜¯å¦å¯ä»¥pingåŒ ä¾‹å¦‚telnet 192.168.157.129 80 é˜²ç«å¢™ç«¯å£expressç¨‹åºé»˜è®¤è¿è¡Œåœ¨ 3000 ç«¯å£ï¼Œäº‘æœåŠ¡å™¨é»˜è®¤æ˜¯æ²¡æœ‰å¼€æ”¾ 3000 ç«¯å£çš„ï¼Œéœ€è¦æˆ‘ä»¬æ‰‹åŠ¨å¼€å¯ 3000 ç«¯å£ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š firewall-cmd --zone=public --add-port=3000/tcp --permanenté‡å¯é˜²ç«å¢™firewall-cmd --reload å¦‚æŠ¥é”™FirewallD is not running,åˆ™å¼€å¯é˜²ç«å¢™systemctl start firewalld ä½¿ç”¨nmapæŸ¥çœ‹çŽ°åœ¨çš„ç«¯å£æƒ…å†µï¼Œ3000ç«¯å£å·²ç»å¼€å¯ã€‚nmap yourIpAddress pm2è¿›ç¨‹ç®¡ç†æœ¬åœ°æœåŠ¡åœ¨æˆ‘ä»¬å…³é—­å‘½ä»¤çª—å£åŽä¼šåœæ­¢æœåŠ¡ï¼Œä½¿ç”¨pm2 ç®¡ç†æˆ‘ä»¬çš„æœåŠ¡ï¼Œæœ¬åœ°è°ƒè¯•å¥½ä¹‹åŽä¼ åˆ°gitï¼ŒXshellä¸­ç›´æŽ¥æ‹‰å–æœ€æ–°ä»£ç ï¼Œè¿›å…¥é¡¹ç›®æ ¹ç›®å½•ï¼Œä½¿ç”¨pm2ç®¡ç†è¿›ç¨‹ï¼Œå³ä½¿æˆ‘ä»¬å…³é—­xshellï¼ŒæœåŠ¡ä¾ç„¶è¿˜åœ¨è·‘ã€‚1ã€pm2éœ€è¦å…¨å±€å®‰è£…npm install -g pm22ã€è¿›å…¥é¡¹ç›®æ ¹ç›®å½•2.1 å¯åŠ¨è¿›ç¨‹/åº”ç”¨ pm2 start bin/www æˆ– pm2 start app.js 2.2 é‡å‘½åè¿›ç¨‹/åº”ç”¨ pm2 start app.js â€“name wb123 2.3 æ·»åŠ è¿›ç¨‹/åº”ç”¨ watch pm2 start bin/www â€“watch 2.4 ç»“æŸè¿›ç¨‹/åº”ç”¨ pm2 stop wwwb 2.5 ç»“æŸæ‰€æœ‰è¿›ç¨‹/åº”ç”¨ pm2 stop all 2.6 åˆ é™¤è¿›ç¨‹/åº”ç”¨ pm2 delete www 2.7 åˆ é™¤æ‰€æœ‰è¿›ç¨‹/åº”ç”¨ pm2 delete all 2.8 åˆ—å‡ºæ‰€æœ‰è¿›ç¨‹/åº”ç”¨ pm2 list 2.9 æŸ¥çœ‹æŸä¸ªè¿›ç¨‹/åº”ç”¨å…·ä½“æƒ…å†µ pm2 describe www 2.10 æŸ¥çœ‹è¿›ç¨‹/åº”ç”¨çš„èµ„æºæ¶ˆè€—æƒ…å†µ pm2 monit 2.11 æŸ¥çœ‹pm2çš„æ—¥å¿— pm2 logs 2.12 è‹¥è¦æŸ¥çœ‹æŸä¸ªè¿›ç¨‹/åº”ç”¨çš„æ—¥å¿—,ä½¿ç”¨ pm2 logs www 2.13 é‡æ–°å¯åŠ¨è¿›ç¨‹/åº”ç”¨ pm2 restart www 2.14 é‡æ–°å¯åŠ¨æ‰€æœ‰è¿›ç¨‹/åº”ç”¨ pm2 restart all 2.15 ç›‘å¬ä¿®æ”¹ï¼Œè‡ªåŠ¨é‡å¯ pm2 start xxx â€“watch nginxä»£ç†å®‰è£…nginxï¼Œé“¾æŽ¥ï¼š https://www.cnblogs.com/shiyuelp/p/11945882.htmlè·¯å¾„ï¼š /usr/local/nginx/sbiné…ç½®æ–‡ä»¶ä¿®æ”¹ï¼š/usr/local/nginx/configæ³¨æ„ç‚¹ï¼š nginxé»˜è®¤åœ¨80ç«¯å£ï¼Œè€ŒæœåŠ¡å™¨é»˜è®¤ä¸å¼€æ”¾80ç«¯å£ã€‚éœ€è¦æ‰‹åŠ¨æ‰“å¼€80ç«¯å£ã€‚æŸ¥çœ‹nginxæ˜¯å¦å¯åŠ¨æˆåŠŸï¼š ps aux|grep nginx;æ£€æŸ¥IPæ˜¯å¦å¯ä»¥pingé€šï¼š telnet 106.13.4.74 80ï¼›å¯åŠ¨nginxï¼š /usr/local/nginx/sbin/nginxé‡å¯nginxï¼š /usr/local/nginx/sbin/nginx -s reopenå…³é—­nginxï¼š /usr/local/nginx/sbin/nginx -s stop é…ç½®æ–‡ä»¶å¯ä»¥è‡ªå·±ä¿®æ”¹ åŸŸåæ˜ å°„åŸŸåæ˜ å°„è¿™å—å…¶å®žæ²¡å¿…è¦å•ç‹¬å†ä¹°ä¸€ä¸ªåŸŸåï¼Œå¦‚æžœè‡ªå·±æœ‰åŸŸåçš„è¯ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªäºŒçº§åŸŸåæ¥ä»£æ›¿ã€‚è¿™é‡Œä»¥é˜¿é‡Œäº‘çš„åŸŸåä¸ºä¾‹ã€‚åœ¨é˜¿é‡Œäº‘çš„åŸŸåè§£æžè®¾ç½®ä¸­ï¼Œæ·»åŠ ä¸€ä¸ªè®°å½•ï¼Œä¸»æœºè®°å½•é‚£é‡Œå°±æ˜¯å¡«å†™æˆ‘ä»¬äºŒçº§åŸŸåçš„åœ°æ–¹ï¼Œè®°å½•å€¼å¡«å†™æœåŠ¡å™¨çš„IPåœ°å€ï¼Œæ·»åŠ å®ŒæˆåŽå³å¯ä½¿ç”¨åŸŸåè®¿é—®æœåŠ¡å™¨äº†ã€‚å¯ä»¥ç›´æŽ¥åœ¨æµè§ˆå™¨è¾“å…¥åˆšåˆšé…ç½®äºŒçº§åŸŸåï¼Œçœ‹çœ‹æ˜¯å¦æœ‰nginxæ¬¢è¿Žé¡µå³å¯ã€‚ redis]]></content>
      <categories>
        <category>server</category>
      </categories>
      <tags>
        <tag>Programming</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python-flask]]></title>
    <url>%2F2020%2F06%2F05%2Fflask%2F</url>
    <content type="text"><![CDATA[Base pointpycharmä¸­æ‰“å¼€debugæ¨¡å¼ï¼šåœ¨ç»ˆç«¯ä¸­è®¾ç½®ï¼š set FLASK_ENV=development (windows)export FLASK_ENV=developm (mac)flask runå¼€å¯debugä¼š æ¿€æ´»è°ƒè¯•å™¨ã€‚ æ¿€æ´»è‡ªåŠ¨é‡è½½ã€‚ æ‰“å¼€ Flask åº”ç”¨çš„è°ƒè¯•æ¨¡å¼ã€‚ åˆ›å»ºè™šæ‹ŸçŽ¯å¢ƒ python -m venv env æ¿€æ´»è™šæ‹ŸçŽ¯å¢ƒï¼ˆwinï¼‰ $ env\Scripts\activateç„¶åŽåœ¨è™šæ‹ŸçŽ¯å¢ƒä¸­å®‰è£…flaskç­‰ ä¾èµ– ç”Ÿæˆä¾èµ–æ–‡ä»¶ pip freeze &gt; requirements.txt å®‰è£…ä¾èµ– pip install -r requirements.txt flask_scriptflaks_scripté€šè¿‡å‘½ä»¤çš„æ–¹å¼æ“ä½œflaskï¼Œè·‘èµ·æ¥å¼€å‘ç‰ˆæœåŠ¡å™¨ã€è®¾ç½®æ•°æ®åº“ï¼Œå®šæ—¶ä»»åŠ¡ç­‰ã€‚ 1234567891011121314# manage.pyfrom flask_script import Managerapp = Flask(__name__)manager = Manager(app)def hello(): passmanager.add_command('hello', hello())# è£…é¥°ç¬¦å‘½ä»¤@manager.commanddef hello(): pass é€šè¿‡è‡ªå®šä¹‰æ–¹æ³•æ“ä½œflaskï¼Œä½¿ç”¨æ–¹æ³•ä¸ºï¼š $ python manage.py hello Blueprintè“å›¾æ¨¡å—ï¼Œå¸®åŠ©æˆ‘ä»¬å¯¹äºŽæ•´ä½“é¡¹ç›®çš„åˆ†å‰²ï¼Œåˆ©äºŽåŽç»­çš„ç®¡ç†å’Œæ‹“å±•ã€‚ä¸»è¦åˆ†ä¸ºè®¾ç½®è“å›¾ï¼Œæ³¨å†Œè“å›¾ï¼Œè·¯ç”±ä½¿ç”¨è“å›¾ä¸‰éƒ¨åˆ†ã€‚ 1234567891011121314151617# @/api/user/controllers.pyfrom flask import Blueprint user = Blueprint('user', __name__)"""åˆ›å»ºç”¨æˆ·"""@user.route('/register', methods= ['get'])def user_register(): pass# @__init__.py def create_app(): app = Falsk(__name__) from om_core.api.user.controllers import user app.register_blueprint(user, url_prefix='/api/users') è‡³æ­¤ï¼ŒURLä½¿ç”¨ localhost:5000/api/users/register å°±å¯ä»¥è®¿é—®æ³¨å†Œè·¯ç”±ã€‚ flask-SQLAlchemy æŸ¥è¯¢ç»“æžœä¸€èˆ¬ä½¿ç”¨db.session.query()æ¥æŸ¥è¯¢ç»“æžœï¼Œç»“æžœè¿”å›žä¸€ä¸ªlistï¼Œå¤šæ¡æ•°æ®å¤„ç†éœ€è¦ç”¨åˆ°éåŽ†ï¼Œå•æŒ‘æ•°æ®åˆ™å¯ä»¥ä½¿ç”¨ä¸€ä¸‹æ–¹å¼èŽ·å¾—å€¼å¹¶è¿”å›ž user = db.session.query(User).filter_by(name=â€™â€™liming).all() æ•°æ®æŽ¥æ”¶ post jsonæ ¼å¼ data = json.loads(request.get_data(as_text = True))name = data.get(â€˜nameâ€™) get URLæ‹¼æŽ¥ param = request.args[â€˜paramâ€™] æ–°å¢žæ•°æ®å¹¶æäº¤æ•°æ®åº“ user = User(name=â€xxxâ€, dender=0)db.session.add(user)db.session.commit() æ›´æ–°æ•°æ® user = db.session.query(User).filter(name=param.get(â€˜nameâ€™)).first()user.attr = param.get(â€˜attrâ€™)db.session.commit() Fakerç”Ÿæˆå¤§é‡çš„æ¨¡æ‹Ÿæ•°æ® pip install Faker 12345678910111213from faker import Fakerfaker = Faker('zh-CN') # é»˜è®¤ç¾Žå›½for item in range(100): fname = faker.name() faddress = faker.address() fint = faker.pyint() user = User(name=fname, address=faddress, xxx=fint) db.session.add(user)try: db.session.commit()except: db.session.rollback() flask_restplus pip install flask-restplus from flask_restplus import Api Flask-RESTPlusæä¾›çš„ä¸»è¦åˆ›å»ºå¯¹è±¡å°±æ˜¯èµ„æºã€‚èµ„æºåˆ›å»ºäºŽFlaskå¯æ’å…¥è§†å›¾ï¼ˆpluggable viewï¼‰ä¹‹ä¸Šï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨èµ„æºä¸Šå®šä¹‰æ–¹æ³•æ¥å¾ˆå®¹æ˜“åœ°è®¿é—®å¤šä¸ªHTTPæ–¹æ³•ã€‚ flask_corsè§£å†³è·¨åŸŸ from flask_cors import CORS if Config.FLASK_ENV == â€˜DEVELOPMENTâ€™: CORS(app, supports_credentials=True) namedtuplenamedtupleæ˜¯ç»§æ‰¿è‡ªtupleçš„å­ç±»ã€‚namedtupleåˆ›å»ºä¸€ä¸ªå’Œtupleç±»ä¼¼çš„å¯¹è±¡ï¼Œè€Œä¸”å¯¹è±¡æ‹¥æœ‰å¯è®¿é—®çš„å±žæ€§ã€‚ ç”¨æˆ·æƒé™ç»†ç²’åº¦ç®¡ç†ç”¨æˆ·æƒé™æ˜¯ä¸€ä¸ªå¸¸è§çš„ä¸šåŠ¡ï¼Œè¿™é‡Œä½¿ç”¨scopeæ¨¡å—åœ¨ token è¿›è¡ŒéªŒè¯æ—¶åˆ¤æ–­ç”¨æˆ·çš„æŽ¥å£è®¿é—®æƒé™ï¼Œå¹¶ä¸”è‡ªå®šä¹‰çš„ scope å¯ä»¥è¿›è¡Œæƒé™çš„åˆå¹¶ä¸Žç­›é€‰ï¼Œè¿›è¡Œæ™®é€šç”¨æˆ·å’Œç®¡ç†å‘˜æƒé™åŒºåˆ†ã€‚scope æä¾›ä¸¤å¥—æƒé™æœºåˆ¶ï¼Œapiçº§åˆ«å’Œè“å›¾çº§åˆ«ï¼Œç²’åº¦ç²—ç»†å¯ä»¥è‡ªå·±é€‰æ‹©ï¼Œååˆ†çµæ´»ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596# scope.pyclass Scope: allow_api = [] # api çº§åˆ«çš„æƒé™æŽ§åˆ¶ ç²’åº¦ç»† allow_module = [] # è“å›¾çº§åˆ«æƒé™æŽ§åˆ¶ ç²’åº¦ç²— forbidden = [] # æƒé™ç­›é€‰ def __add__(self, other): # ç®¡ç†å‘˜åˆå¹¶æ™®é€šç”¨æˆ·æƒé™ # è¿ç®—ç¬¦é‡è½½ self.allow_api = self.allow_api + other.allow_api # set åŽ»é‡ self.allow_api = list(set(self.allow_api)) # çº¢å›¾çº§åˆ«æƒé™ç›¸åŠ  self.allow_module = self.allow_module + other.allow_module self.allow_module = list(set(self.allow_module)) # é€†å‘ç­›é€‰æƒé™ self.forbidden = self.forbidden + other.forbidden self.forbidden = list(set(self.forbidden)) return selfclass UserScope(Scope): allow_api = ['v1.user+get_user'] allow_module = [] forbidden = ['v1.user+super_get_user', 'v1.user+super_delete_user'] def __init__(self): self + AdminScope()class AdminScope(Scope): # allow_api = ['v1.user+super_get_user', # 'v1.user+super_delete_user'] allow_module = ['v1.user'] def __init__(self): # æŽ’é™¤ ç­›é€‰è§†å›¾å‡½æ•° # self + UserScope() pass def is_in_scope(scope, endpoint): # scope() # globals # åå°„ # token å†…éƒ¨æºå¸¦æƒé™å‚æ•°ï¼Œç›´æŽ¥åˆ¤æ–­æƒé™ # v1.red_name + view_func scope = globals()[scope]() splits = endpoint.split('+') red_name = splits[0] if endpoint in scope.forbidden: return False if endpoint in scope.allow_api: return True if red_name in scope.allow_module: return True else: return False# token_auth.py from app.libs.scope import is_in_scopeauth = HTTPBasicAuth()User = namedtuple('User', ['uid', 'ac_type', 'scope'])@auth.verify_passworddef verify_password(token, password): user_info = verify_auth_token(token) if not user_info: return False else: g.user = user_info return Truedef verify_auth_token(token): s = Serializer(current_app.config['SECRET_KEY']) try: data = s.loads(token) except BadSignature: raise AuthFailed(msg='token is invalid', error_code=1002) except SignatureExpired: raise AuthFailed(msg='token is expired', error_code=1003) uid = data['uid'] ac_type = data['type'] scope = data['scope'] # è§†å›¾å‡½æ•° allow = is_in_scope(scope, request.endpoint) print('éªŒè¯tokenå‚æ•°--', uid, ac_type, scope, request.endpoint) if not allow: # åœ¨è¿™é‡Œæ‹¦æˆªä¸åŒæƒé™ç”¨æˆ· raise Forbidden() return User(uid, ac_type, scope)]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Programming</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Express]]></title>
    <url>%2F2020%2F05%2F22%2Fexpress%2F</url>
    <content type="text"><![CDATA[expressæ–‡æ¡£ ï¼š https://www.expressjs.com.cn/guide/using-middleware.htmlsequelizeæ–‡æ¡£: https://github.com/demopark/sequelize-docs-Zh-CN/blob/master/Readme.md ORM(sequelize)ORMï¼ˆObject Relational Mappingï¼‰å¯¹è±¡å…³ç³»æ˜ å°„ï¼Œå‡å°æ“ä½œå±‚çš„ä»£ç é‡ï¼Œç›´æŽ¥æ–¹ä¾¿çš„æ“ä½œæ•°æ®åº“ã€‚ä½¿ç”¨å‰ï¼Œç¡®ä¿sequelizeå·²ç»å®‰è£… 12npm install --save sequelizenpm install --save mysql2 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127/** path: @src/models/message.js*/var Sequelize = require('sequelize')var sequelize = new Sequelize( 'nodesql', //database name 'root', //database user '123456', //database password &#123; 'dialect': 'mysql', 'host': 'localhost', 'port': 3306 &#125;)//è¡¨æ¨¡åž‹var Message = sequelize.define('message', &#123; id: &#123; type: Sequelize.INTEGER, primaryKey: true, autoIncrement: true, &#125;, userName: &#123; type: Sequelize.STRING(32), &#125;, content: &#123; type: Sequelize.TEXT &#125;&#125;)const User = sequelize.define('user', &#123; id: &#123; type: Sequelize.INTEGER, primaryKey: true, autoIncrement: true, &#125;, userName: &#123; type: Sequelize.STRING(32), &#125;, age: &#123; type: Sequelize.INTEGER &#125;, gender: &#123; type: Sequelize.INTEGER &#125;, address: &#123; type: Sequelize.STRING(32) &#125;&#125;)Message.sync(); //åˆ›å»ºè¡¨User.sunc()module.exports = &#123;Message, User&#125;;/** path: @src/route/index.js* desc: åœ¨è·¯ç”±ä¸­å®Œæˆå¢žåˆ æ”¹æŸ¥*/var express = require('express');var router = express.Router();var Message = require('../models/message.js')const setToken = require('../utils/middwares/jwt.js')const &#123;log&#125; = console//REST API//ç”¨æˆ·ç™»å½•router.post('/login', async (req, res, next) =&gt; &#123; const user = &#123;&#125; let &#123;userName&#125; = req.body let data = await User.findOne(&#123; where: &#123; userName: userName &#125; &#125;) // log('æŸ¥è¯¢ç»“æžœè¿”å›žï¼š', JSON.stringify(data, null, 2)) if(!data) &#123; //ä¸å­˜åœ¨ç”¨æˆ·åˆ™åˆ›å»ºç”¨æˆ· user.userName = userName data = await User.create(user) &#125; setToken.setToken(data.id).then(token =&gt; &#123; //è¿”å›žç”¨æˆ·ä¿¡æ¯åŠtoken return res.json(&#123;data: &#123;data, token&#125;&#125;) &#125;)&#125;)//æŸ¥æ‰¾æŸå†…å®¹router.get('/getOne', (req, res, next) =&gt; &#123; if(!req.data) &#123; return res.json(&#123; msg:'token invalid' &#125;) &#125; Message.findAll().then(data =&gt; &#123; log('æŸ¥æ‰¾æ•°æ®res', JSON.stringify(data, null, 2)) res.json(&#123; errcode: 0, data &#125;) &#125;)&#125;)//åˆ é™¤ä¸€ä¸ªç”¨æˆ·router.get('/del_user', async (req, res, next) =&gt; &#123; let &#123;userName&#125; = req.query let result = await User.findOne(&#123; where: &#123;userName,&#125; &#125;) if(!result) &#123; return res.json(&#123;msg: 'ä¸å­˜åœ¨è¯¥ç”¨æˆ·', errcode: 601&#125;) &#125; let data = await result.destroy() return res.json(&#123;msg: 'åˆ é™¤æˆåŠŸ', errcode: 0&#125;)&#125;)//æ›´æ–°ç”¨æˆ·ä¿¡æ¯router.post('/rich_user_info', async (req, res, next) =&gt; &#123; let data = req.body let result = await User.findOne(&#123; where: &#123;userName: data.userName&#125; &#125;) //ç”¨æ•°æ®è¡¨çš„resultå­—æ®µæ¥åŒ¹é…å‰ç«¯ä¸Šä¼ çš„å­—æ®µï¼å‰ç«¯éšä¾¿ä¼ å‚ï¼Œæˆ‘åªè¿‡æ»¤æœ‰ç”¨çš„ Object.keys(result.toJSON()).map(item =&gt; &#123; data[item] ? result[item] = data[item] : '' &#125;) await result.save() res.json(&#123;msg: 'succ', data: result&#125;)&#125;) è‡³æ­¤ï¼ŒåŸºæœ¬çš„sequlizeå°±å¯ä»¥è·‘èµ·æ¥äº†ã€‚ åŽŸç”ŸSQLæ–¹æ³•sequelizeçš„ç¡®æ–¹ä¾¿ï¼Œä½†ä»–çš„æŸ¥è¯¢è¯­å¥è¾ƒä¸ºç¹çï¼Œè¿™é‡Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨åŽŸç”Ÿmysqlè¯­å¥ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263/*** path: utils/dbConfig.js* æ•°æ®åº“é…ç½®*/mysql = &#123; host: 'localhost', user: 'root', password: '123456', database: 'nodesql'&#125;module.exports = mysql;/*** path: @/db.js* æ‰‹åŠ¨è¿žæŽ¥æ•°æ®åº“*/let mysql = require('mysql')let dbConfig = require('./utils/dbConfig')const &#123;log&#125; = consolemodule.exports = &#123; query: function(sql, params, callback) &#123; let conn = mysql.createConnection(dbConfig) conn.connect(function(err) &#123; if(err) &#123; log('æ•°æ®åº“è¿žæŽ¥å¤±è´¥') throw err &#125; conn.query(sql, params, function(err, res, fields) &#123; if(err) &#123; log('æ•°æ®åº“æ“ä½œå¤±è´¥') throw err &#125; callback &amp;&amp; callback(res); conn.end(err =&gt; &#123; if(err) &#123; log('æ•°æ®åº“å…³é—­å¤±è´¥') throw err &#125; &#125;) &#125;) &#125;) &#125;&#125;/*** path: @/route/index.js* è·¯ç”±ä½¿ç”¨*/router.get('/user', (req, res, next) =&gt; &#123; let &#123;id&#125; = req.query const sql = `select * from user where id = $&#123;id&#125;` //å¤æ‚SQLè¯­å¥ db.query(sql, [], function(result, fields) &#123; let data = JSON.parse(JSON.stringify(result)) data1 = req.requestTime res.json(&#123; status: 0, data, data1 &#125;) &#125;)&#125;) ORMå’ŒåŽŸç”ŸSQLè¯­å¥ä¹‹é—´å¹¶ä¸å†²çªï¼Œåˆç†é€‰æ‹©ä½¿ç”¨å³å¯ã€‚ä¸¤ä¸ªä¸€èµ·ç”¨ä¹Ÿå¯ä»¥ JWTï¼ˆtokenéªŒè¯ï¼‰jwt(jsonwebtoken)éªŒè¯ï¼Œå‰åŽç«¯éªŒè¯çš„ä¸€ç§æ–¹æ³•ã€‚expresså®žçŽ°jwtéªŒè¯ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119// å®‰è£… express-jwt$ npm i express-jwt --save /** path: @/util/jwt.js* å°è£…åˆ†å‘tokenå’ŒéªŒè¯tokenå‡½æ•°*/var jwt = require('jsonwebtoken');var signkey = 'secret123456'; //éšæœºä¸²const setToken = function(userid)&#123; return new Promise ((resolve, reject) =&gt; &#123; const token = jwt.sign(&#123; _id: userid &#125;, signkey,&#123; expiresIn:'36h' &#125;); resolve(token); &#125;)&#125;const verToken = function (token) &#123; return new Promise((resolve, reject) =&gt; &#123; var info = jwt.verify(token.split(' ')[1], signkey); if(info) &#123; resolve(info); &#125; else &#123; reject(info) &#125; &#125;)&#125;module.exports = &#123; verToken, setToken,&#125;/*** path: @/routes/index.js* é¦–å…ˆåœ¨loginæŽ¥å£åˆ†å‘token*/var express = require('express');var router = express.Router();var &#123;Message, User&#125; = require('../models/test.js')const jwt = require('jsonwebtoken')const setToken = require('../utils/middwares/jwt.js')// ç™»å½•apirouter.post('/login', async (req, res, next) =&gt; &#123; const user = &#123;&#125; let &#123;account, password&#125; = req.body //å°ç¨‹åºè¿™é‡Œåº”æŽ¥å—codeï¼ŒåŽ»æ¢å–openIDå­˜å‚¨ let data = await User.findOne(&#123; where: &#123; account: account, &#125; &#125;) // console.log('æŸ¥è¯¢ç»“æžœè¿”å›žï¼š', JSON.stringify(data, null, 2)) if(!data) &#123; //ä¸å­˜åœ¨è¯¥ç”¨æˆ·ï¼Œåˆ™åˆ›å»ºç”¨æˆ· user.account = account data = await User.create(user) &#125; setToken.setToken(data.id).then(token =&gt; &#123; return res.json(&#123;data: &#123;data, token&#125;&#125;) &#125;)&#125;)//è¯·æ±‚å†…å®¹router.get('/getOne', (req, res, next) =&gt; &#123; if(!req.data) &#123; //éªŒè¯tokençš„ä¸­é—´ä»¶æˆåŠŸåŽï¼ŒæŠŠéªŒè¯ç»“æžœæ”¾ç½®åœ¨req.dataä¸­ return res.json(&#123; msg:'token invalid', errcode: 600, &#125;) &#125; Message.findAll().then(result =&gt; &#123; res.json(&#123; errcode: 0, result, &#125;) &#125;)&#125;)/*** path: @/app.js* é…ç½®tokenéªŒè¯ä¸­é—´ä»¶*/var jwt = require('jsonwebtoken');var verToken = require('./utils/middwares/jwt.js')app.use(function(req, res, next) &#123; var token = req.headers['authorization'] if(!token) &#123; return next(); &#125; else &#123; verToken.verToken(token).then((data) =&gt; &#123; req.data = data; return next(); &#125;).catch((error)=&gt;&#123; return next(); &#125;) //ä¸Šä¸ºå°è£…æ–¹æ³•,ä¸‹ä¸ºç›´æŽ¥è°ƒç”¨,éƒ½å¯ä»¥ä½¿ç”¨ // let info = jwt.verify(token.split(' ')[1], 'secret123456'); // req.data = info; // next() &#125;&#125;)//è¿‡æ»¤ä¸éœ€è¦tokençš„è·¯ç”±app.use(expressJwt(&#123; secret: 'secret123456' // ç­¾åçš„å¯†é’¥ æˆ– PublicKey&#125;).unless(&#123; path: ['/login',] // æŒ‡å®šè·¯å¾„ä¸ç»è¿‡ Token è§£æž&#125;))//å½“tokenå¤±æ•ˆè¿”å›žæç¤ºä¿¡æ¯app.use(function(err, req, res, next) &#123; if (err.status == 401) &#123; return res.status(401).send(&#123;msg: 'token invalid'&#125;); &#125;&#125;); è‡³æ­¤ï¼ŒtokenéªŒè¯å°±å¯ä»¥è·‘èµ·æ¥äº†ã€‚åœ¨å‘é€httpæ—¶ï¼Œheadersä¸­é…ç½® Authorization: &#39;Bearer ${token}&#39;å³å¯ï¼Œå½“ç„¶è¿˜å¯ä»¥ç»§ç»­å†æ¬¡å°è£…ã€‚ middare(ä¸­é—´ä»¶)ä¸­é—´ä»¶ç”¨æ¥å¤„ç†åŽç«¯æœåŠ¡ï¼Œå¯¹å‰ç«¯çš„è·¯ç”±è¯·æ±‚è¿›è¡Œè¿‡æ»¤å¤„ç†ã€‚expressæœ¬æ¥å°±æ˜¯æœåŠ¡åŠ ä¸­é—´ä»¶çš„é›†åˆï¼Œä¸åŒçš„ä¸­é—´ä»¶æž„æˆäº†å®Œæ•´çš„apié€»è¾‘å¤„ç†ã€‚åº”ç”¨çº§ä¸­é—´ä»¶ç»‘å®šåœ¨APPå†…ï¼Œè·¯ç”±ä¸­é—´ä»¶ç»‘å®šåœ¨è·¯ç”±ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰å†…ç½®ä¸­é—´ä»¶ï¼Œé”™è¯¯å¤„ç†ä¸­é—´ä»¶ç­‰ã€‚ä¸å¸¦æœ‰è·¯ç”±é™åˆ¶çš„ä¸­é—´ä»¶æ˜¯ä¼šè¢«æ‰€æœ‰è·¯ç”±æ‰§è¡Œçš„ã€‚ 12app.use(middareFun) //æ‰€æœ‰è¯·æ±‚éƒ½ä¼šè§¦å‘app.use('/user/:id', middareFun) ///userè·¯å¾„è¯·æ±‚è§¦å‘ è¿™é‡Œæˆ‘ä»¬ä¼˜åŒ–äº†ä¸Šé¢çš„ token éªŒè¯ä¸­é—´ä»¶ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354/*** path: @/utils/middares/paramsVerify.js*/var verToken = require('./jwt.js')//è¯·æ±‚æ—¶é—´const requestTime = function(req, res, next) &#123; req.requestTime = Date.now() next()&#125;//è§£æžtokenconst tokenVerify = function(req, res, next) &#123; var token = req.headers['authorization']; if(!token)&#123; return next(); &#125; else &#123; verToken.verToken(token).then((data)=&gt; &#123; req.data = data; return next(); &#125;).catch((error)=&gt;&#123; return next(); &#125;) &#125;&#125;;//è¿™é‡Œå¯ä»¥ä¸€ä¸ªä¸€ä¸ªå¯¼å‡ºï¼Œä¹Ÿå¯ä»¥ç›´æŽ¥å†™åœ¨æ•°ç»„å†…ï¼Œå¯¼å‡ºæ•°ç»„å³å¯ï¼ˆäºŒé€‰ä¸€ï¼‰ã€‚const middArr = [ requestTime = function() &#123;&#125;, tokenVerify = function() &#123;&#125;,]module.exports = &#123; requestTime, tokenVerify, middArr,&#125;/*** path: @/app.js* ä¸¤ç§æ³¨å†Œæ–¹å¼äºŒé€‰ä¸€å³å¯*/let paramsVerify = require('./utils/middwares/paramsVerify.js')//1.æ³¨å†ŒparamsVerifyæ–‡ä»¶ä¸­æ‰€æœ‰çš„ä¸­é—´ä»¶ï¼ˆå•ä¸ªå¯¼å‡ºå¼ï¼‰let middwareArr = []for(let i=0; i&lt;Object.keys(paramsVerify).length; i++) &#123; let item = paramsVerify[Object.keys(paramsVerify)[i]] middwareArr.push(item) //å¹²å˜›ä¸ç›´æŽ¥å¯¼å‡ºæ•°ç»„äº†ï¼Ÿï¼en //app.use(item) &#125;app.use(middwareArr)//2.å¯¼å‡ºæ•°ç»„å¼app.use(paramsVerify.middArr) //å®Œäº‹ï¼Œ è‡³æ­¤ï¼Œä¸­é—´çš„å‰¥ç¦»ä¼˜åŒ–å®Œæ•´ã€‚ å°è£…logåœ¨è°ƒè¯•ä¸­ï¼Œå¯ä»¥å°è£…ä¸€ä¸ªlogç”¨æ¥æ›¿ä»£ console.log 123456789101112131415161718192021222324252627282930/*** path: @/utils/log.js**/Date.prototype.Format = function (fmt) &#123;var o = &#123; "M+": this.getMonth() + 1, "d+": this.getDate(), "h+": this.getHours(), "m+": this.getMinutes(), "s+": this.getSeconds(), "q+": Math.floor((this.getMonth() + 3) / 3), "S": this.getMilliseconds()&#125;;if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));for (var k in o) if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length === 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));return fmt;&#125;function log() &#123; const show = true //ä¹Ÿå¯ä»¥å’Œå¼€å‘çŽ¯å¢ƒæŒ‚é’©æŽ§åˆ¶æ—¥å¿—è¾“å‡º if (show) &#123; console.log(`[$&#123;new Date().Format("yyyy-MM-dd hh:mm:ss")&#125;] `, ...arguments) &#125;&#125;module.exports = log è·¨åŸŸåœ¨æ­å»ºå®ŒåŽç«¯apiåŽï¼Œéœ€è¦åœ¨å‰ç«¯è°ƒè¯•ã€‚æ— è®ºæ˜¯å°ç¨‹åºè¿˜æ˜¯vueçš„webapp,è®¿é—®æœ¬åœ°è¿žæŽ¥ä¼šå‡ºçŽ°è·¨åŸŸé—®é¢˜ï¼ˆå°ç¨‹åºå¾—åœ¨å¼€å‘å·¥å…·ä¸Šå…³é—­åŸŸåæ£€æµ‹ï¼Œå°ç¨‹åºé»˜è®¤httpsï¼‰ï¼Œå¦‚å›¾ï¼šæ­¤æ—¶éœ€è¦åœ¨app.jså†…åŠ å…¥å…è®¸è·¨åŸŸè®¿é—® 123456789101112131415161718192021222324252627282930313233/** desc: ä»¥ä¸‹è·¨åŸŸä»£ç æœªå¤„ç† OPTION å½¢å¼ï¼Œåœ¨requestä¸æºå¸¦è‡ªå®šä¹‰å‚æ•°å¦‚ token ç­‰headerså†…çš„é…ç½®æ—¶ï¼Œæ˜¯å¯ä»¥è·‘èµ·æ¥çš„ï¼Œä¸€æ—¦åœ¨requestå†…è®¾ç½®headerså†…å®¹ï¼Œè¯·æ±‚ä¼šè¢« OPTION æŒ‚èµ·ï¼Œè·¨åŸŸå¤±è´¥ï¼*///è®¾ç½®å…è®¸è·¨åŸŸè®¿é—®è¯¥æœåŠ¡.ï¼ˆæ­¤ä»£ç ä¸ºå‘ï¼‰app.all('*', function (req, res, next) &#123; res.header('Access-Control-Allow-Origin', '*'); //Access-Control-Allow-Headers ,å¯æ ¹æ®æµè§ˆå™¨çš„F12æŸ¥çœ‹,æŠŠå¯¹åº”çš„ç²˜è´´åœ¨è¿™é‡Œå°±è¡Œ res.header('Access-Control-Allow-Headers', 'Content-Type'); res.header('Access-Control-Allow-Methods', '*'); res.header('Content-Type', 'application/json;charset=utf-8'); next();&#125;)/** desc: è·¨åŸŸ* desc: å¤§èƒ†copy* path: @/app.js*/app.use((req, res, next) =&gt; &#123; // è®¾ç½®æ˜¯å¦è¿è¡Œå®¢æˆ·ç«¯è®¾ç½® withCredentials // å³åœ¨ä¸åŒåŸŸåä¸‹å‘å‡ºçš„è¯·æ±‚ä¹Ÿå¯ä»¥æºå¸¦ cookie res.header("Access-Control-Allow-Credentials",true) // ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºå…è®¸è·¨åŸŸçš„åŸŸåï¼Œ* ä»£è¡¨æ‰€æœ‰åŸŸå res.header('Access-Control-Allow-Origin', '*') res.header('Access-Control-Allow-Methods', 'GET, PUT, POST, OPTIONS') // å…è®¸çš„ http è¯·æ±‚çš„æ–¹æ³• // å…è®¸å‰å°èŽ·å¾—çš„é™¤ Cache-Controlã€Content-Languageã€Content-Typeã€Expiresã€Last-Modifiedã€Pragma è¿™å‡ å¼ åŸºæœ¬å“åº”å¤´ä¹‹å¤–çš„å“åº”å¤´ res.header('Access-Control-Allow-Headers', 'Content-Type, Authorization, Content-Length, X-Requested-With') if (req.method == 'OPTIONS') &#123; res.sendStatus(200) &#125; else &#123; next() &#125;&#125;) æ­¤æ—¶ï¼Œæˆ‘ä»¬çš„vueå‰ç«¯ä½¿ç”¨axiosæºå¸¦tokenå°±å¯ä»¥è¯·æ±‚åˆ°æœåŠ¡ç«¯æŽ¥å£äº† morganæ—¥å¿—æ—¥å¿—ï¼Œè®°å½•æœåŠ¡å™¨çš„æ“ä½œè¡Œä¸ºï¼Œè¿™é‡Œä½¿ç”¨ morgan æŠŠæ—¥å¿—è®°å½•åœ¨æœ¬åœ°æ–‡ä»¶ä¿å­˜ã€‚ /** * path: @/utils/morgan.js * desc: å°è£…ä¸€ä¸ªmorgan */ var path = require('path'); var fs = require('fs') var morgan = require('morgan'); var FileStreamRotator = require('file-stream-rotator') var logDirectory = path.join(__dirname, 'log') fs.existsSync(logDirectory) || fs.mkdirSync(logDirectory) morgan.token('timeStamp', function(req, res){ let date = new Date() let logHour = date.getHours() &lt; 10 ? `0${date.getHours()}` : date.getHours() let logMinute = date.getMinutes() &lt; 10 ? `0${date.getMinutes()}` : date.getMinutes() let logSecond = date.getSeconds() &lt; 10 ? `0${date.getSeconds()}` : date.getSeconds() let logDate = `${logHour}:${logMinute}:${logSecond}` return logDate }); // è‡ªå®šä¹‰formatï¼Œå…¶ä¸­åŒ…å«è‡ªå®šä¹‰çš„token morgan.format('joke', '[joke :timeStamp] :remote-addr :remote-user :method :url HTTP/:http-version :status :res[content-length] - :response-time ms'); // create a rotating write stream var accessLogStream = FileStreamRotator.getStream({ date_format: 'YYYYMMDD', filename: path.join(logDirectory, 'access-%DATE%.log'), frequency: 'daily', verbose: false }) module.exports = {morgan, accessLogStream} /* * path: @/app * å¼•ç”¨è¿™ä¸ªæ—¥å¿—ç³»ç»Ÿ */ app.use(morgan('joke')); //æœåŠ¡å™¨è¾“å…¥å®žæ—¶æ—¥å¿— app.use(morgan('short', {stream: accessLogStream})); //è®°å½•æ—¥å¿—åœ¨æ–‡ä»¶ä¸­ è‡³æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ /utils è·¯å¾„ä¸‹çœ‹åˆ°åˆ›å»ºçš„ log æ–‡ä»¶å¤¹ï¼Œæ—¥å¿—å·²ç»æ ¹æ® file-stream-rotator æ’ä»¶åšäº†åˆ†å‰²ï¼Œæ¯ä¸€å¤©çš„æ—¥å¿—é›†çº¦åœ¨ä¸€ä¸ªæ–‡ä»¶ã€‚ä»¥é˜²æ—¥å¿—è¿‡å¤šå¯¼è‡´æ··ä¹±ã€‚ æœ¬é¡¹ç›®gitåœ°å€åœ¨è¿™é‡Œ, æ¬¢è¿Žstar æœ¬é¡¹ç›®éƒ¨ç½²æœåŠ¡å™¨æ–‡æ¡£åœ¨è¿™é‡Œ]]></content>
      <categories>
        <category>node</category>
      </categories>
      <tags>
        <tag>Programming</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[vue-wx-h5]]></title>
    <url>%2F2019%2F12%2F30%2Fvue-wx-h5%2F</url>
    <content type="text"><![CDATA[å¾®ä¿¡å…¬ä¼—å·æ€»ç»“ç”±äºŽå¾®ä¿¡çš„çº¦å®šï¼Œåœ¨iosç«¯æ— æ³•è´­ä¹°è™šæ‹Ÿäº§å“ï¼Œå®‰å“åˆ™æ²¡æœ‰é™åˆ¶ã€‚ä¸ºäº†è§£å†³iosç”¨æˆ·ä¹Ÿå¯ä»¥äº«å—è´­ä¹°è™šæ‹ŸæœåŠ¡çš„é—®é¢˜ï¼Œå¯é€‚ç”¨å…¬ä¼—å·H5æ”¯ä»˜æ¥è§£å†³iosç«¯æ”¯ä»˜é—®é¢˜ å‡†å¤‡ç”±äºŽä»…ä»…æ˜¯ä¸ºiosç”¨æˆ·è§£å†³æ”¯ä»˜é—®é¢˜ï¼Œæ•…æ­¤H5é¡µé¢å†…å®¹å¾ˆç®€å•ï¼Œç™»å½•ã€æ‹‰å–æ”¯ä»˜åˆ—è¡¨ã€æ”¯ä»˜å³å¯ã€‚H5é‡‡ç”¨vue+jqå®žçŽ°ï¼Œæœªé€‚ç”¨vue-cliã€‚ï¼ˆå°±ä¿©é¡µé¢ï¼Œæ²¡å¿…è¦ï¼‰ã€‚é¡µé¢ç»“æž„å¦‚ä¸‹ï¼š é‰´æƒéœ€æ±‚é‰´æƒï¼Œæ˜¯å¾®ä¿¡æä¾›çš„H5æŽˆæƒæ–¹å¼ï¼Œä¸€èˆ¬é‡‡ç”¨ç¬¬ä¸‰æ–¹æŽˆæƒï¼ŒæŽˆæƒæˆåŠŸèŽ·å–codeï¼Œç”¨codeèŽ·å–acces_tokenã€unionIDç­‰ï¼Œç”±äºŽH5æ˜¯å°ç¨‹åºiosæ”¯ä»˜çš„å»¶ä¼¸ï¼Œæ•…æ­¤éœ€è¦unionIDæ¥åˆ¤æ–­ç”¨æˆ·å”¯ä¸€æ€§ï¼é‰´æƒå¿…ä¸å¯å°‘ã€‚index.htmlæ–‡ä»¶ä¸­é¦–å…ˆå¯¼å…¥jsapi é‰´æƒç½‘é¡µæŽˆæƒä¸Žå°ç¨‹åºä¸åŒï¼Œç½‘é¡µæ˜¯ç¬¬ä¸‰æ–¹ç½‘é¡µæŽˆæƒï¼Œç„¶åŽæŽˆæƒä¿¡æ¯åœ¨é‡å®šå‘é“¾æŽ¥ä¸­ï¼ˆredirect_uriï¼‰è¿”å›žï¼Œé‡å®šå‘é“¾æŽ¥æˆ‘è®¾ç½®ä¸ºindex.htmlé¡µé¢ã€‚åœ¨ createdï¼ˆï¼‰ é’©å­ä¸­ï¼ŒåŽ»é‰´æƒèŽ·å–code 123456789101112131415161718192021222324252627282930313233created: function() &#123; const token = window.sessionStorage.getItem('token') //è§£å†³åˆ·æ–°é—®é¢˜ if(token) &#123; this.getCircleList() return &#125; let c = this.getQueryCode('code') this.code = c if(this.code) &#123; this.postData(c) &#125; else &#123; this.getUserCode() &#125; &#125;,//é‰´æƒgetUserCode() &#123; let redirect_uri = 'http://test.********.cn/projectName/' redirect_uri = encodeURI(redirect_uri) let url = `https://open.weixin.qq.com/connect/oauth2/authorize?appid=$&#123;this.appId&#125;&amp;redirect_uri=$&#123;redirect_uri&#125;&amp;response_type=code&amp;scope=snsapi_userinfo&amp;state=STATE#wechat_redirec` window.location.href = url&#125;,//èŽ·å–é‰´æƒæˆåŠŸåŽcodegetQueryCode(variable) &#123; let query = window.location.search.substring(1) let v = query.split("&amp;") for(let i = 0; i &lt; v.length; i++) &#123; let pair = v[i].split('=') if(pair[0] == variable) &#123; return pair[1] &#125; &#125; return null&#125;, é‡ç‚¹åœ¨äºŽ getUserCode é‰´æƒå‡½æ•°,æœ‰äººä¼šåœ¨é‰´æƒé“¾æŽ¥åŽé¢å†åŠ ä¸€ä¸ªå‚æ•°ï¼š&amp;connect_redirect=1 æˆ‘ç¬¬ä¸€æ¬¡ä½¿ç”¨çš„é“¾æŽ¥å°±æ˜¯åŠ äº†è¯¥å‚æ•°çš„ï¼Œæˆ‘åªæ›¿æ¢äº†APPIDå’Œé‡å®šå‘åœ°å€ï¼Œç»“æžœä¸€ç›´æŠ¥é”™ï¼Œå‘è´§ã€‚ç¬¬äºŒï¼Œé‡å®šå‘é“¾æŽ¥ä¸èƒ½æ˜¯æœ¬åœ°è¿žæŽ¥ï¼Œå¾—æ˜¯å¤–ç½‘å¯ä»¥è®¿é—®çš„é“¾æŽ¥ã€‚ æ”¯ä»˜é¡µé¢ä¸­ç‚¹å‡»å•ä¸ªå•†å“ï¼Œè¿›è¡Œæ”¯ä»˜è´­ä¹°ã€‚å…·ä½“çš„æ”¯ä»˜è¿‡ç¨‹å’Œå°ç¨‹åºæ”¯ä»˜ä¸€æ ·ï¼Œåªä¸è¿‡è¿™é‡Œå¤šäº†wx.config çš„åº”ç”¨ã€‚ 1234567891011121314151617181920212223242526272829303132333435wx.config(&#123; debug: false, appId: that.appId, timestamp: timeStamp1, nonceStr, signature, jsApiList: ['chooseWXPay'] &#125;)wx.ready(function() &#123; wx.chooseWXPay(&#123; timestamp: timeStamp1, nonceStr, package: package1, signType, paySign, success: function (res) &#123; that.showSuccTip = true that.clickStatus = true that.getCircleList() setTimeout(() =&gt; &#123; that.showSuccTip = false &#125;, 1000*3) &#125;, cancel() &#123; that.clickStatus = true &#125;, fail(res) &#123; alert('æ”¯ä»˜å¤±è´¥,ç¨å€™å†è¯•') that.clickStatus = true &#125;, &#125;); &#125;)wx.error(function(res) &#123; console.log('config error : ', res)&#125;) é¡µé¢é€šä¿¡ - ajaxæ²¡æœ‰ä½¿ç”¨axios,ä½¿ç”¨ajaxé€šä¿¡ï¼Œå°è£…ajaxé€šä¿¡ 123456789101112131415161718192021222324httpAjax (obj) &#123; $.ajax(&#123; url: obj.url, data: obj.data &amp;&amp; obj.type === "POST" ? JSON.stringify(obj.data) : obj.data, type: obj.type ? obj.type : 'GET', contentType: 'application/json', beforeSend: function(xhr) &#123; if (obj.token) &#123; xhr.setRequestHeader('Authorization', '******** ' + obj.token); &#125; &#125;, dataType: 'json', success: function (res) &#123; if (typeof obj.success === 'function') &#123; obj.success(res) &#125; &#125;, error: function (res) &#123; if (typeof obj.error === 'function') &#123; obj.error(res) &#125; &#125; &#125;)&#125;, é¡µé¢æ•ˆæžœè¿™ä¸ªæ•ˆæžœï¼Œæƒ³åˆ°äº†ä½¿ç”¨jqè§£å†³ï¼Œvueå¯èƒ½æœ‰æ›´ç®€å•çš„æ–¹æ³•ï¼Œä½†æ²¡è¯•è¿‡ï¼ 123456789101112131415161718data: &#123; clickId: 0, &#125;//åˆ—è¡¨æŒ‰é’®æºå¸¦è‡ªèº«idshowDetail(id) &#123; if(id == this.clickId) return $('#'+this.clickId).addClass('contentBox') $('#'+id).removeClass('contentBox') $('#'+id).find("[name='bigCircle']").removeClass('greyLine') $('#'+this.clickId).find("[name='bigCircle']").addClass('greyLine') $('#'+id).find("[name='smallCircle']").addClass('hited') $('#'+this.clickId).find("[name='smallCircle']").removeClass('hited') this.clickId = id&#125;, é‡‡å‘æ‚è°ˆå‘çœŸçš„æœ‰ç‚¹å¤šï¼Œå°¤å…¶æ˜¯ç¬¬ä¸€æ¬¡æžå¾—è¯ã€‚å„ç§é…ç½®æ–‡ä»¶ã€å¾®ä¿¡å…¬ä¼—å¹³å°é‡Œé¢çš„ç™½åå•ï¼Œå®‰å…¨åŸŸåé…ç½®ç­‰ç­‰ï¼Œtokençš„ä¼ é€’å‘äº†å¥½ä¹…ï¼Œè·¨åŸŸï¼Œæ²¡ç”¨vue-cli ï¼Œæ‰“å¼€é¡µé¢ä¸èƒ½å³å‡»æ‰“å¼€æµè§ˆå™¨é¢„è§ˆï¼Œä½¿ç”¨ anywhere æ’ä»¶æ¥æŠŠè·¯å¾„è½¬åŒ–ä¸º http/HTTPSé“¾æŽ¥ï¼ŒåŽæœŸæµ‹è¯•ç›´æŽ¥æŠŠæ–‡ä»¶æ‹‰å€’xshellæœåŠ¡å™¨é‡Œé¢åŽ»æµ‹ï¼Œè¦ä¸Gitåˆ†æ”¯è¢«æ±¡æŸ“çš„ä¸å¿ç›´è§†ã€‚ ioså…¼å®¹iosç«¯ç”¨æˆ·æ”¯ä»˜æˆåŠŸå›žè°ƒå‡½æ•°é‡Œé¢ alert å¹¶ä¸ä¼šè¢«æ‰§è¡Œï¼ŒAndroidåˆ™æ— å½±å“ã€‚æ‰€ä»¥æ”¯ä»˜æˆåŠŸçš„æç¤ºè‡ªå·±å†™ä¸€ä¸ª alert å°±å¯ä»¥ã€‚ åˆ·æ–°éƒ½å¿«ä¸Šçº¿äº†ï¼Œäº§å“è¿›å…¥ç‚¹äº†ä¸€ä¸ªåˆ·æ–°ï¼Œé¡µé¢å¡æ­»æŠ¥é”™ï¼åŽŸå› æ˜¯é‰´æƒè¿”å›žçš„ code ä¸€æ¬¡æ€§æœ‰æ•ˆï¼ï¼Œåˆ·æ–°æ—¶ï¼Œé“¾æŽ¥å…¶å®žæ²¡å˜ï¼Œä½†æ˜¯codeå·²ç»è¿‡æœŸäº†ã€‚è§£å†³ï¼š é¡µé¢åˆ·æ–°ä¸å½±å“é€»è¾‘ï¼Œæ­¤æ—¶æˆ‘ä»¬åªéœ€è¦tokenå³å¯ï¼Œæ•…æ­¤æŠŠtokenå­˜å‚¨åœ¨sessionStorage é‡Œé¢å³å¯é¿å…é¡µé¢åˆ·æ–°é—®é¢˜ã€‚]]></content>
      <categories>
        <category>Vue</category>
      </categories>
      <tags>
        <tag>Programming</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[wepy-å°è£…]]></title>
    <url>%2F2019%2F12%2F16%2Fwepy-wxminiPro%2F</url>
    <content type="text"><![CDATA[requestå°è£…ç›®å½•ç»“æž„ï¼š ç›®å½•ï¼š /utils/base.js 123456789101112131415161718192021222324252627282930313233343536373839404142import wepy from 'wepy'import qiniuyun = from '@/utils/qiniuUploader'const dev = falseconst baseUrl = dev ? 'https://xxxx' : 'https://test/xxx'//ä¸Šä¼ å›¾ç‰‡ï¼š const uploadImg = (imageURL, uptokenURL) &#123; return new Promise((resolve, reject) =&gt; &#123; qiniuyun.upload(imageURL, res =&gt; &#123; resolve(res) &#125;, error =&gt; &#123; reject(error) &#125;, &#123; region: 'ECN', domain: 'https://xxxx', uptoken: uptokenURL &#125;) &#125;) &#125;//è¯·æ±‚å°è£…const wxRequest = async (params = &#123;&#125;, url, method,) =&gt; &#123; let token = params.token || '' if(params.getToken) &#123; token = wepy,getStorageSync('token') &#125; let res = await wepy.request(&#123; url, method: methos || 'GET', data: params.data || &#123;&#125;, header: Object.assign(&#123; 'Content-Type': 'application/json', 'Accept': 'application/json', 'Authorization': `str**Token $&#123;token&#125;` &#125;, params.header || &#123;&#125;) &#125;) return res&#125;module.exports = &#123; wxRequest, baseUrl, uploadImg,&#125;; åœ¨ base.js ä¸­å°è£…è¯·æ±‚ï¼Œåœ¨apiæ–‡ä»¶ä¸­åˆ™å¯ä»¥ç›´æŽ¥æ‹¿æ¥ä½¿ç”¨ç›®å½•ï¼š utils/api.js 12345678910import base from '@/utils/base'//ç™»å½•ã€èŽ·å–åŸºæœ¬ä¿¡æ¯const login = (params) =&gt; base.wxRequest(params, `$&#123;base.baseUrl&#125;/login/`, 'POST')const getUserInfo = (params) =&gt; base.wxRequest(params, `$&#123;base.baseUrl&#125;/user/`,)module.exports = &#123; login, getBaseInfo,&#125; ç»Ÿä¸€ç®¡ç†ç»´æŠ¤æ‰€æœ‰çš„æŽ¥å£apiï¼Œ åœ¨é¡µé¢ä¸­ï¼Œç›´æŽ¥ä½¿ç”¨å…·ä½“çš„api 1234567891011121314151617181920212223242526272829/** src/pages/index.wpy*/import api from '@/utils/api'//èŽ·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯onShow() &#123; this.getUserInfo(params)&#125;//å¸¦å‚æ•°ï¼ŒåŒæ­¥å†™æ³•getUserInfo(params) &#123; api.getUserInfo(&#123; data: &#123; data: data1 &#125;, getToken: true &#125;).then(res =&gt; &#123; const data = res.data ... this.$apply() &#125;)&#125;//ä¸å¸¦å‚æ•°ï¼Œå¼‚æ­¥å†™æ³•async getUserInfo() &#123; let res = await api.getUserInfo(&#123;getToken: true&#125;) if(res.statusCode === 200) &#123; //doSth &#125;&#125; Mixinsæå‡ºå…¬å…±æ–¹æ³•ï¼Œæ–¹ä¾¿å…¨å±€è°ƒç”¨ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121/**path: scr/mixins/common*name: common*/import wepy from 'wepy'export default class commonMixins extends wepy.mixins &#123; //æœ¬åœ°å­˜å‚¨ saveData (k, v) &#123; wepy.setStorage(&#123; key: k, value: v &#125;) &#125; saveDataS(k, v)&#123; wepy.setStorageSync(k, v || '') &#125; getDataS(k)&#123; let res = wepy.getStorageSync(k); return res &#125; // å›¾ç‰‡é¢„è§ˆ preImg(c, u)&#123; wepy.previewImage(&#123; current: c, urls: u &#125;) &#125; // æç¤ºæ¡† toast(title,icon,dura)&#123; wepy.showToast(&#123; title: title, icon: icon, duration: dura || 1500 &#125;) &#125; //é¡µé¢æ»šåŠ¨ pageScro(num)&#123; wepy.pageScrollTo(&#123; scrollTop: num, duration: 0 &#125;); &#125; // é¡µé¢è·³è½¬ nav(url)&#123; this.$navigate(&#123; url: url &#125;) &#125; swi(url)&#123; wepy.switchTab(&#123; url: url &#125;) &#125; log() &#123; const show = true if (show) &#123; console.log(`[$&#123;new Date().Format("yyyy-MM-dd hh:mm:ss")&#125;] `, ...arguments) &#125; &#125; // å‘é€formid(å·²åºŸå¼ƒ) postFormId(id)&#123; let arr = wepy.getStorageSync('form_ids') || []; arr.push(id); wepy.setStorageSync('form_ids', arr) &#125; // showModal modal(data) &#123; wx.showModal(&#123; content: data.content, showCancel: data.cancel || false, confirmText: data.confirm || 'çŸ¥é“äº†', &#125;) &#125; //ç²˜è´´æ¿ setClipboardData(data, succFun) &#123; wx.setClipboardData(&#123; data: 'data', success(res) &#123; wx.getClipboardData(&#123; success (res) &#123; succFun &#125; &#125;) &#125; &#125;) &#125; // é¡µé¢é¡¶éƒ¨title setNavTitle(title) &#123; wx.setNavigationBarTitle(&#123; title: title &#125;) &#125; //è·³è½¬å°ç¨‹åº navToMini(appId) &#123; wx.navigateToMiniProgram(&#123; appId, &#125;) &#125; //åŠ è½½æ¡† loading(title) &#123; wx.showLoading(&#123; title: title || "åŠ è½½ä¸­..." &#125;) &#125; //éšè—åŠ è½½æ¡† hideLoading() &#123; wx.hideLoading(&#123;&#125;) &#125; //bannerè·³è½¬ bannerJump(url) &#123; if(url.slogan == 1) &#123; this.swi(url.autoResponse1) return &#125; this.nav(url.autoResponse1) &#125; //è¿”å›žä¸Šä¸€ä¸ªé¡µé¢ navBack() &#123; wx.navigateBack(&#123;&#125;) &#125;&#125; ä½¿ç”¨mixins ï¼Œåœ¨é¡µé¢ä¸­å¼•å…¥ï¼Œconfigä¸­å£°æ˜Žï¼Œå³å¯åœ¨é¡µé¢ä½¿ç”¨ this è°ƒç”¨ 12345import commonMixin from '@/mixins/common'import req from '@/mixins/req' //é¡µé¢é…ç½®ä¸­ï¼š mixins = [commonMixin, req] å¸¸é‡é…ç½®æ•°æ®å‰ç«¯é…ç½®æ•°æ®æŠ½ç¦»å‡ºæ¥å•ç‹¬æ”¾ï¼Œä¾¿äºŽç»´æŠ¤ã€‚ 12345678910111213141516171819202122232425262728/***path: src/utils/configData.js*/const education = [ 'é«˜ä¸­åŠä»¥ä¸‹', 'ä¸“ç§‘', 'æœ¬ç§‘', 'ç¡•å£«', 'åšå£«',]//å¾®ä¿¡å·ç æ­£åˆ™const wxreg=/^[a-zA-Z]&#123;1&#125;[-_a-zA-Z0-9]&#123;5,19&#125;$/;// bannerè½®æ’­é…ç½®const swiperConfig = &#123; autoplay: true, interval: 3500, duration: 500, circular: true, indicatorDdots: true, indicatorColor: 'rgba(255,255,255,1)', indicatorActiveColor: '#FF8356',&#125;module.export = &#123; education, wxreg, swiperConfig,&#125; åˆ†åŒ…å°ç¨‹åºæœªè¶…è¿‡2Må¤§å°ï¼Œæ— éœ€åˆ†åŒ…ã€‚è¶…è¿‡2Mï¼Œåˆ™é‡‡ç”¨åˆ†åŒ…ï¼Œå•åŒ…ä¸è¶…è¿‡2Mï¼Œæ€»è®¡ä¸è¶…è¿‡16Mã€‚ åˆ†äº«æ™®é€šåˆ†äº«ç•¥è¿‡ã€‚å¸¦shareTicketçš„åˆ†äº«ï¼Œä¸”éœ€è¦è®°å½•åˆ†äº«ç¾¤çš„ä¿¡æ¯æ—¶ï¼š 12345678910111213141516171819/**path: src/app.wpy**/async onShow(ops) &#123; const that = this; // åˆ¤æ–­æ˜¯å¦æ˜¯ç¾¤ç‚¹å‡»è¿›å…¥ console.log('APP show : ', ops) that.scene = ops.scene; if (ops.scene === 1044 &amp;&amp; ops.shareTicket !== undefined)&#123; that.shareTicket = ops.shareTicket; &#125;&#125;//é¡µé¢async onShow() &#123; if(that.$parent.scene === 1044)&#123; await that.touchGroup(); &#125;&#125; ç”±åˆ†äº«è¿›å…¥å°ç¨‹åºæŸä¸ªé¡µé¢ï¼Œéœ€å…ˆåˆ¤æ–­ç¼“å­˜ä¸­æ˜¯å¦å­˜åœ¨ token ï¼Œ è‹¥ä¸å­˜åœ¨ token ï¼Œ åˆ™å…ˆè¯·æ±‚ç™»å½•æŽ¥å£ï¼Œåˆ°åŽç«¯æ¢å– token ï¼Œ å†è¯·æ±‚å…¶ä»–api ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455//æŸåˆ†äº«é“¾æŽ¥è¿›å…¥çš„é¡µé¢async onShow() &#123; const that = this if( !wepy.getStorageSync('token')) &#123; await that.getLogin() &#125; that.getUserInfo()&#125;//mixins - reqasync getLogin()&#123; await wepy.login().then(async (res) =&gt; &#123; let result = await this.timeOut(circleApi.login(&#123; data: &#123; app_id: this.$parent.globalData.appId, code: res.code &#125; &#125;)); if(res.statusCode === 200)&#123; wepy.setStorage(&#123; key: "token", data: res.data.token &#125;) wepy.setStorage(&#123; key: 'user_id', data: res.data.user_id &#125;) &#125; &#125;)&#125;//è¶…æ—¶å¤„ç†async timeOut(fn)&#123; let that = this; let res = await Promise.race([this.test(), fn]).then((data) =&gt; &#123; return data &#125;); if(res === 'timeOut')&#123; that.toast('è¯·æ£€æŸ¥ç½‘ç»œæˆ–è€…é‡æ–°è¯•ä¸€ä¸‹', 'none' ,1500); let status = &#123; statusCode: 300 &#125;; return status &#125;else &#123; return res &#125;&#125;// è¯·æ±‚è¶…æ—¶å¤„ç†test() &#123; let promise = new Promise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; resolve('timeOut') &#125;,20000) &#125;); return promise;&#125; formid (å·²åºŸå¼ƒ)å°ç¨‹åºç»™ç”¨æˆ·å‘é€æ¨¡æ¿æ¶ˆæ¯éœ€è¦æ¶ˆè€— fromIDï¼Œ æ–°ç‰ˆçš„åˆ™æ˜¯æŽˆæƒã€‚è¿™é‡Œè®°å½•ä¸€ä¸‹fromIDçš„å¤„ç†ã€‚å‘é€ä¸€æ¡æ¨¡æ¿æ¶ˆæ¯éœ€è€—è´¹ä¸€ä¸ª fromIDfromIDçš„å­˜å‚¨åº”è¯¥æ˜¯ç”¨æˆ·æœ¬æ¬¡ä½¿ç”¨å®Œå°ç¨‹åºï¼Œç„¶åŽæŠŠæ”¶é›†åˆ°çš„fromIDä¸€æ¬¡æ€§å‘é€åˆ°åŽç«¯ 123456789101112131415161718192021222324252627282930313233/**path: src/app.wpy**/onHide()&#123; let form_ids = wepy.getStorageSync('form_ids'); configApi.postFormId(&#123; data: &#123; form_ids: form_ids &#125;, getToken: true &#125;); wepy.setStorageSync('form_ids', [])&#125;// mixins - common// å­˜å‚¨formid postFormId(id)&#123; let arr = wepy.getStorageSync('form_ids') || []; arr.push(id); wepy.setStorageSync('form_ids', arr) &#125;// é¡µé¢è¡¨å•äº§ç”Ÿ fromID &lt;form @submit="submit" report-submit="true"&gt; &lt;button class="publicBox" hover-class="none" form-type="submit"&gt; &lt;image class="publicImg" src="../images/common/bigButton.png" &gt;&lt;/image&gt; &lt;view class="publicText"&gt;å‘å¸ƒ&lt;/view&gt; &lt;/button&gt;&lt;/form&gt;submit(e)&#123; this.postFormId( e.detail.formId )&#125;, å½“ç”¨æˆ·çš„è¡¨å•æäº¤è¡Œä¸ºäº§ç”Ÿäº† fromID æ—¶ï¼Œ ç»Ÿä¸€è¿›è¡Œæœ¬åœ°å­˜å‚¨ï¼Œåœ¨ç”¨æˆ·æ²™é›•è¯¥å°ç¨‹åºæ—¶å†ç»Ÿä¸€æäº¤å…¨éƒ¨fromid å°ç¨‹åºç™»å½•å¹¿æ’­ç™»å½•å¹¿æ’­å¯ä»¥è§£å†³å¾ˆå¤šåŒæ­¥é—®é¢˜ï¼Œåœ¨appå†…ï¼Œæ‰§è¡Œç™»å½•èŽ·å–tokenï¼Œåœ¨tokenè¿˜æœªæ‹¿åˆ°æ—¶ï¼Œé¦–é¡µçš„æŽ¥å£ä¸èƒ½åŽ»æ‰§è¡Œï¼Œéœ€è¦ç­‰å¾…åŽç«¯è¿”å›žtokenåŽæ‰å¯æ‰§è¡Œï¼Œè¿™é‡Œæœ‰ä¸¤ç§æ–¹å¼å®žçŽ°ï¼šmethod1ï¼š async/awaitappå†…ä¼šæ‰§è¡Œç™»å½•ï¼Œé¦–é¡µä¹Ÿonloadå†…åˆ¤æ–­tokenæ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨åˆ™é‡æ–°ç™»å½•ï¼ˆåŒæ­¥ï¼‰ï¼Œåœ¨ç™»å½•æˆåŠŸåŽåœ¨æ‰§è¡Œä¸šåŠ¡ã€‚ 123456789101112// APPonLaunch() &#123; this.getLogin() &#125;//index.wpyasync onLoad() &#123; if(!wepy.getStorageSync('token)) &#123; await this.getLogin() &#125; // æ‰§è¡Œä¸šåŠ¡&#125; ä»¥ä¸Šæ–¹æ³•åœ¨æœ‰å¤§é‡æ–°ç”¨æˆ·åˆ†äº«è¿›å…¥å°ç¨‹åºçš„åœºæ™¯ä¸‹å¾ˆå®žç”¨ï¼Œä½†æ˜¯ä¸å­˜åœ¨tokençš„ç”¨æˆ·ï¼ˆæ–°ç”¨æˆ·ï¼‰é€šå¸¸ä¼šè¯·æ±‚ä¸¤æ¬¡ç™»å½•ã€‚ä¼˜åŒ–å¦‚ä¸‹ï¼šåˆ©ç”¨å¹¿æ’­ï¼Œå¹¿æ’­é¡µé¢å‘ŠçŸ¥APPå†…ç™»å½•æ˜¯å¦æˆåŠŸï¼ŒæˆåŠŸåŽå„é¡µé¢å†åŽ»æ‰§è¡Œä¸šåŠ¡ã€‚code address: https://github.com/fanghongliang/Tools/blob/master/broadcast.js å°ç¨‹åºè·³è½¬è·¯å¾„æºå¸¦å¯¹è±¡å‚æ•°Objectå°ç¨‹åºåœ¨è·³è½¬é¡µé¢è·¯å¾„æ—¶ä¼šæŠŠqueryå‚æ•°StringåŒ–ï¼Œä¹Ÿä¸èƒ½æºå¸¦å¯¹è±¡å‚æ•°ï¼Œå½“ç„¶æˆ‘ä»¬å¯ä»¥é€šè¿‡localStorageã€globalDataæ¥è§£å†³å‚æ•°æºå¸¦é—®é¢˜ã€‚ä½†å½“ä¸ç¡®å®šçš„å¯¹è±¡å‚æ•°éœ€è¦ä¼ é€’åˆ°ä¸‹ä¸€ä¸ªé¡µé¢æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å¯¹è±¡å‚æ•°ä¼ é€’ï¼Œä½¿ç”¨encodeURIComponentå°è£…URLå³å¯è§£å†³code address: https://github.com/fanghongliang/Tools/blob/master/urlHelper.js å°ç¨‹åºä½¿ç”¨ç¬¬ä¸‰æ–¹UIåº“å½“éœ€è¦ä½¿ç”¨ç¬¬ä¸‰æ–¹UIåº“æ—¶ï¼Œä¼˜å…ˆè€ƒè™‘ç¬¬ä¸‰æ–¹åº“çš„é€‚é…æ€§ã€‚è¿™é‡Œwepy ç‰ˆæœ¬ä¸º 1.7.3 ï¼Œä½¿ç”¨kai-ui é‡‡å‘ç»åŽ†å¦‚ä¸‹ï¼škai-ui: https://www.npmjs.com/package/kai-ui/v/1.2.2npmå¼•å…¥ä¹‹åŽè¦ç¡®ä¿é¡¹ç›® /dist/npm ç›®å½•ä¸‹ï¼Œå­˜åœ¨ kai-ui æ–‡ä»¶å¤¹ï¼Œå¦‚æ²¡æœ‰ï¼Œåˆ é™¤distç›®å½•ï¼Œé‡æ–°ç¼–è¯‘ã€‚æ­¥éª¤ä¸€ï¼šåœ¨rootç›®å½•appæ–‡ä»¶å†…ï¼Œstyleä¸­å¼•å…¥ @import &#39;../node_modules/kai-ui/src/less/index&#39;;æ­¥éª¤äºŒï¼šåœ¨é¡µé¢ä¸­ç›´æŽ¥å¼•å…¥ä½ éœ€è¦çš„ç»„ä»¶, import loading from 'kai-ui/Loading' components = { loading, } ä¹‹åŽå°±å¯ä»¥ä½¿ç”¨ ç»„ä»¶äº†ï¼Œæ­¤æ—¶ï¼å¯èƒ½ä¼šå‡ºçŽ° [Error] TypeError: Cannot read property &#39;dir&#39; of null æŠ¥é”™ï¼ è§£å†³æ–¹æ³•ï¼š ç›´æŽ¥å¼•ç”¨ï¼Œä¸è¦åœ¨ components å†…æ³¨å†Œï¼Œäº²æµ‹æœ‰æ•ˆï¼ˆå‘ï¼‰]]></content>
      <categories>
        <category>wepyæ¡†æž¶å°è£…</category>
      </categories>
      <tags>
        <tag>Programming</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Emmet]]></title>
    <url>%2F2019%2F10%2F11%2FEmmet%2F</url>
    <content type="text"><![CDATA[EmmetåŠŸèƒ½å¿«é€Ÿç¼–è¾‘å‰ç«¯HTMLæ ‡ç­¾ï¼Œä»¥åŠç¼–è¾‘å™¨æ ‡ç­¾è‡ªåŠ¨é—­åˆåŠŸèƒ½ç¼–è¾‘å™¨å®‰è£…æ’ä»¶ï¼šAuto Close TagVscodeç¼–è¾‘å™¨ä¸­ï¼Œã€è®¾ç½®ã€‘ä¸­æ‰“å¼€ Emmetç›¸å…³é…ç½® Emmetåˆå§‹åŒ–12! =&gt; tabhtml:5 æ ‡ç­¾id/class/å±žæ€§12div.test#testidp.test-class&#123;è¿™é‡Œæ˜¯pæ–‡æœ¬&#125; åµŒå¥—&lt; : å­èŠ‚ç‚¹+ : å…„å¼ŸèŠ‚ç‚¹^ : çˆ¶èŠ‚ç‚¹ 1div.aim-class&gt;div.son-class^div.brother1-class+div.brother2-class åˆ†ç»„() : åˆ†ç»„åˆ†ç»„å†…çš„æ ‡ç­¾åœ¨å±‚çº§ä¸Šè§†ä¸ºæ•´ä½“ 1div&gt;(div&gt;div&gt;a)+div&gt;p&#123;test text&#125; éšå¼æ ‡ç­¾ç›´æŽ¥é€šè¿‡ ç±» æˆ– ID ç”Ÿæˆæ ‡ç­¾å¯ä»¥çœç•¥æŽ‰divï¼Œå³è¾“å…¥.itemå³å¯ç”Ÿæˆ&lt;div class=&quot;item&quot;&gt;&lt;/div&gt;éšå¼æ ‡ç­¾é›†åˆï¼š 1234liï¼šç”¨äºŽulå’Œolä¸­trï¼šç”¨äºŽtableã€tbodyã€theadå’Œtfootä¸­tdï¼šç”¨äºŽträ¸­optionï¼šç”¨äºŽselectå’Œoptgroupä¸­ ä¹˜æ³•* : é‡å¤æŒ‡ä»¤$ : è‡ªå¢žç¬¦å· 12div*5ul&gt;li$*3 CSSç¼©å†™12w100 =&gt; width: 100pxh10p =&gt; height: 10% å•ä½åˆ«ååˆ—è¡¨:p è¡¨ç¤º%e è¡¨ç¤º emx è¡¨ç¤º ex æ›´å¤šå‚è€ƒï¼š https://blog.csdn.net/comphoner/article/details/79670148]]></content>
      <categories>
        <category>html</category>
      </categories>
      <tags>
        <tag>Programming</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[designMode]]></title>
    <url>%2F2019%2F09%2F23%2FdesignMode%2F</url>
    <content type="text"><![CDATA[è®¾è®¡æ¨¡å¼äº”å¤§è®¾è®¡åŽŸåˆ™]]></content>
      <categories>
        <category>designMode</category>
      </categories>
      <tags>
        <tag>Programming</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hexoå»ºç«™]]></title>
    <url>%2F2019%2F09%2F19%2Fhexo%2F</url>
    <content type="text"><![CDATA[åºè¨€NEXTä¸»é¢˜ï¼š http://theme-next.iissnan.com/getting-started.htmlå‚è€ƒæ–‡ç« ï¼š https://blog.csdn.net/sinat_37781304/article/details/82729029nextå‚è€ƒ: https://www.jianshu.com/p/5e56839ef917æ­¥éª¤ï¼š 12345678å®‰è£…Gitå®‰è£…Node.jså®‰è£…HexoGitHubåˆ›å»ºä¸ªäººä»“åº“ç”ŸæˆSSHæ·»åŠ åˆ°GitHubå°†hexoéƒ¨ç½²åˆ°GitHubè®¾ç½®ä¸ªäººåŸŸåå‘å¸ƒæ–‡ç«  å®‰è£…$ npm install hexo-cli -gå®‰è£…åŽæ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸï¼š$ hexo -væˆåŠŸåŽè¿›è¡Œåˆå§‹åŒ–ï¼š$ hexo init myBlogå®‰è£…ç»„ä»¶: 1234$ cd myBlog$ npm install``` è‡³æ­¤ï¼Œæ–°å»ºå®Œæˆï¼ç›®å½•ä¼šå­˜åœ¨ä»¥ä¸‹ç»“æž„ï¼š node_modules: ä¾èµ–åŒ…publicï¼šå­˜æ”¾ç”Ÿæˆçš„é¡µé¢scaffoldsï¼šç”Ÿæˆæ–‡ç« çš„ä¸€äº›æ¨¡æ¿sourceï¼šç”¨æ¥å­˜æ”¾ä½ çš„æ–‡ç« themesï¼šä¸»é¢˜** _config.yml: åšå®¢çš„é…ç½®æ–‡ä»¶** 1æŸ¥çœ‹åˆšåˆšåˆ›å»ºçš„hexoåšå®¢ï¼š $ hexo g$ hexo s 123456789æ‰“å¼€localhost:4000å°±å¯ä»¥çœ‹åˆ°å•¦#### åˆ›å»ºGitHubä»“åº“åˆ›å»ºä¸€ä¸ªå’Œä½ ç”¨æˆ·åç›¸åŒçš„ä»“åº“ï¼ŒåŽé¢åŠ .github.ioï¼Œåªæœ‰è¿™æ ·ï¼Œå°†æ¥è¦éƒ¨ç½²åˆ°GitHub pageçš„æ—¶å€™ï¼Œæ‰ä¼šè¢«è¯†åˆ«ï¼Œä¹Ÿå°±æ˜¯xxxx.github.ioï¼Œå…¶ä¸­xxxå°±æ˜¯ä½ æ³¨å†ŒGitHubçš„ç”¨æˆ·å#### hexoéƒ¨ç½²åˆ°GitHubå°†hexoå’ŒGitHubå…³è”èµ·æ¥ï¼Œä¹Ÿå°±æ˜¯å°†hexoç”Ÿæˆçš„æ–‡ç« éƒ¨ç½²åˆ°GitHubä¸Šï¼Œæ‰“å¼€ç«™ç‚¹é…ç½®æ–‡ä»¶ _config.ymlï¼Œç¿»åˆ°æœ€åŽï¼Œä¿®æ”¹ä¸º deploy: type: git repo: https://github.com/YourgithubName/YourgithubName.github.io.git branch: master 1æ­¤æ—¶éœ€è¦å®‰è£…deploy-git ï¼Œä¹Ÿå°±æ˜¯éƒ¨ç½²çš„å‘½ä»¤,è¿™æ ·ä½ æ‰èƒ½ç”¨å‘½ä»¤éƒ¨ç½²åˆ°GitHub $ npm install hexo-deployer-git â€“save 1ç„¶åŽï¼š $ hexo clean$ hexo generate$ hexo deploy $ hexo clean$ hexo d -g 1234567891011121314151617181920212223242526272829303132333435å…¶ä¸­ deploy æ—¶ä¼šè¦æ±‚è¾“å…¥ username å’Œ password ï¼ˆgitè´¦æˆ·å¯†ç ï¼‰ ä¹‹åŽï¼Œæ‰“å¼€ http://yourname.github.io è¿™ä¸ªç½‘ç«™å°±å¯ä»¥çœ‹åˆ°ä½ çš„åšå®¢äº†ï¼ï¼#### å‘å¸ƒåšå®¢å’Œçº¿ä¸ŠGitHubå…³è”åŽï¼Œæ–°å¢žä¸€ç¯‡åšå®¢ï¼š `$ hexo new post &lt;your blogName&gt;` ç¼–è¾‘å¥½æ–‡ç« å‘å¸ƒéƒ¨ç½²ï¼š `$ hexo d -g `æ¸…é™¤ç¼“å­˜ï¼š `$ hexo clean`#### æœ¬åœ°å¯HexoåŠ¨æœåŠ¡`$ hexo s || hexo serve` é»˜è®¤ç«¯å£ï¼š4000ï¼Œä¿®æ”¹ç«¯å£å·ï¼š `$ hexo serve -p 5000`#### è‰ç¨¿#### é¡µé¢ä¸°å¯Œ##### å…¬ç›Š404ï¼š`$ hexo new page 404` è¿›å…¥åˆšæ‰ç”Ÿæˆçš„ \source\404\index.md æ·»åŠ ï¼š ```html&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;404&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;script type=&quot;text/javascript&quot; src=&quot;//qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt; &lt;/body&gt;&lt;/html&gt; tags/æ ‡ç­¾é¡µ$ hexo new page tagsé…ç½®tagsé¡µé¢ï¼Œè¿›å…¥åˆ°åˆšæ‰ç”Ÿæˆçš„ \source\tags\index.mdæ–‡ä»¶ï¼Œæ·»åŠ typeå­—æ®µï¼š 123title: æ ‡ç­¾date: 2019-09-19 19:49:32type: &quot;tags&quot; åœ¨æ–‡ç« ä¸­è®¾ç½®å¯¹åº”çš„æ ‡ç­¾å³å¯ï¼š 1tags: [xxx,xxx,xxx] åˆ†ç±»é¡µé¢/categories$ hexo new page categoriesé…ç½®categoriesé¡µé¢ï¼Œè¿›å…¥åˆ°åˆšæ‰ç”Ÿæˆçš„ \source\categories\index.mdæ–‡ä»¶ï¼Œæ·»åŠ typeå­—æ®µï¼š 1234title: åˆ†ç±»date: 2019-08-19 15:11:42type: &quot;categories&quot;comments: false è®¾ç½®æ¯ç¯‡åšå®¢çš„ categoriesï¼šcategories: xxx åŠŸèƒ½ç‚¹å­—æ•°ç»Ÿè®¡ã€æ—¶é•¿ä¸»é¢˜é…ç½®æ–‡ä»¶ _config.yml ä¸­æ‰“å¼€ wordcount ç»Ÿè®¡åŠŸèƒ½å³å¯ 123456post_wordcount: item_text: true wordcount: true #å­—æ•°ç»Ÿè®¡ min2read: true #é˜…è¯»æ—¶é•¿ totalcount: true separated_meta: true é…ç½®ä¹‹åŽè¿˜æ˜¯æ²¡å‡ºçŽ°å­—æ•°ç»Ÿè®¡å’Œé˜…è¯»æ—¶é•¿ï¼Œå¯èƒ½æ˜¯å› ä¸ºæœªå®‰è£… hexo-wordcount æ’ä»¶ï¼Œå®‰è£…å³å¯ï¼š$ npm insatll --save hexo-wordcounté‡å¯æœåŠ¡ï¼ŒOK ç«™å†…æœç´¢å®‰è½¬æ’ä»¶npm install hexo-generator-searchdb --savehexoç«™ç‚¹é…ç½®æ–‡ä»¶_config.yml,ä»»æ„ä½ç½®æ‰‹åŠ¨æ·»åŠ ï¼š 12345search: path: search.xml field: post format: html limit: 10000 ä¿®æ”¹ä¸»é¢˜(next)é…ç½®æ–‡ä»¶_config.yml,å¯ç”¨local_search 1234local_search: enable: true trigger: auto top_n_per_article: 1 ok GitHub page 404å·²ç»éƒ¨ç½²å¥½çš„hexo,åœ¨æˆ‘ä»¬ä¿®æ”¹äº†gitä»“åº“çš„å±žæ€§ä¹‹åŽï¼ˆæˆ‘æ˜¯åˆ‡æ¢äº†ä»“åº“çš„å…¬å¼€å’Œç§æœ‰å±žæ€§ï¼‰ï¼Œå†æ¬¡è®¿é—®åŸŸåå°±ä¼š page 404ï¼Œæ£€æŸ¥äº†ä»“åº“æ–‡ä»¶å’Œæœ¬åœ°hexoé…ç½®æ–‡ä»¶ï¼Œå‡æœªæ”¹åŠ¨ã€‚ è§£å†³ï¼š åœ¨çº¿ä¸Šgitä»“åº“çš„settingä¸­ï¼Œé€‰æ‹©theme-&gt; Custom domain,åœ¨è¿™é‡Œé‡æ–°è¾“å…¥ä½ çš„åŸŸåï¼Œä¿å­˜å³å¯ï¼Œé‡æ–°æ‰“å¼€åŸŸåï¼Œé¡µé¢å·²ç»å›žæ¥äº†ã€‚hexoçš„åŸŸåç»‘å®šæ˜¯åŒå‘çš„ï¼ hugoåšå®¢æ¡†æž¶ï¼š goè¯­è¨€ç¼–å†™ã€‚å¤šçº¿ç¨‹ç¼–è¯‘ã€‚é€Ÿåº¦å¿«]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Programming</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Charts]]></title>
    <url>%2F2019%2F09%2F17%2Fcharts%2F</url>
    <content type="text"><![CDATA[åºè¨€antvèš‚èšå®˜ç½‘ï¼š https://antv.alipay.com/zh-cn/index.html G2G2å¼•å…¥ CDNï¼š&lt;script src=&quot;https://gw.alipayobjects.com/os/lib/antv/g2/3.4.10/dist/g2.min.js&quot;&gt;&lt;/script&gt; NPM:$ npm install @antv/g2 --saveimport G2 from &#39;@antv/g2&#39; æœ¬åœ°è„šæœ¬ï¼š&lt;script src=&quot;./g2.js&quot;&gt;&lt;/script&gt; G2å°è£…å®žæˆ˜ä¸€ä¸ªG2å®žä¾‹åªèƒ½åˆ›å»ºä¸€ä¸ªå›¾è¡¨,è‹¥éœ€è¦å¤šä¸ªå›¾è¡¨ï¼Œå¯ä»¥å°è£…G2 å®žä¾‹: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687/** * G2 * charthså‡½æ•° * warn:æ•°æ®æ ¼å¼ç›¸åŒå¯å¤ç”¨ä¸€ä¸ªå‡½æ•°,å¦åˆ™è¯·é‡æ–°å¦åˆ›å›¾è¡¨å‡½æ•° */// utils/charts.jsexport function chartInstance( point, chartData, config=&#123;&#125; ) &#123; const [axisX, axisValue, axisY] = Object.keys(chartData[0]) const chart = new G2.Chart(&#123; container: point, //pointæŒ‚è½½ç‚¹ID forceFit: config.width ? false : true, //è¡¨å®½è‡ªé€‚åº”é…ç½® height: config.height || 600, width: config.width || null, //è‹¥é…ç½®forceFitï¼Œåˆ™widthä¸ç”Ÿæ•ˆ &#125;); chart.source(chartData, &#123; axisX: &#123; range: [0, 1], min: 0, max: 100 &#125; &#125;); chart.tooltip(&#123; crosshairs: &#123; type: 'line' &#125; &#125;); chart.axis(axisY, &#123; label: &#123; formatter: function formatter(val) &#123; return val + 'ï¿¥'; &#125; &#125;, title: &#123; textStyle: &#123; fontSize: 12, // æ–‡æœ¬å¤§å° textAlign: 'center', // æ–‡æœ¬å¯¹é½æ–¹å¼ fill: '#999', // æ–‡æœ¬é¢œè‰² &#125; &#125;, line: &#123; lineDash: [3, 3] &#125; &#125;); chart.line().position(`$&#123;axisX&#125;*$&#123;axisY&#125;`).color(`$&#123;axisValue&#125;`).shape('smooth'); //å¹³æ»‘æ›²çº¿å›¾ chart.point().position(`$&#123;axisX&#125;*$&#123;axisY&#125;`).color(`$&#123;axisValue&#125;`).size(4).shape('circle').style(&#123; stroke: '#fff', lineWidth: 1 &#125;); chart.render(); return chart&#125;//showData.vueimport &#123; chartInstance&#125; from '@/utils/charts'data() &#123; return&#123; chartIncome:'', chartData2: [&#123;&#125;], &#125;&#125;,mounted() &#123; this.chartIncome = chartInstance('c1', this.chartData2) //è¿”å›žå€¼å¾ˆé‡è¦ï¼Œå…³ä¹Žæ•°æ®å˜åŠ¨ this.chartRegister = chartInstance('c2', this.chartData2) this.chartActive = chartInstance('c3', this.chartData2) &#125;,methods: &#123; //åˆ‡æ¢æ•°æ® onChangeIncome(e) &#123; const dateChange = e.target.value switch(dateChange) &#123; case 'a': this.chartIncome.changeData(this.chartData2) break case 'b': this.chartIncome.changeData(this.chartData3) break case 'c': this.chartIncome.changeData(this.chartData) break &#125; &#125;,&#125;]]></content>
      <categories>
        <category>Antv-G2</category>
      </categories>
      <tags>
        <tag>Programming</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[javascript]]></title>
    <url>%2F2019%2F09%2F12%2Fjs%2F</url>
    <content type="text"><![CDATA[Arrayå±žæ€§ï¼šArray.length æ–¹æ³•ï¼šArray.from()ä»Žç±»æ•°ç»„å¯¹è±¡æˆ–è€…å¯è¿­ä»£å¯¹è±¡ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„å®žä¾‹ 123&lt;!-- æ•°ç»„åŽ»é‡ --&gt;const arr = [1,3,5,56,3,2,1]const res = Array.from(new Set(arr)) Array.isArray()ç”¨æ¥åˆ¤æ–­æŸä¸ªå˜é‡æ˜¯å¦æ˜¯ä¸€ä¸ªæ•°ç»„å¯¹è±¡ã€‚ 12const obj = &#123;'key': 'value'&#125;Array.isArray(obj) // false Array.of()æ ¹æ®ä¸€ç»„å‚æ•°æ¥åˆ›å»ºæ–°çš„æ•°ç»„å®žä¾‹ï¼Œæ”¯æŒä»»æ„çš„å‚æ•°æ•°é‡å’Œç±»åž‹ Array instanceå±žæ€§ï¼šArray.prototype.constructorè¿”å›žå€¼ Array Array.prototype.lengthè¿”å›žå€¼é•¿åº¦ æ–¹æ³•ï¼šä¿®æ”¹å™¨æ–¹æ³•ï¼šä¸‹é¢çš„è¿™äº›æ–¹æ³•ä¼šæ”¹å˜è°ƒç”¨å®ƒä»¬çš„ å¯¹è±¡è‡ªèº« çš„å€¼ 123456789Array.prototype.copyWithin()Array.prototype.fill()Array.prototype.pop()Array.prototype.push()Array.prototype.reverse()Array.prototype.shift()Array.prototype.sort()Array.prototype.splice()Array.prototype.unshift() è®¿é—®æ–¹æ³•ï¼šä»¥ä¸‹æ–¹æ³•ä¸ä¼šæ”¹å˜è°ƒç”¨å®ƒä»¬çš„å¯¹è±¡çš„å€¼ï¼Œåªä¼šè¿”å›žä¸€ä¸ªæ–°çš„æ•°ç»„æˆ–è€…è¿”å›žä¸€ä¸ªå…¶å®ƒçš„æœŸæœ›å€¼ã€‚ 12345678Array.prototype.concat()Array.prototype.includes()Array.prototype.join()Array.prototype.slice()Array.prototype.toString()Array.prototype.toLocaleString()Array.prototype.indexOf()Array.prototype.lastIndexOf() è¿­ä»£æ–¹æ³•ï¼š 1234567Array.prototype.forEach()Array.prototype.every()Array.prototype.some()Array.prototype.filter()Array.prototype.map()Array.prototype.reduce()Array.prototype.reduceRight() Stringå±žæ€§ï¼šString.prototype æ–¹æ³•ï¼šString.fromCharCode()é€šè¿‡ä¸€ä¸² Unicode åˆ›å»ºå­—ç¬¦ä¸² String instanceå±žæ€§:String.prototype.constructorè¿”å›žå€¼ String String.prototype.lengthå­—ç¬¦ä¸²é•¿åº¦ æ–¹æ³•ï¼š 123456789101112131415161718192021222324252627282930String.prototype.charAt()String.prototype.charCodeAt()String.prototype.codePointAt()String.prototype.concat()String.prototype.includes()String.prototype.endsWith()String.prototype.indexOf()String.prototype.lastIndexOf()String.prototype.localeCompare()String.prototype.match()String.prototype.normalize()String.prototype.padEnd()String.prototype.padStart()String.prototype.repeat()String.prototype.replace()String.prototype.search()String.prototype.slice()String.prototype.split()String.prototype.startsWith()String.prototype.substr()String.prototype.substring()String.prototype.toLocaleLowerCase()String.prototype.toLocaleUpperCase()String.prototype.toLowerCase()String.prototype.toUpperCase()String.prototype.toString()String.prototype.trim()String.prototype.trimLeft()String.prototype.trimRight()String.prototype.valueOf() ObjectObjectæž„é€ å‡½æ•°æ–¹æ³•1234567891011121314151617181920Object.assign()Object.create()Object.defineProperty()Object.defineProperties()Object.entries()Object.freeze()Object.getOwnPropertyDescriptor()Object.getOwnPropertyNames()Object.getOwnPropertySymbols()Object.getPrototypeOf()Object.is()Object.isExtensible()Object.isFrozen()Object.isSealed()Object.keys()Object.values()Object.preventExtensions()Object.seal()Object.setPrototypeOf()delete obj.property]]></content>
      <categories>
        <category>Javascript</category>
      </categories>
      <tags>
        <tag>Programming</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Git]]></title>
    <url>%2F2019%2F09%2F11%2FGit%2F</url>
    <content type="text"><![CDATA[Gitå®žç”¨å‘½ä»¤æ€»ç»“æ€»ç»“äº†éƒ¨åˆ†å¼€å‘ä¸­å¸¸ç”¨çš„gitæ“ä½œå‘½ä»¤ï¼Œæ ¹æ®å®žé™…ä¸šåŠ¡é‡åˆ°çš„æƒ…å†µæ¢³ç†ã€‚åŒ…æ‹¬ä½†ä¸é™äºŽåˆ†æ”¯æ–°å»ºã€åˆ†æ”¯åˆå¹¶ã€åˆ†æ”¯åˆå¹¶å†²çªã€distæ–‡ä»¶å†²çªã€ç‰ˆæœ¬å›žé€€ç­‰ã€‚ å‘½åè§„èŒƒ æ ‡è®° è§£é‡Š feat æ–°åŠŸèƒ½ fix ä¿®è¡¥bug doc æ–‡æ¡£ style æ ¼å¼ï¼Œä¸å½±å“ä»£ç  refactor é‡æž„ï¼Œä¸æ·»åŠ æ–°åŠŸèƒ½ï¼Œä¹Ÿéžä¿®è¡¥bug test å¢žåŠ æµ‹è¯• chore æž„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥ç¨‹å˜åŠ¨ scope ç”¨äºŽè¯´æ˜Žcommitå½±å“çš„èŒƒå›´ é—®é¢˜è§£å†³ä¿®æ”¹æ–‡ä»¶å¤§å°å†™Windowså¯¹å¤§å°å†™ä¸æ•æ„Ÿï¼Œgitå¯¹å¤§å°å†™ä¸æ•æ„Ÿï¼Œéœ€è¦ä¿®æ”¹æ–‡ä»¶åçš„å¤§å°å†™ï¼Œå®žé™…ä¿®æ”¹äº†gitå´ä¸ä¼šç”Ÿæ•ˆçš„ï¼Œè§£å†³: 1. å¤åˆ¶æ­¤æ–‡ä»¶åˆ°å…¶ä»–åœ°æ–¹å¤‡ä»½ 2. åˆ é™¤é¡¹ç›®ä¸­çš„è¯¥æ–‡ä»¶ 3. æäº¤ä»£ç  4. é‡æ–°æ·»åŠ æ­¤æ–‡ä»¶åˆ°é¡¹ç›® 5. æäº¤ä»£ç ï¼Œover gitå®žç”¨å‘½ä»¤git stashæƒ³è¦åˆ‡æ¢åˆ†æ”¯ï¼Œæœ¬åœ°å´å·²ç»åšäº†æ”¹å˜ã€‚åˆ‡æ¢ä¼šæŠ¥é”™ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨ git stashä¿å­˜å½“å‰çš„ä¿®æ”¹ï¼Œç­‰å¤„ç†å®Œå…¶ä»–åˆ†æ”¯äº‹åŠ¡åœ¨å›žæ¥â€˜å–å‡ºä¿å­˜â€™çš„ä¿®æ”¹å³å¯ã€‚ å‘½ä»¤ ä½œç”¨è¯´æ˜Ž git stash ä¿å­˜å½“å‰å·¥ä½œåŒºå’Œæš‚å­˜åŒºçš„ä¿®æ”¹ git stash save â€˜æ³¨é‡Šä¿¡æ¯â€™ ä½œç”¨åŒä¸Šï¼ŒåŠ ä¸Šäº†æ³¨é‡Šä¿¡æ¯æ–¹ä¾¿åŒºåˆ† git stash list æŸ¥çœ‹ä¿å­˜åˆ—è¡¨ git stash pop æ¢å¤æœ€è¿‘ä¸€æ¬¡ä¿å­˜å¹¶åˆ æŽ‰ä¿å­˜åˆ—è¡¨çš„è®°å½•ï¼Œåªæ¢å¤å·¥ä½œåŒº git stash pop â€“index ä¸Žä¸Šé¢å‘½ä»¤çš„æ•ˆæžœä¸€æ ·ä½†æ˜¯è¿˜ä¼šæ¢å¤æš‚å­˜åŒºï¼ git stash pop stash@{åºå·} æ¢å¤ä¿å­˜åˆ—è¡¨é‡ŒæŒ‡å®šçš„ä¿å­˜è®°å½•ï¼Œå¹¶æŠŠæ¢å¤çš„è®°å½•ä»Žä¿å­˜åˆ—è¡¨ä¸­åˆ é™¤ git stash apply æ¢å¤æœ€è¿‘çš„ä¿å­˜è®°å½•ä½†ä¸ä¼šåˆ é™¤ä¿å­˜åˆ—è¡¨é‡Œé¢å¯¹åº”çš„è®°å½• git stash drop åˆ é™¤ä¿å­˜åˆ—è¡¨é‡Œé¢æœ€è¿‘ä¸€æ¡ä¿å­˜è®°å½•ã€‚åŽé¢åŠ  stash@{åºå·}å¯ä»¥åˆ é™¤æŒ‡å®šçš„ä¿å­˜è®°å½• git stash clear åˆ é™¤ä¿å­˜åˆ—è¡¨é‡Œé¢æ‰€ä»¥ä¿å­˜è®°å½•ï¼ˆæ¸…ç©ºä¿å­˜åˆ—è¡¨ï¼‰ git stash åˆ†æ”¯å stash@{åºå·} ä¿®æ”¹äº†æ–‡ä»¶ï¼Œæ­¤æ¬¡ä¿®è¯¥ä½¿ç”¨äº† git stash ä¿å­˜ï¼Œç„¶åŽç»§ç»­ä¿®æ”¹äº†è¯¥æ–‡ä»¶ï¼Œæ­¤æ—¶å†ç”¨ git stash pop æˆ– git stash apply æ¢å¤ä¹‹å‰çš„ä¿å­˜ï¼Œå¯èƒ½ä¼šå‡ºçŽ°å†²çªã€‚æ­¤æ—¶ä½¿ç”¨è¯¥å‘½ä»¤ git stash åˆ†æ”¯å stash@{åºå·} ä¼šåˆ›å»ºä¸€ä¸ªåˆ†æ”¯ç„¶åŽåœ¨åˆ›å»ºçš„åˆ†æ”¯ä¸ŠæŠŠä¿å­˜çš„è®°å½•æ¢å¤å‡ºæ¥ï¼Œé¿å…å†²çªã€‚ PS ï¼š git stash ä¿å­˜çš„ä¿®æ”¹å¯ä»¥è·¨åˆ†æ”¯åº”ç”¨ã€‚ä¾‹å¦‚ï¼šåœ¨ developåˆ†æ”¯ä¸Šåšäº†ä¿®æ”¹ï¼Œ *git stashä¿å­˜ï¼Œåˆ‡æ¢åˆ° *master åˆ†æ”¯ï¼Œä½¿ç”¨ pop æˆ– apply æ‹‰å‡ºæ¥ä¿å­˜ï¼Œè¿™æ ·å°±å¯ä»¥æŠŠ develop åˆ†æ”¯ä¸Šä¿®æ”¹çš„å†…å®¹è¿ç§»åˆ° master ä¸Šï¼Œè§£å†³å†²çªå¯èƒ½ä¼šé‡åˆ°ã€‚ gitæ’¤å›žæ–‡ä»¶ å‘½ä»¤ ä½œç”¨è¯´æ˜Ž git reset HEAD æ”¾å¼ƒæš‚å­˜åŒºçš„ä¿®æ”¹ï¼ˆå·²ç»add,æœªcommitï¼‰ git checkout â€“ * æ”¾å¼ƒæœ¬åœ°ä¿®æ”¹ï¼ˆæœªcommitï¼‰ git reset â€“soft HEAD^ æ’¤é”€commit æ’¤é”€çº¿ä¸Šä»“åº“çš„commité€‚ç”¨äºŽé”™è¯¯çš„pushåŽæ²¡æœ‰ä»–äººå†æ¬¡push 12$ git reset --soft &lt;commitHash&gt;$ git push --force git revertæ’¤é”€å‡ æ¬¡ä¹‹å‰çš„commitï¼Œåˆéœ€è¦ä¿ç•™è¯¥commitä¹‹åŽçš„æäº¤æ—¶ï¼Œéœ€è¦ç”¨åˆ° revert 123$ git log $ git revert commit_hash$ git push git reset æœ¬è´¨å³æŠŠæŒ‡é’ˆ HEAD æŒ‡å‘æŸä¸€ä¸ª commitgit revert æœ¬è´¨ä¸ç®—æ˜¯å›žæ»šï¼Œæ˜¯ååšï¼Œåå‘æ“ä½œcommitã€‚æ­£å¸¸æƒ…å†µä¸‹ï¼Œæ¯ä¸€æ¬¡æ“ä½œæ–‡ä»¶åŽä¼šè®© Git æ—¶é—´çº¿å¾€å‰èµ°ä¸€æ­¥ï¼Œrevertåå‘æ“ä½œæŸä¸€ä¸ªcommit è®°å½•ï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªæ–°çš„ commit æ¥ååš é…ç½®åˆ«åé•¿å‘½ä»¤çš„åˆ«åé…ç½® 1$ git config --global alias.st status ä¸€ä¸ªæ¯”è¾ƒå®žç”¨çš„åˆ«åé…ç½®â†“ 1git config --global alias.lg &quot;log --color --graph --pretty=format:&apos;%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an&gt;%Creset&apos; --abbrev-commit&quot; æ¯ä¸ªä»“åº“çš„Gité…ç½®æ–‡ä»¶éƒ½æ”¾åœ¨.git/configæ–‡ä»¶ä¸­ 1$ cat .git/config 12345[branch &quot;master&quot;] remote = originq merge = refs/heads/master[alias] last = log -1 //å‘½ä»¤ä½œç”¨åŒºåŸŸ é…ç½®åˆ«åä¹Ÿå¯ä»¥ç›´æŽ¥ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶â†‘ æ–°å»ºåˆ†æ”¯ä½œä¸šä¿®æ”¹bugã€æ·»åŠ æ–°åŠŸèƒ½ç­‰ï¼Œåœ¨ä¸»åˆ†æ”¯ä¸Šå¼€ä¸€ä¸ªæ–°åˆ†æ”¯è¿›è¡Œä½œä¸šï¼Œå¾…ä½œä¸šå®ŒæˆåŽï¼Œå†åˆå¹¶å›žä¸»åˆ†æ”¯ï¼Œå¹¶åˆ æŽ‰æ–°å¼€çš„åˆ†æ”¯ã€‚ æ–¹æ³•ä¸€ï¼š1234masteråˆ†æ”¯$ git checkout master $ git checkout -b xqcircle origin/xqcircle //åˆ›å»ºæ–°åˆ†æ”¯å¹¶å…³è”åœ¨è¿œç¨‹åŒååˆ†æ”¯ä¸Š$ git push origin HEAD //æŠŠè¯¥åˆ†æ”¯æŽ¨é€åˆ°è¿œç¨‹ï¼Œå³å¯ä»¥åœ¨gitä»“åº“çœ‹åˆ° æ–¹æ³•äºŒï¼š1234$ git branch dev $ git branch -a$ git branch -b branch_name //æœ¬åœ°å…ˆåˆ›å»ºè¯¥åˆ†æ”¯$ git push --set-upstream origin branch_name //æœ¬åœ°åˆ†æ”¯æŽ¨é€åˆ°è¿œç¨‹åŒååˆ†æ”¯ï¼Œä¸”æœ¬åœ°åˆ†æ”¯ä¼šè‡ªåŠ¨trackè¯¥åˆ†æ”¯ æ‹‰å–åˆ†æ”¯è¿œç¨‹å­˜åœ¨åˆ†æ”¯ï¼Œæœ¬åœ°æ²¡æœ‰è¯¥åˆ†æ”¯ï¼Œç”¨ä»¥ä¸‹å‘½ä»¤æ‹‰ä¸‹æ¥ 1$ git checkout --track origin/branch_name åˆå¹¶å›žä¸»åˆ†æ”¯12$ git checkout master$ git merge branch_name åˆ é™¤è¿œç¨‹åˆ†æ”¯12$ git branch -r -d origin/branch_name $ git push origin :branch_name åˆ é™¤æœ¬åœ°åˆ†æ”¯12$ git branch -d branch_name$ git branch -D branch_name æ ‡ç­¾tagä¸€ä¸ªç‰ˆæœ¬ä¸Šçº¿å®šä¹‰ä¸€ä¸ªç‰ˆæœ¬æ ‡ç­¾ï¼Œæ–¹ä¾¿å¿«é€Ÿå›žé€€è¯¥ç‰ˆæœ¬ã€‚ 123git tag //åˆ—å‡ºæ‰€æœ‰taggit tag -r //æŸ¥çœ‹è¿œç«¯æ‰€æœ‰åˆ†æ”¯git tag -l &apos;v2.0.1&apos; //è¿‡æ»¤tag æ–°å»ºtag1git tag xqCircle-v2.0.0 æŸ¥çœ‹tagï¼Œcommitå·1git show tagName ç»™æŸä¸ªcommitæ‰“ä¸Štag1git tag -a v1.0.0 commitId -m &apos;my tag&apos; æŽ¨é€tagåˆ°æœåŠ¡å™¨12git push origin tagName //æŽ¨é€æŸä¸ªå…·ä½“taggit push origin --tags //æŽ¨é€æœ¬åœ°æ‰€æœ‰tags åˆ‡æ¢åˆ°æŸä¸ªtagè·Ÿåˆ†æ”¯ä¸€æ ·ï¼Œå¯ä»¥ç›´æŽ¥åˆ‡æ¢åˆ°æŸä¸ªtagåŽ»ã€‚è¿™ä¸ªæ—¶å€™ä¸ä½äºŽä»»ä½•åˆ†æ”¯ï¼Œå¤„äºŽæ¸¸ç¦»çŠ¶æ€ 1git checkout xqCircle-v2.0.1 åˆ‡æ¢åˆ°æŸtagå¹¶æ–°å»ºåˆ†æ”¯1git checkout -b branchName tagName åˆ é™¤tag12git tag -d xqCircle-v2.0.1 //æœ¬åœ°åˆ é™¤git push origin :refs/tags/xqCircle2.0.1 //è¿œç«¯åˆ é™¤ port 22 failâ€œconnect to host github.com port 22: Connection timed out fatal: Could not read from remote repository.â€è¿™ä¸ªæŠ¥é”™ï¼Œä¼˜å…ˆè§£å†³æœ¬åœ°æ˜¯å¦æ­£ç¡®çš„é“¾æŽ¥ä¸Šçº¿ä¸Šä»“åº“ git remote set-url origin git@yourGitUrlHeregit@yourGitUrlHere ä¸ºçº¿ä¸Šgithubçš„ä»“åº“è®¿é—®åœ°ä¸»]]></content>
      <categories>
        <category>Git</category>
      </categories>
      <tags>
        <tag>Programming</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Pythonä¸ŽJavaScriptå¯¹ç…§å­¦ä¹ æ€»ç»“ç‚¹]]></title>
    <url>%2F2019%2F08%2F28%2FlearnPython%2F</url>
    <content type="text"><![CDATA[åºè¨€Pythonï¼š å»–é›ªå³°-Pythonä¼ é€é—¨ï¼š https://www.liaoxuefeng.com/wiki/1016959663602400å‘½ä»¤è¡Œæ‰“å¼€ .py æ–‡ä»¶ï¼›Pythonäº¤äº’çŽ¯å¢ƒï¼Œæ‰§è¡ŒPythonä»£ç  ç¼©è¿›æ–¹å¼è¿›è¡Œä»£ç æ ¼å¼ï¼ï¼4æ ¼ç©ºæ ¼ç¼©è¿›å¤§å°å†™æ•æ„Ÿ æ•°æ®ç±»åž‹ï¼š æ•´æ•° æµ®ç‚¹æ•° å­—ç¬¦ä¸² å¸ƒå°”å€¼ =ã€‹ and, or, not ç©ºå€¼ None åˆ—è¡¨ å­—å…¸ å˜é‡: å¸¸é‡ï¼Œå³ä¸èƒ½å˜çš„å˜é‡ï¼ŒæŒ‡é’ˆæŒ‡å‘ä¸å˜ ç±»constï¼Œå¸¸é‡ä¸€èˆ¬ä¸ºå˜é‡åå…¨éƒ¨å¤§å†™ å…¨å±€å˜é‡ï¼šå…¨å±€å˜é‡globalDataçš„å®šä¹‰ï¼Œåœ¨è¯»å®Œäº†æ•™ç¨‹ä¹‹åŽä¹Ÿæ²¡å‘çŽ°å…³äºŽå…¨å±€å˜é‡çš„å®šä¹‰ï¼ŒåŸºäºŽjsçš„æ€æƒ³ï¼Œåœ¨jsä¸­ï¼Œå…¨å±€å˜é‡å–å†³äºŽè¯¥å˜é‡å®šä¹‰çš„ä½ç½®ï¼Œä¼ ç»Ÿwebç¼–ç¨‹ä¸­ï¼Œæœªæ·»åŠ å®šä¹‰ç¬¦å·ï¼ˆvar, let, constï¼‰çš„å˜é‡éƒ½å¯è¢«ç§°ä¸ºâ€å…¨å±€å˜é‡â€,å³ä½¿æ˜¯ var ä¹Ÿå­˜åœ¨ä¸€ä¸ªå˜é‡æå‡çš„é—®é¢˜ã€‚Pythonä¸­å…¨å±€å˜é‡ä¸€èˆ¬æœ‰ä¸¤ç§æ–¹å¼ï¼š å£°æ˜Žå¼å…³é”®å­— global å®šä¹‰å˜é‡æ³•ã€‚å¯ä»¥ç›´æŽ¥è¿›è¡Œå…¨å±€å˜é‡å£°æ˜Žã€‚global OLD_URL æ¨¡å—æ³•æ¨¡å—æ³•å’Œjså¤§åŒå°å¼‚ï¼Œjsä¸­æ²¡æœ‰å…³é”®å­— global ï¼Œä½†æ˜¯æ¨¡å—å¼•ç”¨ä¹Ÿæ˜¯éžå¸¸å¥½ç”¨çš„ï¼Œåœ¨ä¸­å¤§åž‹é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬æŠŠé¡¹ç›®ä¸­ç”¨åˆ°çš„å¸¸é‡å•ç‹¬æå–å‡ºæ¥æ”¾ç½®åœ¨jsæ–‡ä»¶ä¸­ã€‚åœ¨é€šè¿‡ import æ¥å¯¼å…¥ä½¿ç”¨ã€‚Pythonä¸­ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ é™¤æ³•ï¼š / æµ®ç‚¹æ•°é™¤æ³•ï¼Œå³ä¾¿æ˜¯ä¸¤ä¸ªæ•´æ•°ç›¸é™¤ï¼Œç»“æžœä¹Ÿæ˜¯æµ®ç‚¹æ•° // åœ°æ¿é™¤ï¼Œä¸¤ä¸ªæ•´æ•°çš„é™¤æ³•ä»ç„¶æ˜¯æ•´æ•°ï¼Œç»“æžœåªå–æ•´æ•° 10 // 3 =ã€‹ 3 % æ±‚æ¨¡å–ä½™ å­—ç¬¦ä¸²ç¼–ç ï¼š ord() æ•°èŽ·å–å­—ç¬¦çš„æ•´æ•°è¡¨ç¤º chr() å‡½æ•°æŠŠç¼–ç è½¬æ¢ä¸ºå¯¹åº”çš„å­—ç¬¦Pythonçš„å­—ç¬¦ä¸²ç±»åž‹æ˜¯strï¼Œåœ¨å†…å­˜ä¸­ä»¥Unicodeè¡¨ç¤ºPythonå¯¹bytesç±»åž‹çš„æ•°æ®ç”¨å¸¦bå‰ç¼€çš„å•å¼•å·æˆ–åŒå¼•å·è¡¨ç¤º x = bâ€™abcâ€™ encode() æ–¹æ³•å¯ä»¥ç¼–ç ä¸ºæŒ‡å®šçš„bytes decode() æ–¹æ³• æŠŠbyteså˜ä¸ºstrå¦‚æžœbytesä¸­åªæœ‰ä¸€å°éƒ¨åˆ†æ— æ•ˆçš„å­—èŠ‚ï¼Œå¯ä»¥ä¼ å…¥errors=â€™ignoreâ€™å¿½ç•¥é”™è¯¯çš„å­—èŠ‚ï¼š bâ€™\xe4\xb8\xad\xffâ€™.decode(â€˜utf-8â€™, errors=â€™ignoreâ€™) len() æ–¹æ³•è®¡ç®—strçš„å­—ç¬¦æ•°1ä¸ªä¸­æ–‡å­—ç¬¦ç»è¿‡UTF-8ç¼–ç å ç”¨3ä¸ªå­—èŠ‚ï¼Œè€Œ1ä¸ªè‹±æ–‡å­—ç¬¦åªå ç”¨1ä¸ªå­—èŠ‚ã€‚ åšæŒ utf-8 ç¼–ç  æ–‡ä»¶å¼€å¤´å†™ä¸Šï¼š 12#!/usr/bin/env python3# -*- coding: utf-8 -*- æ ¼å¼åŒ–ï¼š Pythonä¸ŽCä¸€è‡´ï¼Œéƒ½é‡‡ç”¨ % å®žçŽ°%è¿ç®—ç¬¦å°±æ˜¯ç”¨æ¥æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ã€‚åœ¨å­—ç¬¦ä¸²å†…éƒ¨ï¼Œ%sè¡¨ç¤ºç”¨å­—ç¬¦ä¸²æ›¿æ¢ï¼Œ%dè¡¨ç¤ºç”¨æ•´æ•°æ›¿æ¢&#39;age: %s. nmae: %s&#39; %(25, fhl) format() æ ¼å¼åŒ–ï¼Œæ¯”è¾ƒéº»çƒ¦ list å’Œ tuple : list : åˆ—è¡¨ã€‚ç±»æ•°ç»„ Arrayclassmates = [&#39;xaioming&#39;, &#39;xiaohua&#39;, &#39;xiaoliu&#39;]èŽ·å–æœ€åŽä¸€ä¸ªå…ƒç´  classmates[len(classmates) - 1] æˆ–è€… classmates[-1] list æ–¹æ³•ï¼šappend(content) æœ«å°¾æ’å…¥insert(index, content) æ’å…¥æŒ‡å®šä½ç½®pop() åˆ é™¤æœ«å°¾å…ƒç´ pop(index) åˆ é™¤æŒ‡å®šä½ç½®å…ƒç´  tuple å…ƒç»„ï¼Œæœ‰åºåˆ—è¡¨ä¸€æ—¦åˆå§‹åŒ–ï¼Œä¸èƒ½æ›´æ”¹ã€‚æ²¡æœ‰appendã€insertæ–¹æ³•ï¼Œå…¶ä»–å’Œlistä¸€è‡´å› ä¸ºä¸èƒ½æ›´æ”¹ï¼Œæ•…æ›´ä¸ºå®‰å…¨ï¼Œèƒ½ç”¨tupleä»£æ›¿listå°±å°½é‡ç”¨tupleï¼t = (1,)t = (&#39;str&#39;, 23, [&#39;a&#39;]) æ¡ä»¶åˆ¤æ–­: 123456if age &gt;= 18: print('æˆå¹´äºº')elif age &gt;= 1: print('å¹¼å„¿æœŸ')else: print('å©´å„¿æœŸ') int() è½¬åŒ–ä¸ºæ•´æ•°å‡½æ•° å¾ªçŽ¯ forâ€¦inå¾ªçŽ¯ while å¾ªçŽ¯ range() ç”Ÿæˆä¸€ä¸ªæ•´æ•°åºåˆ—,å†é€šè¿‡list()å‡½æ•°å¯ä»¥è½¬æ¢ä¸ºlist break é€€å‡ºå¾ªçŽ¯ é…åˆifä½¿ç”¨ continue è·³è¿‡å¾ªçŽ¯ é…åˆifä½¿ç”¨ ä½¿ç”¨dictå’Œsetï¼šdictionaryå­—å…¸ï¼Œå…¶ä»–è¯­è¨€å«mapï¼Œä½¿ç”¨key-valueå­˜å‚¨ï¼Œä¹Ÿå°±æ˜¯jsçš„å¯¹è±¡ã€‚jsonçš„è¯ï¼Œæœ¬è´¨æ˜¯å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥ç±»æ¯”å§ã€‚d = {&#39;name&#39;: &#39;fhl&#39;, &#39;age&#39;: 22, }PS: åŒºåˆ«ç‚¹ï¼š jsçš„å¯¹è±¡å¯ä»¥ä½¿ç”¨ . æ–¹æ³•è°ƒç”¨ï¼ŒPythonç›®å‰åªèƒ½ d[â€˜ageâ€™]æˆ–è€… d.get(â€˜ageâ€™,-1)èŽ·å–å­˜å‚¨çš„å€¼åˆ é™¤ä¸€ä¸ªkeyï¼Œå¯ä»¥ç”¨ pop(key)dictionaryæ˜¯ç©ºé—´æ¢æ—¶é—´çš„æ–¹æ³•ï¼Œlistæ—¶é—´æ¢ç©ºé—´ setåŒjsä¸­çš„keyåŒæ ¹åŒæºï¼Œå­˜å‚¨keyçš„é›†åˆ,ä¸å­˜å‚¨valueï¼Œä¸”keyä¸é‡å¤ï¼ï¼ï¼åˆ›å»ºsetï¼Œéœ€è¦ä¸€ä¸ªlistä½œä¸ºè¾“å…¥é›†åˆ add(key) æ·»åŠ å…ƒç´ åˆ°setä¸­ï¼Œé‡å¤æ·»åŠ ä¸ä¼šæœ‰æ•ˆæžœ remove(key) åˆ é™¤å…ƒç´  setå¯çœ‹åšæˆæ— åºã€æ— é‡å¤å…ƒç´ çš„é›†åˆï¼Œå› æ­¤ï¼Œä¸¤ä¸ªsetå¯ä»¥åšæ•°å­¦æ„ä¹‰ä¸Šçš„äº¤é›†ã€å¹¶é›†ç­‰1234s1 = set([1, 3, 54])s2 = set([2, 3, 4])s1 &amp; s2 # å¹¶ ï¼Œå•ä¸ª&amp; s1 | s2 # | æˆ–ï¼Œå•ä¸ª| å‡½æ•°è‡ªå¸¦å‡½æ•°ï¼ˆå†…ç½®å‡½æ•°ï¼‰ï¼š abs() ã€max()æ•°æ®ç±»åž‹è½¬æ¢å‡½æ•°ï¼š int() float() str() bool() å‚è€ƒjsçš„æ•°æ®è½¬æ¢å‡½æ•° String() Number() Boolean() å®šä¹‰å‡½æ•°ï¼šå…³é”®å­—ï¼š def, ä¾æ¬¡å†™å‡ºå‡½æ•°åã€æ‹¬å·ã€æ‹¬å·ä¸­çš„å‚æ•°å’Œå†’å·:,ç„¶åŽï¼Œåœ¨ç¼©è¿›å—ä¸­ç¼–å†™å‡½æ•°ä½“ï¼Œå‡½æ•°çš„è¿”å›žå€¼ç”¨returnè¯­å¥è¿”å›žç±»æ¯”js: å…³é”®å­—function ï¼ŒåŽé¢éƒ½ä¸€è‡´ï¼Œç„¶åŽæŠŠ å†’å· æ¢æˆ jsä¸­çš„ å¤§æ‹¬å· å³å¯ 12345def my_abs(num): if x &gt;= 10: return x else: return -x æ‰§è¡Œå‡½æ•°ï¼š ç›¸æ¯”äºŽPythonï¼Œjsçš„å‡½æ•°æ‰§è¡Œæ¯”è¾ƒç®€å•ï¼Œå®šä¹‰å®Œå‡½æ•°åŽï¼Œç›´æŽ¥ç”¨å‡½æ•°åå­—åŠ ä¸€å¯¹å°æ‹¬å·å°±å¯ä»¥è°ƒç”¨å½“å‰å‡½æ•°ï¼Œä½†Pythonè²Œä¼¼å¾—å…ˆå¯¼å…¥è¯¥å‡½æ•°ï¼Œæ‰å¯ä»¥è°ƒç”¨ 12from test import my_absmy_abs(-1) passå…³é”®å­—passè¯­å¥å•¥éƒ½ä¸åšï¼Œå°±å’Œ0ä¸€æ ·ï¼Œç”¨æ¥å ä½çš„ã€‚è®©ç¨‹åºå¯ä»¥è·‘èµ·æ¥ã€‚å¯ä»¥ç†è§£ä¸ºæ–—åœ°ä¸»æ—¶ï¼Œä½ çš„ç‰Œå¤§ä¸è¿‡ä¸Šå®¶çš„ï¼Œä½ å°±å¯ä»¥å¤§å¼ä¸€å£°ï¼š pass/è¿‡ï¼Œè®©å•çº¿ç¨‹çš„æ–—åœ°ä¸»å¯ä»¥èµ°ä¸‹åŽ»ï¼Œè€Œä¸è‡³äºŽå¡åœ¨è¿™é‡Œï¼Œè®©é˜Ÿå‹å–·ä½  Pythonå‡½æ•°è¿”å›žå€¼jså‡½æ•°æ²¡æœ‰returnè¯­å¥æ—¶ï¼Œè¿”å›žçš„æ˜¯ undefinedã€‚Pythonè¿”å›žçš„æ˜¯ Noneï¼Œåœ¨å­˜åœ¨è¿”å›žå¤šä¸ªå€¼çš„æƒ…å†µä¸‹ã€‚Pythonè¿”å›žçš„æ˜¯tupleï¼Œä¸€ä¸ªtupleå¯ä»¥è¢«å¥½å¤šä¸ªå˜é‡æŽ¥æ”¶ï¼Œå…·ä½“åœºæ™¯å‚è€ƒES6çš„è§£æž„èµ‹å€¼ï¼Œä¸€æ¯›ä¸€æ ·ã€‚ é»˜è®¤å‚æ•°æ²¡å•¥å¥½è®²çš„ï¼Œå’ŒES6å‡½æ•°é»˜è®¤å‚æ•°ä¸€æ¯›ä¸€æ ·ï¼Œé»˜è®¤å‚æ•°åœ¨åŽï¼Œå¿…å¡«å‚æ•°åœ¨å‰ å¯å˜å‚æ•°å‚æ•°å‰é¢æ·»åŠ  * ï¼Œåœ¨å‡½æ•°å†…éƒ¨ï¼Œå‚æ•°numbersæŽ¥æ”¶åˆ°çš„æ˜¯ä¸€ä¸ªtupleï¼Œå› æ­¤ï¼Œå‡½æ•°ä»£ç å®Œå…¨ä¸å˜ã€‚ä½†æ˜¯ï¼Œè°ƒç”¨è¯¥å‡½æ•°æ—¶ï¼Œå¯ä»¥ä¼ å…¥ä»»æ„ä¸ªå‚æ•°ï¼ŒåŒ…æ‹¬0ä¸ªå‚æ•°ï¼Œæœ‰ç‚¹æ„æ€å¥¥,å³ä¾¿æˆ‘ä»¬çš„ä¼ å‚æ˜¯listæˆ–è€…tupleï¼Œä¹Ÿå¯ä»¥åœ¨å‚æ•°å‰åŠ  * ï¼Œä½¿å¾—listæˆ–è€… tuple å˜ä¸ºå¯å˜å‚æ•°ä¼ è¿›åŽ» å…³é”®å­—å‚æ•°**kyå¯å˜å‚æ•°å…è®¸ä½ ä¼ å…¥0ä¸ªæˆ–ä»»æ„ä¸ªå‚æ•°ï¼Œè¿™äº›å¯å˜å‚æ•°åœ¨å‡½æ•°è°ƒç”¨æ—¶è‡ªåŠ¨ç»„è£…ä¸ºä¸€ä¸ªtupleã€‚è€Œå…³é”®å­—å‚æ•°å…è®¸ä½ ä¼ å…¥0ä¸ªæˆ–ä»»æ„ä¸ªå«å‚æ•°åçš„å‚æ•°ï¼Œè¿™äº›å…³é”®å­—å‚æ•°åœ¨å‡½æ•°å†…éƒ¨è‡ªåŠ¨ç»„è£…ä¸ºä¸€ä¸ªdictã€‚å…³é”®å­—å‚æ•°æœ‰ä»€ä¹ˆç”¨ï¼Ÿå®ƒå¯ä»¥æ‰©å±•å‡½æ•°çš„åŠŸèƒ½ã€‚æ¯”å¦‚ï¼Œåœ¨personå‡½æ•°é‡Œï¼Œæˆ‘ä»¬ä¿è¯èƒ½æŽ¥æ”¶åˆ°nameå’Œageè¿™ä¸¤ä¸ªå‚æ•°ï¼Œä½†æ˜¯ï¼Œå¦‚æžœè°ƒç”¨è€…æ„¿æ„æä¾›æ›´å¤šçš„å‚æ•°ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½æ”¶åˆ°ã€‚è¯•æƒ³ä½ æ­£åœ¨åšä¸€ä¸ªç”¨æˆ·æ³¨å†Œçš„åŠŸèƒ½ï¼Œé™¤äº†ç”¨æˆ·åå’Œå¹´é¾„æ˜¯å¿…å¡«é¡¹å¤–ï¼Œå…¶ä»–éƒ½æ˜¯å¯é€‰é¡¹ï¼Œåˆ©ç”¨å…³é”®å­—å‚æ•°æ¥å®šä¹‰è¿™ä¸ªå‡½æ•°å°±èƒ½æ»¡è¶³æ³¨å†Œçš„éœ€æ±‚ 12345678def person(name, age, **kw): if 'city' in kw: # æœ‰cityå‚æ•° pass if 'job' in kw: # æœ‰jobå‚æ•° pass print('name:', name, 'age:', age, 'other:', kw) å‚æ•°å®šä¹‰çš„é¡ºåºå¿…é¡»æ˜¯ï¼šå¿…é€‰å‚æ•°ã€é»˜è®¤å‚æ•°ã€å¯å˜å‚æ•°ã€å‘½åå…³é”®å­—å‚æ•°å’Œå…³é”®å­—å‚æ•°ã€‚ æ€»ç»“ï¼š *argsæ˜¯å¯å˜å‚æ•°ï¼ŒargsæŽ¥æ”¶çš„æ˜¯ä¸€ä¸ªtupleï¼› **kwæ˜¯å…³é”®å­—å‚æ•°ï¼ŒkwæŽ¥æ”¶çš„æ˜¯ä¸€ä¸ªdictã€‚ é€’å½’å‡½æ•°ï¼šå°¾é€’å½’ä¼˜åŒ–1234def fact(n): if n==1: return 1 return n * fact(n - 1) ä»¥ä¸Šä»£ç æ˜¯Pythonçš„é€’å½’ä»£ç ï¼Œé¢ï¼Œå¯èƒ½è€¦åˆæ€§è¾ƒé«˜ï¼Œå‡½æ•°å†…éƒ¨ä½¿ç”¨äº†å½“å‰å‡½æ•°çš„åå­—ï¼Œè¿™é«˜åº¦è€¦åˆï¼Œåœ¨jsé‡Œé¢æˆ‘ä»¬å¯ä»¥é€šè¿‡ arguments.calleeè§£å†³è°ƒç”¨è‡ªèº«çš„é—®é¢˜ï¼Œå‡å°è€¦åˆã€‚ä»¥ä¸‹æ˜¯jsä»£ç ï¼š 123456function fact(n) &#123; if( n == 1 ) &#123; return 1 &#125; return n * arguments.callee(n-1)&#125; é«˜çº§ç‰¹æ€§ï¼šåˆ‡ç‰‡ sliceæ“ä½œç¬¦sliceåˆ‡ç‰‡æ“ä½œç¬¦ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯ç»™jsçš„slice()å‡½æ•°åšäº†ä¸€ä¸ªè¯­æ³•ç³–ï¼Œå…¶ä»–éƒ½ä¸€è‡´ 12L[0:5] #[start:end]ä½†ä¸åŒ…æ‹¬endï¼ŒLä¸ºlistæˆ–tupleL[-2:-1] #å€’æ•°ç¬¬ä¸€ä¸ªå…ƒç´ ç´¢å¼•ä¸º-1 æ‰€æœ‰æ•°ï¼Œæ¯5ä¸ªå–ä¸€ä¸ª 123456L = list(range(100))L[:10] # å‰åä¸ªæ•°L[:-10] # åŽåä¸ªæ•° L[:10:2] # å‰10ä¸ªæ•°ï¼Œæ¯ä¸¤ä¸ªå–ä¸€ä¸ªL[::5] # æ‰€æœ‰æ•°ï¼Œæ¯5ä¸ªå–ä¸€ä¸ªL[:] # èµ‹å€¼list åˆ‡ç‰‡ä¹Ÿå¯ä»¥å¯¹å­—ç¬¦ä¸²ä½¿ç”¨ï¼Œä¸éœ€è¦å•ç‹¬çš„ç±»ä¼¼substring()æ–¹æ³• è¿­ä»£å®šä¹‰ï¼š å¾ªçŽ¯éåŽ†listæˆ–è€…tupleï¼Œå«åšè¿­ä»£ã€‚è¿­ä»£é€šè¿‡ forâ€¦inâ€¦æ¥å®ŒæˆPythonå¯ä»¥è¿­ä»£ä¸€åˆ‡å¯è¿­ä»£çš„ä¸œè¥¿åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯å¯è¿­ä»£å¯¹è±¡å‘¢ï¼Ÿ 12from collections import Iterableisinstance('abc', Iterable) # åˆ¤æ–­stræ˜¯å¦æ˜¯å¯è¿­ä»£çš„å¯¹è±¡ï¼Œè¿”å›žBoolean åˆ—è¡¨ç”Ÿæˆå¼å°±æ˜¯ç®€åŒ–äº†å¤æ‚åˆ—è¡¨ç”Ÿæˆçš„ç¹çæ­¥éª¤ 1234567L = [] # å®žçŽ°ä¸€ä¸ª 1*1, 2*2,....10*10çš„åˆ—è¡¨for x in range(1, 11): # ä¼ ç»Ÿæ–¹æ³• L.append( x * x )[x*x for x in range(1, 10)] # åˆ—è¡¨ç”Ÿæˆå™¨[x*x for x in range(1, 10) if x % 2 == 0 ] # è¿˜å¯ä»¥åŠ ä¸Š if åˆ¤æ–­[m+n for m in 'abc' for n in 'xyz'] # åŒå±‚å¾ªçŽ¯ æŽ¥ä¸‹æ¥ï¼Œè¿™è¡Œä»£ç å¯èƒ½ä¼šè®©jserç¨å¾®ç¾¡æ…•ä¸€ä¸‹ï¼Œé‚£å°±æ˜¯æ“ä½œæ–‡ä»¶ 12import os # æ‹¿åˆ°äº†å½“å‰ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶å¤¹[d for d in os.listdir('.')] jsä¸èƒ½æ“ä½œæ–‡ä»¶çš„ï¼Œå½“ç„¶è¡¨äº² node.jsæ˜¯å¯ä»¥çš„dictçš„items() æ–¹æ³•å¯ä»¥åŒæ—¶è¿­ä»£keyå’Œvalueï¼Œé‚£ä¹ˆï¼š 12d = &#123;'x': 'A', 'y': 'B', 'z': 'C'&#125;[k + '=' + v for k, v in d.items() ] 12d = &#123;'Hello', 'WorLD'&#125; # æŠŠlistä¸­æ‰€æœ‰çš„å­—ç¬¦ä¸²å°å†™[s.lower() for s in d] ç”Ÿæˆå™¨åˆ—è¡¨å…ƒç´ å¯ä»¥æŒ‰ç…§æŸç§ç®—æ³•æŽ¨ç®—å‡ºæ¥ï¼Œé‚£æˆ‘ä»¬æ˜¯å¦å¯ä»¥åœ¨å¾ªçŽ¯çš„è¿‡ç¨‹ä¸­ä¸æ–­æŽ¨ç®—å‡ºåŽç»­çš„å…ƒç´ å‘¢ï¼Ÿè¿™æ ·å°±ä¸å¿…åˆ›å»ºå®Œæ•´çš„listï¼Œä»Žè€ŒèŠ‚çœå¤§é‡çš„ç©ºé—´ã€‚åœ¨Pythonä¸­ï¼Œè¿™ç§ä¸€è¾¹å¾ªçŽ¯ä¸€è¾¹è®¡ç®—çš„æœºåˆ¶ï¼Œç§°ä¸ºç”Ÿgenerator åˆ—è¡¨ç”Ÿæˆå¼çš„ [] æ”¹æˆ () å³å¯åˆ›å»ºç”Ÿæˆå™¨12L = [x * x for x in range(10) ] #åˆ—è¡¨ç”Ÿæˆå¼g = (x * x for x in range(10) ) # gæ˜¯ä¸€ä¸ªgeneratorã€nextï¼ˆï¼‰æ–¹æ³•æ‰“å°å€¼ generatorä¿å­˜çš„æ˜¯ç®—æ³•ï¼Œæ¯æ¬¡è°ƒç”¨next(g)ï¼Œå°±è®¡ç®—å‡ºgçš„ä¸‹ä¸€ä¸ªå…ƒç´ çš„å€¼ï¼Œç›´åˆ°è®¡ç®—åˆ°æœ€åŽä¸€ä¸ªå…ƒç´ ï¼Œæ²¡æœ‰æ›´å¤šçš„å…ƒç´ æ—¶ï¼ŒæŠ›å‡ºStopIterationçš„é”™è¯¯ä¸€èˆ¬ï¼Œgeneratorç”¨foræ¥å¾ªçŽ¯ï¼Œä¸ç”¨next() 12for n in g: print(n) å¦‚æžœä¸€ä¸ªå‡½æ•°å®šä¹‰ä¸­åŒ…å«yieldå…³é”®å­—ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°å°±ä¸å†æ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œè€Œæ˜¯ä¸€ä¸ªgeneratorï¼š1234567def fib(max): n, a, b = 0, 0, 1 while n &lt; max: yield b a, b = b, a + b n = n + 1 return 'done' PS::: eneratorå’Œå‡½æ•°çš„æ‰§è¡Œæµç¨‹ä¸ä¸€æ ·ã€‚å‡½æ•°æ˜¯é¡ºåºæ‰§è¡Œï¼Œé‡åˆ°returnè¯­å¥æˆ–è€…æœ€åŽä¸€è¡Œå‡½æ•°è¯­å¥å°±è¿”å›žã€‚è€Œå˜æˆgeneratorçš„å‡½æ•°ï¼Œåœ¨æ¯æ¬¡è°ƒç”¨next()çš„æ—¶å€™æ‰§è¡Œï¼Œé‡åˆ°yieldè¯­å¥è¿”å›žï¼Œå†æ¬¡æ‰§è¡Œæ—¶ä»Žä¸Šæ¬¡è¿”å›žçš„yieldè¯­å¥å¤„ç»§ç»­æ‰§è¡Œç”¨forå¾ªçŽ¯è°ƒç”¨generatoræ—¶ï¼Œå‘çŽ°æ‹¿ä¸åˆ°generatorçš„returnè¯­å¥çš„è¿”å›žå€¼ã€‚å¦‚æžœæƒ³è¦æ‹¿åˆ°è¿”å›žå€¼ï¼Œå¿…é¡»æ•èŽ·StopIterationé”™è¯¯ï¼Œè¿”å›žå€¼åŒ…å«åœ¨StopIterationçš„valueä¸­ï¼š 1234567g = fib()while True: try: x = next(g) except StopIteration as e: print('Generator return value:', e.value) break è¿­ä»£å™¨å¯ä»¥ç›´æŽ¥ä½œç”¨äºŽforå¾ªçŽ¯çš„æ•°æ®ç±»åž‹æœ‰ä»¥ä¸‹å‡ ç§ï¼š ä¸€ç±»æ˜¯é›†åˆæ•°æ®ç±»åž‹ï¼Œå¦‚listã€tupleã€dictã€setã€strç­‰ï¼› ä¸€ç±»æ˜¯generatorï¼ŒåŒ…æ‹¬ç”Ÿæˆå™¨å’Œå¸¦yieldçš„generator functionã€‚ è¿™äº›å¯ä»¥ç›´æŽ¥ä½œç”¨äºŽforå¾ªçŽ¯çš„å¯¹è±¡ç»Ÿç§°ä¸ºå¯è¿­ä»£å¯¹è±¡ï¼šIterableã€‚ å¯ä»¥ä½¿ç”¨isinstance()*åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯ *Iterable å¯¹è±¡ è€Œç”Ÿæˆå™¨ä¸ä½†å¯ä»¥ä½œç”¨äºŽforå¾ªçŽ¯ï¼Œè¿˜å¯ä»¥è¢«next()å‡½æ•°ä¸æ–­è°ƒç”¨å¹¶è¿”å›žä¸‹ä¸€ä¸ªå€¼ï¼Œç›´åˆ°æœ€åŽæŠ›å‡ºStopIterationé”™è¯¯è¡¨ç¤ºæ— æ³•ç»§ç»­è¿”å›žä¸‹ä¸€ä¸ªå€¼äº†ã€‚ å¯ä»¥è¢«next()å‡½æ•°è°ƒç”¨å¹¶ä¸æ–­è¿”å›žä¸‹ä¸€ä¸ªå€¼çš„å¯¹è±¡ç§°ä¸ºè¿­ä»£å™¨ï¼šIteratorã€‚ å¯ä»¥ä½¿ç”¨ isinstance() åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯ Iterator å¯¹è±¡ï¼š 1isinstance([], Iterator) ç”Ÿæˆå™¨éƒ½æ˜¯Iteratorå¯¹è±¡ï¼Œä½†listã€dictã€strè™½ç„¶æ˜¯Iterableï¼Œå´ä¸æ˜¯Iteratorã€‚ æŠŠlistã€dictã€strç­‰Iterableå˜æˆ Iterator å¯ä»¥ä½¿ç”¨ iter() å‡½æ•°ï¼š 1isinstance(iter([]), Iterator) # True PS: Pythonçš„forå¾ªçŽ¯æœ¬è´¨ä¸Šå°±æ˜¯é€šè¿‡ä¸æ–­è°ƒç”¨next()å‡½æ•°å®žçŽ°çš„ å‡½æ•°å¼ç¼–ç¨‹é«˜é˜¶å‡½æ•°å‡½æ•°åæ˜¯æŒ‡å‘å‡½æ•°çš„å˜é‡ï¼ˆåŒjs ï¼‰ï¼Œå³å‡½æ•°æœ¬èº«å¯ä»¥è¢«å˜é‡æŒ‡ç€ï¼Œåœ¨å˜é‡å¼•ç”¨ä¹Ÿæ˜¯å¯ä»¥çš„ä¸€ä¸ªå‡½æ•°æŽ¥å—å¦ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¿™ç§å‡½æ•°ç§°ä¸ºé«˜é˜¶å‡½æ•°ï¼ˆåŒjsï¼‰ map/reducemap å’Œ js çš„åŠŸèƒ½ä¸€è‡´ï¼Œå³éƒ½æ˜¯ä¸º Iterable çš„å…¨éƒ¨å…ƒç´ åº”ç”¨ä¸€ç§è§„åˆ™ã€‚è¿™ä¸ªè§„åˆ™ä¸€èˆ¬æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚ä¸è¿‡è¯­æ³•ä¸Šç¨æœ‰ä¸åŒ,jsçš„mapæ˜¯Arrayçš„ä¸€ä¸ªæ–¹æ³•ã€‚ python: map()å‡½æ•°æŽ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯å‡½æ•°ï¼Œä¸€ä¸ªæ˜¯Iterableï¼Œmapå°†ä¼ å…¥çš„å‡½æ•°ä¾æ¬¡ä½œç”¨åˆ°åºåˆ—çš„æ¯ä¸ªå…ƒç´ ï¼Œå¹¶æŠŠç»“æžœä½œä¸ºæ–°çš„Iteratorè¿”å›žã€‚ 12345def f(x): return x*xr = map(f, [1, 2, 3, 4]) # è¿”å›žçš„æ˜¯listæ¯é¡¹çš„å¹³æ–¹list(map(str, [1, 2, 32, 56]) # æŠŠæ¯ä¸€é¡¹å˜ä¸ºå­—ç¬¦ä¸² 123456789//jså®žçŽ°const arr = [1, 2, 3, 4]const r = arr.map(function(item) &#123; return item*item&#125;)// ES6const r = arr.map(item =&gt; &#123; return iten*item&#125;) ä¸ºä»€ä¹ˆjsçš„mapå°±åªæ˜¯Arrayçš„ä¸€ä¸ªæ–¹æ³•å‘¢ï¼Ÿæˆ‘ä¸ªäººè§‰å¾—ã€‚jsçš„æ•°æ®ç»“æž„å¹¶æ²¡æœ‰Pythoné‚£ä¹ˆçµæ´»ï¼Œå› ä¸ºjsçš„forå¾ªçŽ¯åªèƒ½å¾ªçŽ¯Arrayå’ŒObjectï¼Œè€Œåè§‚Pythonå°±æ¯”è¾ƒå¤šäº†ï¼Œæœ¬è´¨æ¥è¯´ï¼Œå°±æ˜¯ Iterable æ•°æ®ç»“æž„jsåªæœ‰Arrayå’ŒObjectã€‚è€ŒPythonæœ‰å¾ˆå¤šï¼Œé™¤äº†listå’Œtupleï¼Œè¿˜æœ‰stringä¹Ÿç®—ï¼Œç­‰ç­‰ reducereduceæŠŠä¸€ä¸ªå‡½æ•°ä½œç”¨åœ¨ä¸€ä¸ªåºåˆ—[x1, x2, x3, â€¦]ä¸Šï¼Œè¿™ä¸ªå‡½æ•°å¿…é¡»æŽ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼ŒreduceæŠŠç»“æžœç»§ç»­å’Œåºåˆ—çš„ä¸‹ä¸€ä¸ªå…ƒç´ åšç´¯ç§¯è®¡ç®—,å…¶æ•ˆæžœå°±æ˜¯ï¼š 1reduce(f,[x1, x2, x3]) = f(f(f(x1, x2,x3))) #ä¸‰ä¸ªfå…³ç³»ï¼Ÿå…¶å®žè¿™å°±è¯´æ˜Žäº†reduce()è¿™ä¸ªå‡½æ•°çš„ä½œç”¨äº†ã€‚ æ¯”å¦‚è¯´åºåˆ—æ±‚å’Œï¼š 1234from functools import reduce def add(x, y): return x + yreduce(add, [1, 3, 5, 7, 9]) #25 filter()å’Œmap()ç±»ä¼¼ï¼Œfilter()ä¹ŸæŽ¥æ”¶ä¸€ä¸ªå‡½æ•°å’Œä¸€ä¸ªåºåˆ—ã€‚å’Œmap()ä¸åŒçš„æ˜¯ï¼Œfilter()æŠŠä¼ å…¥çš„å‡½æ•°ä¾æ¬¡ä½œç”¨äºŽæ¯ä¸ªå…ƒç´ ï¼Œç„¶åŽæ ¹æ®è¿”å›žå€¼æ˜¯Trueè¿˜æ˜¯Falseå†³å®šä¿ç•™è¿˜æ˜¯ä¸¢å¼ƒè¯¥å…ƒç´ ã€‚ ä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªlistä¸­ï¼Œåˆ æŽ‰å¶æ•°ï¼Œåªä¿ç•™å¥‡æ•°ï¼Œå¯ä»¥è¿™ä¹ˆå†™ï¼š 12def is_odd(n): return n % 2 == 1 jsä¸­çš„filteråŒæ ·æ˜¯Arrayçš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºŽè¿‡æ»¤æ•°ç»„å¹¶è¿”å›žä¸€ä¸ªæ–°çš„æ•°ç»„ 1234const arr = [5, 16, 35, 15, 48]const r = arr.filter(item =&gt; &#123; //è¿”å›žræ˜¯ä¸€ä¸ªå¤§äºŽ18çš„æ•°ç»„ item &gt;= 18&#125;) ç›¸æ¯”äºŽjsæ¥è¯´ã€‚Pythonçš„filterå’Œmapç±»ä¼¼ï¼Œéƒ½å¯ä»¥ä½œç”¨äºŽIterableæ•°æ®ç±»åž‹ sorted()æŽ’åºå†…ç½®å‡½æ•°ï¼Œç”¨æ³•å’Œjsçš„sort()ç±»ä¼¼ã€‚ä½†æ˜¯jsçš„sort()æ–¹æ³•åœ¨æœªä¼ å‚æ•°çš„æƒ…å†µä¸‹ï¼Œé»˜è®¤æŒ‰ç…§å­—ç¬¦ç¼–ç çš„é¡ºåºè¿›è¡ŒæŽ’åºã€‚12L = [1, 5, 15, 25, 8]r = sorted(L) #1,5,8,15,25 jsçš„sort(): 12345let arr = [1, 5, 15, 25, 8]arr.sort() // 1,15,25,5,8arr.sort(function(a, b)&#123; //1,5,8,15,25 return a - b&#125;) çœ‹ä¸‹sorted()çš„å¼ºå¤§ï¼šå¯ä»¥ä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼Œç¬¬ä¸€å°±æ˜¯æŽ’åºçš„listï¼Œç¬¬äºŒä¸ªæ˜¯keyçš„è§„åˆ™ï¼Œç¬¬ä¸‰ä¸ªæ˜¯åè½¬å€’å™ï¼š 1sorted(['bov','lv','hln', 'Zomp'], key = str.lower, reverse = True) PS : sorted()ä¹Ÿæ˜¯ä¸€ä¸ªé«˜é˜¶å‡½æ•°ã€‚ç”¨sorted()æŽ’åºçš„å…³é”®åœ¨äºŽå®žçŽ°ä¸€ä¸ªæ˜ å°„å‡½æ•° è¿”å›žå‡½æ•°ç®€å•çœ‹äº†ä¸‹è¿”å›žå‡½æ•°çš„å®šä¹‰ï¼Œé‡Œé¢æåˆ°äº†é—­åŒ…ï¼Œè¿™ä¸ªjsé‡Œé¢ä¹Ÿç»å¸¸æåˆ°çš„æ“ä½œã€‚ç®€å•è¯´ï¼Œé—­åŒ…å°±æ˜¯å‡½æ•°åµŒå¥—å‡½æ•°ï¼Œå†…éƒ¨çš„å‡½æ•°ä¿å­˜äº†å¤–å±‚å‡½æ•°çš„å˜é‡ç­‰å‚æ•°ï¼Œåœ¨å¤–éƒ¨å‡½æ•°è¢«é”€æ¯åŽï¼Œå†…éƒ¨å‡½æ•°ä¾æ—§å¯ä»¥æ‹¿åˆ°å¤–éƒ¨å‡½æ•°çš„ä¼ å‚ã€‚è¿™ä¸ªæ¦‚å¿µjså’ŒPythonæ²¡å¤§çš„åŒºåˆ«ã€‚æ·±å±‚æ¬¡ç†è§£çš„è¯ï¼Œå‚è€ƒå¦å¤–ä¸€ç¯‡åšå®¢ï¼š https://www.cnblogs.com/fanghl/p/11417906.html åŒ¿åå‡½æ•°å…³é”®å­—ï¼š lambdaåªèƒ½æœ‰ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œä¸ç”¨å†™returnï¼Œè¿”å›žå€¼å°±æ˜¯è¡¨è¾¾å¼çš„ç»“æžœ 1234list(map(lambda x: x * x, [1, 3, 5, 7] ))#lambda x: ç›¸å½“äºŽï¼šdef f(x): return x * x pythonçš„åŒ¿åå‡½æ•°å’Œjsçš„åŒ¿åå‡½æ•°ä¸å¤ªä¸€æ ·ï¼Œä½†ä½œç”¨å¤§éƒ½ç›¸ä¼¼ï¼Œä¸ç”¨æ‹…å¿ƒå‡½æ•°åå†²çªç­‰ç­‰ï¼Œç®€åŒ–å†™æ³•ç­‰ã€‚jsé‡Œé¢çš„åŒ¿åå‡½æ•°å·²ç»å‡çº§åˆ°äº†ES6ç®­å¤´å‡½æ•°æ¨¡å¼ï¼Œç®€å•æ–¹ä¾¿ï¼š 123456item =&gt; &#123; return item * item&#125;(x, y) =&gt; &#123; return x + y&#125; jsé‡Œé¢åŒ¿åå‡½æ•°ç”¨çš„è¾ƒå°‘ï¼Œä¸€èˆ¬éƒ½æ˜¯ç”¨äº†ç®­å¤´å‡½æ•°æ›¿ä»£äº†ã€‚åŒ¿åå‡½æ•°çš„ä½¿ç”¨åœºæ™¯æˆ‘ä¹Ÿæƒ³ä¸å‡ºå¤šå°‘ï¼Œä½†åœ¨å®šæ—¶å™¨ä¸­ä½¿ç”¨è¾ƒå¤šï¼š 1234567891011function test() &#123; setTimeout(function() &#123; console.log(1) &#125;, 1000 * 2)&#125;// ä¸è¿‡ä¸€èˆ¬éƒ½ç®­å¤´ç®€åŒ–äº†function test() &#123; setTimeout(() =&gt; &#123; console.log(1) &#125;, 1000 * 2)&#125; è£…é¥°å™¨ä»£ç è¿è¡ŒæœŸé—´åŠ¨æ€å¢žåŠ åŠŸèƒ½çš„æ–¹å¼ï¼Œç§°ä¹‹ä¸ºâ€œè£…é¥°å™¨â€ï¼ˆDecoratorï¼‰å‡½æ•°ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä¸”å‡½æ•°å¯¹è±¡å¯ä»¥è¢«èµ‹å€¼ç»™å˜é‡ï¼Œæ‰€ä»¥ï¼Œé€šè¿‡å˜é‡ä¹Ÿèƒ½è°ƒç”¨è¯¥å‡½æ•°name å‡½æ•°å¯¹è±¡çš„è¯¥å±žæ€§å¯ä»¥æ‹¿åˆ°å‡½æ•°çš„å®šä¹‰æ—¶åå­—æ²¡çœ‹æ‡‚ï¼Œç­‰æ‡‚äº†å†å›žæ¥å†™ åå‡½æ•°ä¸ªäººç†è§£åˆæ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼å‡å°‘ä¸€äº›å‡½æ•°çš„ç¹æ‚å†™æ³•å…³é”®æ¨¡å—ï¼šfunctools partial 123import functoolsint2 = functolls.partial(int, base = 2)# åˆ›é€ ä¸€ä¸ªåå‡½æ•°int2ï¼Œæ¥è¿›è¡Œ2è¿›åˆ¶çš„è½¬åŒ–ï¼Œbaseæ˜¯intå†…ç½®å‡½æ•°å›ºæœ‰çš„å‚æ•° æ¨¡å—æ¨¡å—æ˜¯ä¸€ç»„Pythonä»£ç çš„é›†åˆï¼Œå¯ä»¥ä½¿ç”¨å…¶ä»–æ¨¡å—ï¼Œä¹Ÿå¯ä»¥è¢«å…¶ä»–æ¨¡å—ä½¿ç”¨åˆ›å»ºè‡ªå·±çš„æ¨¡å—æ—¶ï¼Œè¦æ³¨æ„ï¼šæ¨¡å—åè¦éµå¾ªPythonå˜é‡å‘½åè§„èŒƒï¼Œä¸è¦ä½¿ç”¨ä¸­æ–‡ã€ç‰¹æ®Šå­—ç¬¦ï¼›æ¨¡å—åä¸è¦å’Œç³»ç»Ÿæ¨¡å—åå†²çªï¼Œæœ€å¥½å…ˆæŸ¥çœ‹ç³»ç»Ÿæ˜¯å¦å·²å­˜åœ¨è¯¥æ¨¡å—ï¼Œæ£€æŸ¥æ–¹æ³•æ˜¯åœ¨Pythonäº¤äº’çŽ¯å¢ƒæ‰§è¡Œimport abcï¼Œè‹¥æˆåŠŸåˆ™è¯´æ˜Žç³»ç»Ÿå­˜åœ¨æ­¤æ¨¡å— ä½œç”¨åŸŸ__xxx__ å˜é‡æ˜¯ç‰¹æ®Šå˜é‡ï¼Œå¯ä»¥è¢«ç›´æŽ¥å¼•ç”¨ï¼Œä½†æ˜¯æœ‰ç‰¹æ®Šç”¨é€”_xxxæˆ–__xxxè¿™æ ·çš„å‡½æ•°æˆ–è€…å˜é‡æ˜¯éžå…¬å¼€çš„ï¼ˆprivateï¼‰ï¼Œä¸åº”è¯¥è¢«ç›´æŽ¥å¼•ç”¨ ç¬¬ä¸‰æ–¹æ¨¡å—å®‰è£… pipï¼šå®‰è£…ç¬¬ä¸‰æ–¹æ¨¡å—å·¥å…·å®‰è£…å‘½ä»¤ï¼špip install xxx å‚ç…§ npm æˆ–è€… yarn åŒ…ç®¡ç†å·¥å…· å®‰è£…å¸¸ç”¨æ¨¡å— åœ¨ä½¿ç”¨Pythonæ—¶ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦ç”¨åˆ°å¾ˆå¤šç¬¬ä¸‰æ–¹åº“ï¼Œä¾‹å¦‚ï¼Œä¸Šé¢æåˆ°çš„Pillowï¼Œä»¥åŠMySQLé©±åŠ¨ç¨‹åºï¼ŒWebæ¡†æž¶Flaskï¼Œç§‘å­¦è®¡ç®—Numpyç­‰ã€‚ç”¨pipä¸€ä¸ªä¸€ä¸ªå®‰è£…è´¹æ—¶è´¹åŠ›ï¼Œè¿˜éœ€è¦è€ƒè™‘å…¼å®¹æ€§ã€‚æˆ‘ä»¬æŽ¨èç›´æŽ¥ä½¿ç”¨Anacondaï¼Œè¿™æ˜¯ä¸€ä¸ªåŸºäºŽPythonçš„æ•°æ®å¤„ç†å’Œç§‘å­¦è®¡ç®—å¹³å°ï¼Œå®ƒå·²ç»å†…ç½®äº†è®¸å¤šéžå¸¸æœ‰ç”¨çš„ç¬¬ä¸‰æ–¹åº“ï¼Œæˆ‘ä»¬è£…ä¸ŠAnacondaï¼Œå°±ç›¸å½“äºŽæŠŠæ•°åä¸ªç¬¬ä¸‰æ–¹æ¨¡å—è‡ªåŠ¨å®‰è£…å¥½äº†ï¼Œéžå¸¸ç®€å•æ˜“ç”¨ã€‚Anacondaå®˜ç½‘: https://www.anaconda.com/download/å›½å†…é•œåƒï¼š https://pan.baidu.com/s/1kU5OCOB#list/path=%2Fpub%2Fpython é¢å‘å¯¹è±¡ç¼–ç¨‹ OOPé¢å‘è¿‡ç¨‹å¤„ç†å­¦ç”Ÿçš„æˆç»©è¡¨ï¼Œä¸ºäº†è¡¨ç¤ºä¸€ä¸ªå­¦ç”Ÿçš„æˆç»©ï¼Œé¢å‘è¿‡ç¨‹çš„ç¨‹åºå¯ä»¥ç”¨ä¸€ä¸ªdictè¡¨ç¤º 12std1 = &#123;'name': 'bob', 'score': 95&#125;std1 = &#123;'name': 'ming', 'score': 59&#125; å¤„ç†å­¦ç”Ÿæˆç»©é€šè¿‡å‡½æ•°å®žçŽ°ï¼Œæ‰“å°å­¦ç”Ÿæˆç»©ï¼š 12def print_score(std): print('%s: %s' % (std['name'], std['score'])) é¢å‘è¿‡ç¨‹ï¼Œé¡¾åæ€ä¹‰ï¼Œå…³å¿ƒçš„æ˜¯ç¨‹åºä¸‹ä¸€æ­¥æ€Žä¹ˆèµ°ï¼Ÿè¿™ä¸ªè¿‡ç¨‹å¦‚ä½•ä¿æŒæ­£ç¡®çš„èµ°æ³•ã€‚è€Œé¢å‘å¯¹è±¡ï¼Œå³ä¸‡ç‰©çš†å¯¹è±¡ï¼Œæˆ‘ä»¬è¦è€ƒè™‘å­¦ç”Ÿè¿™ä¸ªå¯¹è±¡ï¼Œç„¶åŽç›´æŽ¥åˆ›å»ºè¿™ä¸ªå¯¹è±¡ï¼Œéœ€è¦ä»€ä¹ˆåŠŸèƒ½ç›´æŽ¥è°ƒç”¨è¿™ä¸ªå¯¹è±¡ä¸Šé¢çš„æ–¹æ³•å³å¯ï¼Œä¸ç”¨ç®¡è¿‡ç¨‹ï¼ é¢å‘å¯¹è±¡1234567891011121314class Student(object): def __init__(self, name, score): self.name = name self.score = score def print_score(self): print('%s: %s' % (self.name, self.score))xiaoming = Student('xiaoming', 95)xiaohong = Student('xiaohong', 59)xiaoming.print_score()xiaohong.print_score() å¥¥ï¼Œè¯­è¨€éƒ½æ˜¯ç›¸é€šçš„ï¼ŒJavaScriptçš„classå’ŒPythonæ€è·¯éƒ½æ˜¯ä¸€æ¯›ä¸€æ ·å•Šï¼Œä¸è¿‡jsä¸­classè¿˜æœ‰ç»§æ‰¿ã€super()ã€constructor()ç­‰ç­‰ï¼ŒPythonåº”è¯¥ä¹Ÿæœ‰çš„ï¼Œå¾€ä¸‹ç»§ç»­å­¦ä¹ ã€‚PS : jsä¸­å®šä¹‰çš„Classï¼Œåˆ›å»ºå®žä¾‹éœ€è¦ new å…³é”®å­— ç±»å’Œå®žä¾‹ åˆ›å»ºç±»class + className + (ç»§æ‰¿è‡ªæŸä¸ªç±») 12class Students(object): def __init__(self, xxx, xx1, xx2): 1234567891011121314class Student extends Person&#123; //jså®žçŽ° super() //ç»§æ‰¿åŸºç±»çš„å±žæ€§ constructor(name, age) &#123; //è‡ªå·±çš„å±žæ€§ this.speed = 30 this.name = name this.age = age &#125; otherMethods() &#123; //æŒ‚è½½åˆ°Studentçš„åŽŸåž‹é“¾ä¸Š doSth... &#125;, otherMethods1() &#123; //æŒ‚è½½åˆ°Studentçš„åŽŸåž‹é“¾ä¸Š doOther... &#125;&#125; åˆ›å»ºå®žä¾‹12# pyxiaoming = Student(arg) 12// jsconst xioaming = new Student(arg) çœ‹åˆ°è¿™ï¼Œç»ˆäºŽæ·±åˆ»ä½“ä¼šåˆ°äº†ä¸ºå•¥classä¸€å®šè¦é¦–å­—æ¯å¤§å†™ï¼jsé‡Œé¢å¯èƒ½ä½“ä¼šä¸æ·±ï¼Œå› ä¸ºæœ‰ new å…³é”®å­—åœ¨classä¹‹å‰ï¼Œè€Œpyé‡Œé¢ï¼Œå¦‚æžœä¸åŒºåˆ†ï¼Œé‚£ä¹ˆå¾ˆå®¹æ˜“æžæ··class å’Œ function ç‰¹æ®Šæ–¹æ³•__init__ æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ°¸è¿œæ˜¯selfï¼Œè¡¨ç¤ºåˆ›å»ºçš„å®žä¾‹æœ¬èº«ï¼Œå› æ­¤ï¼Œåœ¨initæ–¹æ³•å†…éƒ¨ï¼Œå°±å¯ä»¥æŠŠå„ç§å±žæ€§ç»‘å®šåˆ°selfï¼Œå› ä¸ºselfå°±æŒ‡å‘åˆ›å»ºçš„å®žä¾‹æœ¬èº«ã€‚diff:å’Œæ™®é€šçš„å‡½æ•°ç›¸æ¯”ï¼Œåœ¨ç±»ä¸­å®šä¹‰çš„å‡½æ•°åªæœ‰ä¸€ç‚¹ä¸åŒï¼Œå°±æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°æ°¸è¿œæ˜¯å®žä¾‹å˜é‡selfï¼Œå¹¶ä¸”ï¼Œè°ƒç”¨æ—¶ï¼Œä¸ç”¨ä¼ é€’è¯¥å‚æ•°ã€‚ è®¿é—®é™åˆ¶å¤–éƒ¨ä»£ç è¿˜æ˜¯å¯ä»¥è‡ªç”±åœ°ä¿®æ”¹ä¸€ä¸ªå®žä¾‹çš„nameã€scoreå±žæ€§ï¼š 12xiaoming = Student('xiaoming', 95)xioaming.score = 12 #å¯ä»¥ä¿®æ”¹å®žä¾‹çš„å±žæ€§ å¤§æ‹›æ¥äº†ï¼ï¼ï¼å¦‚æžœè¦è®©å†…éƒ¨å±žæ€§ä¸è¢«å¤–éƒ¨è®¿é—®ï¼Œå¯ä»¥æŠŠå±žæ€§çš„åç§°å‰åŠ ä¸Šä¸¤ä¸ªä¸‹åˆ’çº¿__è¿™ä¸ªå¤§æ‹›jsé‡Œé¢å¯æ²¡æœ‰å•Šåœ¨Pythonä¸­ï¼Œå®žä¾‹çš„å˜é‡åå¦‚æžœä»¥__å¼€å¤´ï¼Œå°±å˜æˆäº†ä¸€ä¸ªç§æœ‰å˜é‡ï¼ˆprivateï¼‰ï¼Œåªæœ‰å†…éƒ¨å¯ä»¥è®¿é—®ï¼Œå¤–éƒ¨ä¸èƒ½è®¿é—® 1234class Student(object): __init__(self, name, age): self.__name = name self__age = age è¿™æ ·åœ¨å¤–éƒ¨å°±æ— æ³•è®¿é—®åˆ°å†…éƒ¨çš„ç§æœ‰å˜é‡äº†ï¼Œåªèƒ½è°ƒç”¨å†…éƒ¨æ–¹æ³•æ¥è®¿é—®ã€‚Â·Â·Â·Â·Â·~çœŸçš„æ˜¯è¿™æ ·çš„å—ï¼Ÿï¼ˆæ‰‹åŠ¨æ»‘ç¨½.jpgï¼‰,å½“ç„¶ä¸æ˜¯å•¦ï¼Œä¹‹æ‰€æœ‰æˆ‘ä»¬æ— æ³•ä»Žå¤–éƒ¨è®¿é—®åˆ°name,æ˜¯å› ä¸ºPythonè§£é‡Šå™¨æŠŠè¯¥å˜é‡å˜æˆäº† _Studentname ,æ‰€ä»¥å‘¢ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ çŸ­çº¿ åŠ  ç±»å åŠ å˜é‡åç»§ç»­æ¥è®¿é—®è¯¥ç§æœ‰å˜é‡åƒé¥±äº†æ’‘ç€äº†å—ï¼Ÿå“ˆå“ˆ ç»§æ‰¿å’Œå¤šæ€æœ‰ç‚¹C++çš„æ„Ÿè§‰äº†ï¼Œæ¯•ç«Ÿjsæ˜¯æ²¡æœ‰æ˜¾ç¤ºçš„å¤šæ€çš„~ ç­‰ç­‰ï¼Œæˆ‘ç†è§£å®Œäº†ï¼Œå‡‰å‡‰æ‰“è„¸ã€‚Pythonçš„å¤šæ€æŒ‡çš„æ˜¯åŸºç±»å’Œå­ç±»æ‹¥æœ‰åŒæ ·çš„æ–¹æ³•æ—¶ï¼Œå­ç±»è¦†ç›–åŸºç±»â€¦â€¦â€¦â€¦â€¦â€¦emmmmï¼ŒæŒ‰ç…§jsæ¥è¯´ï¼Œè¿™å°±æ˜¯åŽŸåž‹é“¾çš„æŸ¥æ‰¾åŸºæœ¬åŽŸç†å•Šï¼Œå…ˆåœ¨è‡ªå·±å†…éƒ¨æ‰¾ï¼Œæ‰¾ä¸åˆ°äº†å°±é¡ºç€åŽŸåž‹é“¾å¾€ä¸ŠæŸ¥æ‰¾ï¼Œä¸€æ¯›ä¸€æ ·çš„â€¦â€¦â€¦.æŠŠpyä¸­çš„classç†è§£ä¸ºä¸€ç§æ•°æ®ç»“æž„ï¼Œè¿™ä¸ªæ•°æ®ç»“æž„å’Œpyè‡ªå¸¦çš„list,tuple,dict æ²¡æœ‰ä»»ä½•åŒºåˆ«ã€‚é‚£ä¹ˆ isinstance() ä¸å°±å¯ä»¥ç”¨äº† 12345678xiaoming = Student('xiaoming')isinstance(xiaoming, Student) # True isinstanceå¯ä»¥ç†è§£ä¸ºæ´¾ç”Ÿclass Pupil(Student): passxiaoxioa = Pupil()isinstance(xiaoxiao, Student) # True éš”ä»£çš„ä¹Ÿç®—æ´¾ç”Ÿå“¦ é¸­å­æ¨¡åž‹ åŠ¨æ€è¯­è¨€çš„é¸­å­ç±»åž‹ç‰¹ç‚¹å†³å®šäº†ç»§æ‰¿ä¸åƒé™æ€è¯­è¨€é‚£æ ·æ˜¯å¿…é¡»çš„ã€‚ èŽ·å–å¯¹è±¡ä¿¡æ¯ type()åˆ¤æ–­å¯¹è±¡ç±»åž‹ï¼Œjsä¸­ä½¿ç”¨ typeof() , jsåˆ¤æ–­å­—ç¬¦ä¸²è¿˜å¯ä»¥æ›´ä¸ºå‡†ç¡®çš„ä½¿ç”¨Object.prototype.toString().call()é¢˜å¤–è¯äº†ï¼Œjsçš„typeåˆ¤æ–­åŸºæœ¬ç±»åž‹å¥½ç”¨ï¼Œå…¶ä»–å°±è¿˜æ˜¯ç”¨ instanceofï¼ˆï¼‰è¿™ç‚¹ä¸Šï¼ŒJSå’Œpyè¿˜æ˜¯é«˜åº¦ç›¸ä¼¼çš„ï¼ï¼type() ===== typeof() ===== åŸºæœ¬ç±»åž‹isinstance() ==== instanceof() ===== åˆ¤æ–­å¯¹è±¡ dir()è¦èŽ·å¾—ä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰å±žæ€§å’Œæ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨dir()å‡½æ•°ï¼Œå®ƒè¿”å›žä¸€ä¸ªåŒ…å«å­—ç¬¦ä¸²çš„listï¼Œæ¯”å¦‚ï¼ŒèŽ·å¾—ä¸€ä¸ªstrå¯¹è±¡çš„æ‰€æœ‰å±žæ€§å’Œæ–¹æ³•ä»…ä»…æŠŠå±žæ€§å’Œæ–¹æ³•åˆ—å‡ºæ¥æ˜¯ä¸å¤Ÿçš„ï¼Œé…åˆgetattr()ã€setattr()ä»¥åŠhasattr()ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æŽ¥æ“ä½œä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€, jsä¸­åŒç†ã€‚setAttribute()ã€getAttribute()ã€hasAttribute() å®žä¾‹å±žæ€§å’Œç±»å±žæ€§æ€»ç»“ä¸€å¥è¯ï¼Œå°±æ˜¯classçš„ç±»å±žæ€§å„ä¸ªå®žä¾‹éƒ½ä¼šè®¿é—®åˆ°ï¼Œå®žä¾‹çš„å®žä¾‹å±žæ€§å„è‡ªç›¸äº’ç‹¬ç«‹ã€‚å¯ä»¥æŠŠè¿™ä¸¤ä¸ªæ¦‚å¿µç†è§£ä¸º JS åŸºç±»ä¸­çš„æ–¹æ³•ï¼Œå­ç±»éƒ½ä¼šé¡ºç€åŽŸåž‹é“¾æ‰¾åˆ°å¹¶è®¿é—®åˆ°ã€‚ 12class Student(object): school = 'hantaiMiddleSchool' #æ‰€æœ‰å®žä¾‹éƒ½å¯ä»¥è®¿é—®åˆ° é¢å‘å¯¹è±¡é«˜çº§ç¼–ç¨‹__slots__slotsçš„ä½œç”¨å°±æ˜¯åŠ¨æ€ç»™classæ·»åŠ å±žæ€§çš„ä¸€ä¸ªçº¦æŸï¼Œå¦åˆ™åœ¨classç±»å»ºç«‹å®Œæ¯•åŽï¼Œè¿è¡Œä»£ç çš„æ—¶å€™åŠ¨æ€éšæ„ç»‘å®šå±žæ€§ä¸å°±ä¹±å¥—äº†ï¼Œéœ€è¦ä¸€ä¸ªçº¦æŸï¼ŒèŒè´£å°±æ˜¯ slotsslots è‹±æ–‡ï¼š æ’æ§½ã€‚åœ¨Vueä¸­ä½¿ç”¨çš„å¹¿æ³›ï¼Œå¯ä»¥ç†è§£ä¸ºåœ¨è¿™é¢„å…ˆç»™ä½ ç•™äº†ä¸ªä½ç½®ï¼Œä»¥åŽæƒ³ç”¨çš„æ—¶å€™å¯ä»¥ç”¨ï¼Œæ²¡æœ‰ç•™è¿™ä¸ªä½ç½®çš„è¯ï¼Œä»¥åŽç›¸ç”¨éƒ½ç”¨ä¸äº†ï¼Œå¯ä»¥ç†è§£ä¸ºå›¾ä¹¦é¦†åŒå­¦å¸®ä½ å åº§ 1234567#pythonclass Student(object): __slots__ = ('name', 'age')&gt;&gt;&gt; s = Student()&gt;&gt;&gt; s.name = 'xiaoming' # å¯ä»¥ç»‘å®šæˆåŠŸ&gt;&gt;&gt; s.score = 98 # ä¼šæŠ¥é”™ï¼Œâ€œå”‰ï¼Œè¿™ä½ç½®æœ‰äººäº†ï¼Œä½ åä¸äº†ï¼ˆæ‰‹åŠ¨æ»‘ç¨½.jpgï¼‰â€ PS : ä½¿ç”¨slotsè¦æ³¨æ„ï¼Œslotså®šä¹‰çš„å±žæ€§ä»…å¯¹å½“å‰ç±»å®žä¾‹èµ·ä½œç”¨ï¼Œå¯¹ç»§æ‰¿çš„å­ç±»æ˜¯ä¸èµ·ä½œç”¨ @propertyè§£å†³é—®é¢˜å‰è¨€ï¼šç»™Classç»‘å®šå±žæ€§æ—¶ï¼Œç›´æŽ¥æŠŠå±žæ€§æš´éœ²å‡ºåŽ»ï¼Œå†™èµ·æ¥ç®€å•ï¼Œè°ƒç”¨èµ·æ¥ç®€å•ï¼Œä½†æ˜¯æ²¡åŠžæ³•æ£€æŸ¥å‚æ•°ï¼Œå¯¼è‡´å¯ä»¥éšä¾¿ä¿®æ”¹å€¼ã€‚è¿™ä¸åˆç†è§£å†³1ï¼š 123456789101112131415#Python#Pythonè®¾ç½®setã€getæ–¹æ³•æ¥æŽ§åˆ¶å±žæ€§è§£å†³éªŒè¯é—®é¢˜class Student(onject): def get_score(self): return self.score def set_scsoe(self, value): if not isinstance(value, int): raise ValueError('score must be int') if value &lt; 0 or value &gt; 100: raise ValueError('score must be 0-100') self.score = value ä½†æ˜¯ï¼Œä¸Šé¢çš„è°ƒç”¨æ–¹æ³•åˆç•¥æ˜¾å¤æ‚ï¼Œæ²¡æœ‰ç›´æŽ¥ç”¨å±žæ€§è¿™ä¹ˆç›´æŽ¥ç®€å•æœ‰æ²¡æœ‰æ—¢èƒ½æ£€æŸ¥å‚æ•°ï¼Œåˆå¯ä»¥ç”¨ç±»ä¼¼å±žæ€§è¿™æ ·ç®€å•çš„æ–¹å¼æ¥è®¿é—®ç±»çš„å˜é‡å‘¢ï¼Ÿå¯¹äºŽè¿½æ±‚å®Œç¾Žçš„Pythonç¨‹åºå‘˜æ¥è¯´ï¼Œè¿™æ˜¯å¿…é¡»è¦åšåˆ°çš„ï¼è¿˜è®°å¾—è£…é¥°å™¨ï¼ˆdecoratorï¼‰å¯ä»¥ç»™å‡½æ•°åŠ¨æ€åŠ ä¸ŠåŠŸèƒ½å—ï¼Ÿå¯¹äºŽç±»çš„æ–¹æ³•ï¼Œè£…é¥°å™¨ä¸€æ ·èµ·ä½œç”¨ã€‚Pythonå†…ç½®çš„@propertyè£…é¥°å™¨å°±æ˜¯è´Ÿè´£æŠŠä¸€ä¸ªæ–¹æ³•å˜æˆå±žæ€§è°ƒç”¨çš„ï¼šæ€»ç»“èµ·æ¥ï¼šè¯­æ³•ç³–ï¼Œæœ¬è´¨æ²¡å˜ï¼Œä½†æ˜¯ç®€åŒ–äº†è°ƒç”¨çš„ç¹çç¨‹åº¦ 12345678910111213141516171819class Student(object): @property def score(self): return self.score @score.setter # å¯è¯»å¯å†™å±žæ€§ def score(self, valule): if not isinstance(value, int): raise ValueError('score must be int') if value &lt; 0 or value &gt; 100: raise ValueError('score must be 0-100') self.score = value @property #åªè¯»å±žæ€§ def age(self): return 23#è¿™æ ·ï¼Œå°±ä¾æ—§å¯ä»¥ä½¿ç”¨å±žæ€§çš„.è°ƒç”¨æ–¹æ³•è®¿é—®å±žæ€§ã€è®¾ç½®å±žæ€§å€¼äº† æ€»ç»“ï¼š@propertyå¹¿æ³›åº”ç”¨åœ¨ç±»çš„å®šä¹‰ä¸­ï¼Œå¯ä»¥è®©è°ƒç”¨è€…å†™å‡ºç®€çŸ­çš„ä»£ç ï¼ŒåŒæ—¶ä¿è¯å¯¹å‚æ•°è¿›è¡Œå¿…è¦çš„æ£€æŸ¥ï¼Œè¿™æ ·ï¼Œç¨‹åºè¿è¡Œæ—¶å°±å‡å°‘äº†å‡ºé”™çš„å¯èƒ½æ€§ å¤šé‡ç»§æ‰¿å…³é”®å­—ï¼šä¸€ä¸ªå­ç±»å¯ä»¥æ‹¥æœ‰å¤šä¸ªåŸºç±»ã€mixinclasséœ€è¦æ–°çš„åŠŸèƒ½ï¼Œåªéœ€è¦åœ¨ç»§æ‰¿ä¸€ä¸ªåŸºç±»å°±å¯ä»¥äº†ï¼Œé€šå¸¸ï¼Œä¸»çº¿éƒ½æ˜¯å•ä¸€ç»§æ‰¿ä¸‹æ¥çš„ * ä¸ºäº†æ›´å¥½åœ°çœ‹å‡ºç»§æ‰¿å…³ç³»ï¼Œæˆ‘ä»¬æŠŠä¸»çº¿ä¹‹å¤–éœ€è¦ç»§æ‰¿çš„åŸºç±»å‘½åä¸º Mixinï¼Œè¿™æ ·çš„çš„è®¾è®¡é€šå¸¸ç§°ä¸º *Mixin 12345678class Person(object): passclass ChineseMixin(Person): passclass ChinaPuple(Person, ChineseMixin): pass å®šåˆ¶ç±»é‡ç‚¹ï¼šå‰åŽåŒä¸‹åˆ’çº¿çš„å˜é‡æ˜¯ç‰¹æ®Šå˜é‡ï¼Œpyæœ‰ç‰¹æ®Šç”¨é€”çš„ï¼ï¼__slots____len__()__str____repr____iter____getitem____setitem____getattr____call__ä¸Šé¢ç½—åˆ—çš„æ–¹æ³•æœªæŸ¥çœ‹ç›¸å…³ä½œç”¨ï¼Œä»¥åŽéœ€è¦ç”¨åˆ°åœ¨æŸ¥çœ‹ä¸è¿Ÿï¼Œå°±æœ€åŽä¸€ä¸ª __call__ ,åœ¨js ä¸­è°ƒç”¨è‡ªèº«çš„æœ‰ arguments.callee() æžšä¸¾ç±»â€¦æŒç»­æ›´æ–°â€¦â€¦.]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Programming</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å°ç¨‹åºé¡¹ç›®è‡ªæˆ‘æ€»ç»“]]></title>
    <url>%2F2019%2F08%2F22%2Fsummary201907%2F</url>
    <content type="text"><![CDATA[åºè¨€å°ç¨‹åºï¼š ç›¸äº²å°çº¢åœˆ+toolï¼š wepy ä¼ é€é—¨ï¼š[ wepy ] https://tencent.github.io/wepy/document.html#/[ Vue ] https://cn.vuejs.org/[ ES6 ] http://es6.ruanyifeng.com/[ git ] https://www.liaoxuefeng.com/ ä¸ƒæœˆä»½ç»“æŸï¼Œé¡¹ç›®ä¸Šçº¿ï¼Œå›žè¿‡å¤´æ¥æ•´ç†ä¸€ä¸‹é¡¹ç›®ï¼Œé¡¹ç›®ä¸ºwepy1.7.0åŽç‰ˆæœ¬å¼€å‘çš„å°ç¨‹åºï¼Œé…å¥—çš„åŽå°å‰ç«¯ä½¿ç”¨ant-design-vueå¼€å‘ï¼Œä¸Šä¼ æµ‹è¯•æœå·¥å…·ä½¿ç”¨Xshell6ã€‚ å†…å®¹ wepyæž„å»ºå·¥ç¨‹å…·ä½“å¯åœ¨wepyå®˜ç½‘ä¸­æŸ¥çœ‹ï¼Œæ­¤å¤„ä¸å¤šä»‹ç»ã€‚ 1234$ wepy init standard my-project /**åˆ›å»ºé¡¹ç›®*/$ cd my-project /*è¿›å…¥é¡¹ç›®ç›®å½•*/$ npm install /**å®‰è£…ä¾èµ–*/$ wepy build --watch /*è¿è¡Œå·¥ç¨‹å¹¶ç›‘æŽ§é¡¹ç›®ä¿®æ”¹è‡ªåŠ¨åˆ·æ–°*/ wepyå±žäºŽç±»Vueå†™æ³•ï¼Œè¦åœ¨wepyä¸­ä½¿ç”¨å¼‚æ­¥æ“ä½œï¼ˆasync/awaitï¼‰éœ€è¦åœ¨å·¥ç¨‹çš„app.wayå…¥å£æ–‡ä»¶ä¸­constructorå‡½æ•°ä¸­æ³¨å†Œ: 12345constructor () &#123; super() this.use('requestfix') this.use('promisify') /*â†æ‰‹åŠ¨æ·»åŠ è¿™ä¸ª*/&#125; ç”Ÿå‘½å‘¨æœŸ:åº”ç”¨ç”Ÿå‘½å‘¨æœŸ å±žæ€§ type æè¿° è§¦å‘æ—¶æœº onLaunch Function ç”Ÿå‘½å‘¨æœŸå‡½æ•°â€“ç›‘å¬å°ç¨‹åºåˆå§‹åŒ– ç”¨æˆ·é¦–æ¬¡æ‰“å¼€å°ç¨‹åºï¼Œè§¦å‘ onLaunchï¼ˆå…¨å±€åªè§¦å‘ä¸€æ¬¡ï¼‰ onShow Function ç”Ÿå‘½å‘¨æœŸå‡½æ•°â€“ç›‘å¬å°ç¨‹åºæ˜¾ç¤º å½“å°ç¨‹åºå¯åŠ¨ï¼Œæˆ–ä»ŽåŽå°è¿›å…¥å‰å°æ˜¾ç¤ºï¼Œä¼šè§¦å‘ onShow onHide Function ç”Ÿå‘½å‘¨æœŸå‡½æ•°â€“ç›‘å¬å°ç¨‹åºéšè— å½“å°ç¨‹åºä»Žå‰å°è¿›å…¥åŽå°ï¼Œä¼šè§¦å‘ onHide é¡µé¢ç”Ÿå‘½å‘¨æœŸ å±žæ€§ type æè¿° è§¦å‘æ—¶æœº onLoad Function ç›‘å¬é¡µé¢åŠ è½½ï¼Œä¸€ä¸ªé¡µé¢åªä¼šè°ƒç”¨ä¸€æ¬¡ å°ç¨‹åºæ³¨å†Œå®ŒæˆåŽï¼ŒåŠ è½½é¡µé¢ï¼Œè§¦å‘onLoadæ–¹æ³•,å‚æ•°å¯ä»¥èŽ·å–wx.navigateToå’Œwx.redirectToåŠä¸­çš„ queryå‚æ•° onReady Function ç›‘å¬é¡µé¢åˆæ¬¡æ¸²æŸ“å®Œæˆ,ä»£è¡¨é¡µé¢å·²ç»å‡†å¤‡å¦¥å½“ï¼Œå¯ä»¥å’Œè§†å›¾å±‚è¿›è¡Œäº¤äº’ é¦–æ¬¡æ˜¾ç¤ºé¡µé¢ï¼Œä¼šè§¦å‘onReadyæ–¹æ³•ï¼Œæ¸²æŸ“é¡µé¢å…ƒç´ å’Œæ ·å¼ï¼Œä¸€ä¸ªé¡µé¢åªä¼šè°ƒç”¨ä¸€æ¬¡ onShow Function ç›‘å¬é¡µé¢æ˜¾ç¤º,å½“redirectToæˆ–navigateBackçš„æ—¶å€™è°ƒç”¨ å½“å°ç¨‹åºæœ‰åŽå°è¿›å…¥åˆ°å‰å°è¿è¡Œæˆ–é‡æ–°è¿›å…¥é¡µé¢æ—¶ï¼Œè§¦å‘onShowæ–¹æ³•ã€‚ onHide Function ç›‘å¬é¡µé¢éšè—,å½“navigateToæˆ–åº•éƒ¨tabåˆ‡æ¢æ—¶è°ƒç”¨ å½“å°ç¨‹åºåŽå°è¿è¡Œæˆ–è·³è½¬åˆ°å…¶ä»–é¡µé¢æ—¶ï¼Œè§¦å‘onHideæ–¹æ³• onUnload Function ç›‘å¬é¡µé¢å¸è½½ å½“ä½¿ç”¨é‡å®šå‘æ–¹æ³•wx.redirectTo(OBJECT)æˆ–å…³é—­å½“å‰é¡µè¿”å›žä¸Šä¸€é¡µwx.navigateBack()ï¼Œè§¦å‘onUnloadã€‚ ç‰ˆæœ¬æ›´æ–°ç‰ˆæœ¬æ›´æ–°ä»£ç ï¼Œä¸€èˆ¬è¾ƒä¸ºå›ºå®šï¼Œç›´æŽ¥å¤åˆ¶åœ¨ onLaunch ç”Ÿå‘½å‘¨æœŸå†… 123456789101112131415161718192021222324if(wx.canIUse('getUpdateManager'))&#123; const updateManager = wx.getUpdateManager(); updateManager.onCheckForUpdate((res) =&gt; &#123; if(res.hasUpdate)&#123; updateManager.onUpdateReady((res) =&gt; &#123; wx.showModal(&#123; title: 'æ›´æ–°æç¤º', content: 'æ–°ç‰ˆæœ¬å·²ç»å‡†å¤‡å¥½ï¼Œæ˜¯å¦é‡å¯åº”ç”¨ï¼Ÿ', success: function (res) &#123; if(res.confirm)&#123; updateManager.applyUpdate() &#125; &#125; &#125;) &#125;) updateManager.onUpdateFailed(function () &#123; wx.showModal(&#123; title: 'å·²ç»æœ‰æ–°ç‰ˆæœ¬äº†å“Ÿ~', content: 'æ–°ç‰ˆæœ¬å·²ç»ä¸Šçº¿å•¦~ï¼Œè¯·æ‚¨åˆ é™¤å½“å‰å°ç¨‹åºï¼Œé‡æ–°æœç´¢æ‰“å¼€å“Ÿ~' &#125;) &#125;) &#125; &#125;)&#125; ç»„ä»¶ç»„ä»¶å¤ç”¨è¯´æ˜Žï¼š ç»„ä»¶å¤ç”¨ï¼Œåœ¨ åŒä¸€ä¸ªé¡µé¢ï¼Œä¸€ä¸ªç»„ä»¶å¤šæ¬¡å¤ç”¨ä¸”æ¯æ¬¡ä¼ å…¥ä¸åŒçš„æ•°æ®æºï¼Œä½†æ˜¯è¡¨çŽ°å‡ºæ¥çš„æ•°æ®æºå…¨éƒ¨ä¸€è‡´ï¼Œå…¶ä»–çš„æ•°æ®å¹¶æ²¡æœ‰æ¸²æŸ“ä¸ŠåŽŸå› ï¼š ç»„ä»¶åä¸€è‡´å¯¼è‡´wepyè®¤ä¸ºæ˜¯ä¸€æ¨¡ä¸€æ ·çš„ç»„ä»¶ï¼Œå¦‚æ­¤æ•°æ®æºä¹Ÿä¸ä¼šå˜åŠ¨è§£å†³ï¼š ç»„ä»¶å¼‚ååŒ– 123456import CompA from &apos;path&apos;components = &#123; CompB: CompA, CompC: CompA,&#125; è¿™æ ·ï¼Œæ—¢å¯ä»¥é‡å¤è¿ç”¨ç»„ä»¶ æ–‡å­—æ¢è¡Œå°ç¨‹åºæ–‡å­—æ¢è¡Œï¼š 1&lt;text&gt;ç¬¬ä¸€è¡Œ\nç¬¬äºŒè¡Œ\nç¬¬ä¸‰è¡Œ\n&lt;/text&gt; å®šæ—¶å™¨ é¡µé¢ä¸šåŠ¡é€»è¾‘æœ‰éœ€è¦ç”¨åˆ°å€’è®¡æ—¶åŠŸèƒ½ï¼Œå¦‚ä¸‹å›¾ã€‚ åœ¨é¡µé¢ä¸­æœ‰éœ€è¦ç”¨åˆ°å€’è®¡æ—¶æˆ–è€…å…¶ä»–å®šæ—¶å™¨ä»»åŠ¡æ—¶ï¼Œæ–°å»ºçš„å®šæ—¶å™¨åœ¨å¸è½½é¡µé¢æ—¶ä¸€å®šè¦æ¸…é™¤æŽ‰ï¼Œæœ‰æ—¶å€™é¡µé¢å¯èƒ½ä¸æ­¢ä¸€ä¸ªå®šæ—¶å™¨éœ€æ±‚ï¼Œåœ¨å¸è½½é¡µé¢ï¼ˆonUnloadé’©å­å‡½æ•°ï¼‰çš„æ—¶å€™ä¸€å®šè¦æ¸…é™¤æŽ‰å½“å‰ä¸ç”¨çš„å®šæ—¶å™¨å®šæ—¶å™¨ç”¨æ¥åšå€’è®¡æ—¶æ•ˆæžœä¹Ÿä¸é”™ï¼Œåˆå§‹æ—¶é—´åŽå°èŽ·å–ï¼Œå‰ç«¯å¤„ç†ï¼ŒåŽå°ç›´æŽ¥åœ¨æ•°æ®åº“æŸ¥è¯¢æ‹¿åˆ°çš„æ ‡å‡†æ—¶é—´ï¼ˆæ•°æ®åº“åŽŸå§‹æ—¶é—´ï¼ŒTåˆ†å‰²ï¼‰ï¼Œå‰ç«¯éœ€è¦æ­£åˆ™å¤„ç†ä¸€ä¸‹è¿™ä¸ªæ—¶é—´ï¼š 123456let overTimeStr = data.over_time.split('T')let time1 = overTimeStr[0].replace(/-/g,",")let time2 = overTimeStr[1].replace(/:/g,',')let overTime = time1+ ',' + time2let overTimeArr = overTime.split(',')this.countDownCtrl( overTimeArr, 0 ); æœ€ç»ˆæŠŠæ—¶é—´åˆ†å‰²ä¸º[å¹´ï¼Œæœˆï¼Œ æ—¥ï¼Œ æ—¶ï¼Œ åˆ†ï¼Œ ç§’]çš„æ•°ç»„ï¼Œï¼ˆå¦‚æžœåŽç«¯å·²ç»æŠŠæ—¶é—´å¤„ç†è¿‡äº†é‚£å°±æ›´å¥½äº†ï¼‰ï¼Œç„¶åŽæŠŠè¯¥æ•°ç»„ä¼ é€’ç»™å€’è®¡æ—¶å‡½æ•° 123456789101112131415161718192021222324252627282930313233countDownCtrl( time, group ) &#123; let deadline = new Date()//å…è´¹æˆªæ­¢æ—¶é—´ï¼Œæœˆçš„ä¸‹ä»Ž0å¼€å§‹ deadline.setFullYear(time[0], time[1]-1, time[2]) deadline.setHours(time[3], time[4], time[5]) let curTimeJudge = new Date().getTime() let timeJudge = deadline.getTime()-curTimeJudge let remainTimeJudge = parseInt(timeJudge/1000) if( remainTimeJudge &lt; 0) &#123; log('å€’è®¡æ—¶å·²ç»è¿‡æœŸ') return; &#125; this.interva1 = setInterval(() =&gt; &#123; let curTime = new Date().getTime() let time = deadline.getTime()-curTime //å‰©ä½™æ¯«ç§’æ•° let remainTime = parseInt(time/1000) //æ€»çš„å‰©ä½™æ—¶é—´,ä»¥ç§’è®¡ let day = parseInt( remainTime/(24*3600) )//å‰©ä½™å¤© let hour = parseInt( (remainTime-day*24*3600)/3600 )//å‰©ä½™å°æ—¶ let minute = parseInt((remainTime-day*24*3600-hour*3600)/60)//å‰©ä½™åˆ†é’Ÿ let sec = parseInt(remainTime%60)//å‰©ä½™ç§’ hour = hour &lt; 10 ? '0' + hour : hour; minute = minute &lt; 10 ? '0' + minute : minute sec = sec &lt; 10 ? '0' + sec : sec let countDownText = hour+ ":" +minute+ ":" +sec if( group === 0) &#123; //ä¸ªäººä¸šåŠ¡é€»è¾‘ï¼Œå› ä¸ºä¸€ä¸ªé¡µé¢æœ‰ä¸¤ä¸ªå€’è®¡æ—¶éœ€æ±‚ï¼Œä»£ç å¤ç”¨åŒºåˆ† this.countDown = countDownText; &#125; else if( group === 1 ) &#123; this.countDownGroup = countDownText &#125; this.$apply() &#125;, 1000 ); &#125; è‡³æ­¤ï¼Œå€’è®¡æ—¶æ•ˆæžœå¤„ç†å®Œæ¯•ï¼ŒPSï¼šç»ˆæ­¢æ—¶é—´ä¸€å®šè¦å¤§äºŽcurrentDateï¼Œå¦åˆ™æ˜¾ç¤ºä¼šå‡ºçŽ°å¼‚å¸¸ï¼ˆåŒ…æ‹¬ä½†ä¸é™äºŽå€’è®¡æ—¶é—ªçƒã€ä¹±ç ç­‰ï¼‰ æœ€åŽï¼Œé€€å‡ºè¯¥é¡µé¢åŽ»å…¶ä»–é¡µé¢æ—¶ï¼Œä¸€å®šè¦åœ¨é¡µç å¸è½½é’©å­ä¸­æ¸…é™¤å€’è®¡æ—¶ï¼ï¼ï¼ 123onUnload() &#123; clearInterval(this.interva1);&#125; ç»„ä»¶ä¼ å€¼ç»„ä»¶ä¼ å€¼å’ŒVueæœ‰ç‚¹ç»†å¾®åŒºåˆ«ï¼ŒVueå¼ºè°ƒçˆ¶ç»„ä»¶çš„æ•°ç»„å’Œå¯¹è±¡ä¸è¦ç›´æŽ¥ä¼ åˆ°å­ç»„ä»¶ä½¿ç”¨ï¼Œåº”ä¸ºå­ç»„ä»¶å¯èƒ½ä¼šä¿®æ”¹è¿™ä¸ªdataï¼Œå¦‚å›¾ï¼š ä½†æ˜¯ï¼Œwepyä¸­ï¼Œæœ‰æ—¶å€™ç¡®å®žéœ€è¦æŠŠä¸€ä¸ªå¯¹è±¡ä¼ é€’åˆ°å­ç»„ä»¶ä½¿ç”¨ï¼Œå•ä¸ªä¼ é€’å¯¹è±¡å±žæ€§è¿‡äºŽç¹çï¼Œè€Œä¸”ï¼ï¼ï¼å¦‚æžœå•ä¸ªä¼ é€’å¯¹è±¡çš„å±žæ€§åˆ°å­ç»„ä»¶ï¼Œå¦‚æžœè¯¥å±žæ€§æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œåˆ™å­ç»„ä»¶æ°¸è¿œä¼šæŽ¥æ”¶åˆ° undefined ã€‚æ­¤æ—¶æœ€å¥½ç”¨æ•´ä¸ªå¯¹è±¡ä¼ å€¼æ›¿ä»£å•ä¸ªå¯¹è±¡å±žæ€§é€ä¸ªä¼ å€¼çš„æ–¹æ³•ï¼Œä¸”ä¸€å®šè¦åœ¨ä¼ å€¼æ—¶åŠ å…¥ .sync ä¿®é¥°ç¬¦ï¼ŒåŒå‘ä¼ å€¼ç»‘å®šã€‚ç¡®ä¿ä»ŽæŽ¥å£æ‹¿åˆ°çš„æ•°æ®ä¹Ÿèƒ½å®žæ—¶ä¼ é€’åˆ°å­ç»„ä»¶ï¼Œè€Œéž undefined :circleMembersList.sync=&quot;circleMembersList&quot; é˜»æ­¢ç»„ä»¶çš„ç‚¹å‡»äº‹ä»¶ä¼ æ’­è§£å†³ï¼š æ·»åŠ å‡½æ•° catchtap=â€funcNameâ€ å³å¯ï¼ŒfuncNameå¯ä¸ºç©ºå‡½æ•°ï¼Œä¹Ÿå¯ä»¥ç›´æŽ¥ä¸å†™ tokenåˆ¤æ–­ å°ç¨‹åºè°ƒè¯•æ—¶ï¼Œæœ‰æ—¶å€™ä¼šå‡ºçŽ°é¦–æ¬¡æ‰“å¼€æ— å†…å®¹ï¼ˆæ‹¿ä¸åˆ°æ•°æ®ï¼‰çš„çŠ¶æ€ï¼Œéœ€è¦â€œæ€æ­»â€å°ç¨‹åºå†æ‰“å¼€æ‰èƒ½çœ‹åˆ°æ•°æ®å†…å®¹ï¼Œå…¶ä¸­å¯èƒ½çš„åŽŸå› ä¹‹ä¸€ä¾¿æ˜¯ token çš„å¤±æ•ˆã€‚åœ¨ä¸ŽåŽå°äº¤äº’çš„æ—¶å€™ï¼Œtokenå¿…ä¸å¯å°‘ã€‚å°¤å…¶æ˜¯åœ¨å°ç¨‹åºåˆ†äº«å‡ºåŽ»çš„é“¾æŽ¥ï¼Œç”±å…¶ä»–ç”¨æˆ·ç‚¹å¼€åˆ†äº«é“¾æŽ¥è¿›å…¥å°ç¨‹åºå†…éƒ¨ï¼Œæ­¤æ—¶æ›´æ˜¯è¦åˆ¤æ–­tokenï¼Œtokençš„åˆ¤æ–­ä¸€èˆ¬é€‰åœ¨ onShowï¼ˆï¼‰é’©å­æ‰§è¡Œè€Œä¸åœ¨ onLoadï¼ˆï¼‰é’©å­å†…æ‰§è¡Œã€‚è‹¥ä¸å­˜åœ¨tokenï¼Œåˆ™åº”è¯¥æ‰§è¡Œç™»å½•åŽ»æ‹¿å–tokenï¼Œå†è¿›è¡Œä¸šåŠ¡é€»è¾‘ 1234567891011onShow() &#123; const that = this; if( !wepy.getStorageSync('token') ) &#123; wepy.login().then(async (res) =&gt; &#123; if(res.code) &#123; let code = res.code; await that.login(code) &#125; &#125;); &#125; &#125; formid å¾®ä¿¡æä¾›äº†æœåŠ¡é€šçŸ¥ï¼Œå³åœ¨ä½ æ”¯ä»˜ã€å¿«é€’ç­‰è¡Œä¸ºæ—¶ï¼Œå¾®ä¿¡ä¼šç›´æŽ¥ç»™ä½ å‘ä¸€ä¸ªæœåŠ¡é€šçŸ¥ï¼ˆæ¨¡æ¿æ¶ˆæ¯ï¼‰æ¥æé†’ï¼Œæ¯æ¬¡æé†’éƒ½ä¼šæ¶ˆè€—è¯¥ç”¨æˆ·å­˜å‚¨çš„formIDï¼ŒformIDä¸ºæ¶ˆè€—å“ï¼Œç”¨ä¸€ä¸ªå°‘ä¸€ä¸ªï¼Œåªæœ‰é€šè¿‡ç”¨æˆ·çš„è¡¨å•æäº¤è¡Œä¸ºæ‰å¯ä»¥ç§¯æ”’formID 12345678&lt;form @submit="submitForm" report-submit="true"&gt; &lt;button form-type="submit" class="editCard" @tap = "goModifiPage('editFormTab')"&gt;ä¿®æ”¹&lt;/button&gt;&lt;/form&gt;//jsæ–¹æ³•submitForm(e) &#123; this.postFormId( e.detail.formId ) // å‘åŽç«¯ä¼ è¾“formid&#125; æ”¯ä»˜ å‡†å¤‡ï¼š crypto-js.js &amp;&amp; md5.js å¾®ä¿¡æ”¯ä»˜æµç¨‹ä¸ºï¼š å‰ç«¯ç‚¹å‡»æ”¯ä»˜æŒ‰é’®æ‹‰èµ·æ”¯ä»˜ ==ã€‹ å‡†å¤‡åŠ å¯†æ•°æ® ==ã€‹ è°ƒç”¨åŽç«¯æŽ¥å£ï¼Œä¼ å…¥éœ€è¦çš„åŠ å¯†æ•°æ® ==ã€‹ åŽç«¯éªŒè¯åŠ å¯†æ•°æ®ï¼Œå†è¿”å›žåŠ å¯†æ•°æ® ==ã€‹ å‰ç«¯æ‹¿åˆ°åŽç«¯åŠ å¯†æ•°æ®ï¼ˆæ—¶é—´æˆ³ã€å†…å®¹ã€ç­¾åï¼‰ï¼Œå¯¹æ—¶é—´æˆ³å’Œå†…å®¹è¿›è¡Œæœ¬åœ°ç­¾åï¼Œå†åˆ¤æ–­æœ¬åœ°ç­¾åå’ŒåŽç«¯ç­¾åæ˜¯å¦ä¸€è‡´ï¼Œè‹¥ä¸ä¸€è‡´ï¼Œç›´æŽ¥è¿”å›žï¼Œé€€å‡ºæ”¯ä»˜ï¼Œæ”¯ä»˜å¤±è´¥ï¼è‹¥ä¸€è‡´ï¼Œå¯¹åˆšåˆšåŽå°è¿”å›žçš„contentï¼ˆå†…å®¹ï¼‰è¿›è¡Œè§£æžï¼Œæ‹¿åˆ°æ‰€éœ€è®¢å•æ•°æ®ï¼Œå‰ç«¯æ‹‰èµ·å¾®ä¿¡æ”¯ä»˜ï¼Œå‚æ•°ä¼ å…¥åˆšåˆšè§£æžæ•°æ® ===ã€‹ å¾—åˆ°æ”¯ä»˜ç»“æžœ success or fail ï¼ç»“æŸ 12345678/** * ç­¾åå‡½æ•° Sign */function sign(timestamp, content) &#123; var raw = timestamp + salt + content var hash = CryptoJS.SHA256(raw).toString() return CryptoJS.MD5(hash).toString()&#125; å‰ç«¯ç‚¹å‡»æ”¯ä»˜æŒ‰é’®ï¼š 123456789101112131415161718192021222324252627// å•ç‹¬æ”¯ä»˜æŽ¥å£alonePay(arg) &#123; const that = this; if( that.buttonClicked === false ) return; //é˜²æ­¢é‡å¤å¤šæ¬¡æ‹‰èµ·æ”¯ä»˜ that.buttonClicked = false; let mode = 1; //ä¸šåŠ¡éœ€æ±‚ï¼Œæˆ‘æœ‰äº”ç§ä¸åŒæ¨¡å¼æ”¯ä»˜ let appId = this.$parent.globalData.appId; let content; let sign; const timeStamp = new Date().Format("yyyy-MM-dd hh:mm:ss").toString(); let code = wepy.getStorageSync('code'); wepy.login().then((res) =&gt; &#123; //èŽ·å–æœ€æ–°çš„codeï¼Œå¯èƒ½è¿™é‡Œæ²¡å¿…è¦ï¼Œå…·ä½“å’ŒåŽç«¯å•†é‡ if(res.code) &#123; let code = res.code; log('code', code) wepy.setStorage(&#123; key: "code", data: code &#125;) &#125; &#125;).then( res =&gt; &#123; content = `mode=$&#123;mode&#125;&amp;app_id=$&#123;appId&#125;` sign = Sign.sign(timeStamp,content); &#125;).then(res =&gt; &#123; that.goCirclePay( that.circle_id, timeStamp, sign, content, mode ) &#125;)&#125;, æ”¯ä»˜å‡½æ•°ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879// æ”¯ä»˜å‡½æ•°ï¼Œæˆ‘å‰ç«¯æœ‰äº”ç§æ”¯ä»˜æƒ…å†µï¼ˆå•ç‹¬ã€è‡ªå·±å‘èµ·æ‹¼å›¢ã€æ‹¼åˆ«äººå›¢ã€iosã€å…è´¹äº”ç§æ”¯ä»˜ï¼‰ï¼Œæ‰€ä»¥å•ç‹¬æŠ½å‡ºæ”¯ä»˜ï¼Œæ¯æ¬¡è°ƒç”¨æ”¯ä»˜å‡½æ•°goCirclePay( circle_id, timestamp, sign, content, mode) &#123; const that = this; circleApi.goCirclePay(&#123; data: &#123; circle_id, timestamp, sign, content &#125;, getToken: true &#125;).then( res =&gt; &#123; log('æ”¯ä»˜resï¼š', res) let data = res.data const SignServer = data.sign const timeStampServer = data.timestamp let contentServer = data.content const SignLocal = Sign.sign(timeStampServer,contentServer); if( mode === 0 &amp;&amp; data.status === "success") &#123; that.nav('/pages/circleDetail?circle_id=' + that.circle_id) return; &#125; if( SignLocal !== SignServer ) &#123; log('ç­¾åä¸ä¸€è‡´ï¼') wx.showToast(&#123; title: "æ‚¨å·²ç»æ”¯ä»˜è¿‡äº†", duration: 1500, image: "../images/common/icon_wxchat.png", &#125;) return &#125; let contentArr = contentServer.split('&amp;') const timeStamp = contentArr[0].split('=')[1]; const nonceStr = contentArr[1].split('=')[1]; let index = contentArr[2].indexOf("="); const package1 = contentArr[2].slice(index+1) const signType = contentArr[3].split('=')[1]; const paySign = contentArr[4].split('=')[1]; wepy.requestPayment(&#123; timeStamp, nonceStr, package: package1, signType, paySign &#125;).then(res =&gt; &#123; return new Promise(resolve =&gt; &#123; setTimeout(() =&gt; &#123; resolve() &#125;, 1000) &#125;) &#125;).then(res =&gt; &#123; //æ”¯ä»˜åŽpromiseï¼Œè¿™é‡Œæœ‰æˆåŠŸå’Œfailä¸¤ç§ï¼Œfailåœ¨catchæ•èŽ·ï¼Œè¿™é‡Œç›´æŽ¥å¼€å§‹å†™æ”¯ä»˜successåŽçš„ä¸šåŠ¡ä»£ç  that.buttonClicked = true; let groupFormIdGet; circleApi.getGroupFormId(&#123; ////èŽ·å–getGroupFormId data: &#123; circle_id: that.circle_id &#125;, getToken: true &#125;).then( res =&gt; &#123; // let data = res.data that.group_form_id = data.group_form_id groupFormIdGet = data.group_form_id if( mode === 1) &#123; that.nav(`/pages/paySuccess?circle_id=$&#123;that.circle_id&#125;&amp;shareLink=$&#123;that.shareLink&#125;`) &#125; else if( mode === 2) &#123; that.nav(`/pages/paySuccess?circle_id=$&#123;that.circle_id&#125;&amp;group_form_id=$&#123;groupFormIdGet&#125;`) &#125; that.$apply() //è„å€¼æ£€æŸ¥è§¦å‘ &#125;) &#125;).catch(res =&gt; &#123; log('æ”¯ä»˜å¤±è´¥', res) that.buttonClicked = true; &#125;) &#125;)&#125; å›¾ç‰‡ä¸Šä¼ ï¼ˆä¸ƒç‰›äº‘ï¼‰ æ›´å¤šå›¾åºŠç½‘ç«™è¯·è§æˆ‘åšå®¢ï¼š https://www.cnblogs.com/fanghl/p/11419914.html å›¾ç‰‡ä¸Šä¼ æœåŠ¡å™¨é‡‡ç”¨ä¸ƒç‰›äº‘æœåŠ¡ï¼Œåœ¨app.wpyå†…å°ç¨‹åºè§¦å‘çš„æ—¶å€™ï¼Œè¯·æ±‚ä¸ƒç‰›äº‘æ‹¿åˆ°tokenå­˜ä¸ºå…¨å±€å˜é‡ã€‚ 123456789101112//app.wpyonLaunch() &#123; //other code *** // ä¸ƒç‰›äº‘,èŽ·å–ä¸ƒç‰›äº‘token wepy.request(&#123; url: 'https://****************/qiniu_token/', header:&#123;'content-type': 'application/json'&#125;, &#125;).then((res) =&gt; &#123; this.globalData.qiniuToken = res.data.token &#125;);&#125; å¯¼å…¥ä¸ƒç‰›äº‘æ–‡ä»¶import qiniuyun from &#39;@/utils/qiniuUploader&#39; base.jsä»£ç ï¼š 1234567891011121314// ä¸Šä¼ å›¾ç‰‡ base.jsconst uploadImg = (imageURL, uptokenURL) =&gt; &#123; return new Promise((resolve, reject) =&gt; &#123; qiniuyun.upload(imageURL, (res) =&gt; &#123; resolve(res); &#125;, (error) =&gt; &#123; reject(error); &#125;, &#123; region: 'ECN', domain: 'å¡«å…¥åŸŸå', uptoken: uptokenURL &#125;); &#125;); &#125; é¡µé¢ç»“æž„ 12345678910111213141516&lt;!-- ä¸Šä¼ ç”Ÿæ´»ç…§ --&gt; &lt;view class="baseInfoTip" style="border: 0"&gt;ä¸Šä¼ ç”Ÿæ´»ç…§ &lt;view class="imgUploadText"&gt;(æœ€å¤š9å¼ )&lt;/view&gt; &lt;view class="leftOriginLine"&gt;&lt;/view&gt; &lt;/view&gt; &lt;view class="uploadImgBox"&gt; &lt;repeat for="&#123;&#123;images&#125;&#125;" index="index" item="item" key="index"&gt; &lt;view class="itemBox"&gt; &lt;image class="imgItem" src="&#123;&#123;item&#125;&#125;" mode="aspectFill"&gt;&lt;/image&gt; &lt;image class="imgItemCancel" id="&#123;&#123;index&#125;&#125;" src="../images/common/icon_cardImg_cancel.png" @tap.stop="cancelUploadImg"&gt;&lt;/image&gt; &lt;/view&gt; &lt;/repeat&gt; &lt;view class="itemBox" @tap="addImg" wx:if="&#123;&#123;!addImgCtrl&#125;&#125;"&gt; &lt;image class="imgItem" src="../images/common/icon_addImg.png"&gt;&lt;/image&gt; &lt;/view&gt; &lt;/view&gt; ä¸Šä¼ å›¾ç‰‡ä¸šåŠ¡ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455// ä»Žç›¸å†Œé€‰æ‹©ç…§ç‰‡ä¸Šä¼ addImg()&#123; const that = this; if( that.buttonClicked === false ) return; that.buttonClicked = false; wepy.chooseImage(&#123; count:9 - that.images.length, sizeType: 'compressed', &#125;).then(async(res1) =&gt; &#123; that.buttonClicked = true; that.toast('ä¸Šä¼ å›¾ç‰‡ä¸­...','loading'); let filePath = res1.tempFilePaths; for(let i = 0;i &lt; filePath.length;i++)&#123; let imgSrc= res1.tempFilePaths[i]; let imgType = imgSrc.substring(imgSrc.length-3); let imgSize = res1.tempFiles[i].size; if(imgSize &gt; 2000000 || imgType === 'gif')&#123; that.toast('è¯¥å›¾ç‰‡æ ¼å¼é”™è¯¯ï¼è¯·é‡æ–°é€‰æ‹©ä¸€å¼ ', 'none', 3000); continue &#125; let res = await base.uploadImg(filePath[i], that.$parent.globalData.qiniuToken); that.images.push(res.imageURL); log('imageé•¿åº¦ï¼š', that.images.length) log('imageï¼š', that.images) if( that.images.length &gt;= 9) &#123; that.addImgCtrl = true &#125; if(that.images.length &gt; 9)&#123; that.images = that.images.slice(0,9) &#125; if(that.images.length &gt;0 &amp;&amp; that.config.fImages)&#123; that.config.progress = that.config.progress + parseFloat(that.config.getConfigs.lifepicweight*100); that.config.fImages = false &#125; that.$apply(); // ä¸Šä¼ ç”¨æˆ·å¤´åƒåˆ—è¡¨ that.userInfo.photos = that.images if(i === filePath.length -1)&#123; wepy.hideToast(); &#125; &#125; &#125;).catch((res) =&gt; &#123; if(res.errMsg === "chooseImage:fail:system permission denied")&#123; that.toast('è¯·æ‰“å¼€å¾®ä¿¡è°ƒç”¨æ‘„åƒå¤´çš„æƒé™', 'none', 3500) &#125; &#125;)&#125;,// å–æ¶ˆå›¾ç‰‡ä¸Šä¼ cancelUploadImg(e) &#123; if( this.images.length &lt; 10 ) &#123; this.addImgCtrl = false &#125; let index = e.target.id this.images.splice(index, 1)&#125;, å¾®ä¿¡æ¶ˆæ¯èŠå¤©å¸ƒå±€å¾®ä¿¡èŠå¤©æ¡†æ•´ä½“å¸ƒå±€ç‰¹ç‚¹æœ‰ï¼š æŽ¥æ”¶æ–¹å’Œå‘é€æ–¹æ¶ˆæ¯åˆ†åˆ«ä½äºŽå±å¹•çš„å·¦å³ä¸¤ä¾§ã€æœ€æ–°çš„æ¶ˆæ¯ä¸€å®šæ˜¯åœ¨å±å¹•æœ€åº•éƒ¨ã€è¿›å…¥æ¶ˆæ¯dialogé¡µé¢ä¸€å®šæ˜¯æ˜¾ç¤ºçš„æœ€æ–°æ¶ˆæ¯ï¼Œå³é¡µé¢æ»‘åŠ¨åœ¨æœ€åº•éƒ¨ã€‚è¿™ä¸‰ä¸ªåŸºæœ¬ç‰¹å¾æž„æˆäº†å¾®ä¿¡èŠå¤©é¡µé¢çš„å¸ƒå±€åŽŸåˆ™ã€‚å…ˆçœ‹æ•ˆæžœå›¾ ï¼ˆéžæœ€ç»ˆæ•ˆæžœï¼‰ï¼šâ†“å¸ƒå±€æ€è·¯ï¼šflexåå‘å¸ƒå±€ 1234567891011121314151617&lt;!-- æ ¼å¼åŒ–ä»£ç  --&gt;&lt;view class="msgBox" id="msgBox"&gt; &lt;repeat for="&#123;&#123;talkContent&#125;&#125;" key="index" item="item"&gt; &lt;view class="msgItem &#123;&#123;item.send_user === configData.send_user ? 'msgItemReverse' : ''&#125;&#125;"&gt; &lt;image class="adverseHeadimg" src="&#123;&#123;item.send_user === configData.send_user ? configData.user_img : talkAimerInfo.headimg&#125;&#125;" mode="aspectFill"&gt; &lt;/image&gt; &lt;text class="textBox &#123;&#123;item.send_user == configData.send_user ? 'textGreen' : ''&#125;&#125;" selectable="true"&gt; &#123;&#123;item.message&#125;&#125; &lt;/text&gt; &lt;/view&gt; &lt;view class="timeTip" wx:if="&#123;&#123;item.send_user != configData.send_user&#125;&#125;"&gt; &#123;&#123;item.create_time&#125;&#125; &lt;/view&gt; &lt;/repeat&gt;&lt;/view&gt; 1234.msgBox&#123; display: flex; /*æ•´ä½“æ¶ˆæ¯æ¡†flexå¸ƒå±€ï¼Œçºµå‘å–åå¸ƒå±€*/ flex-direction: column-reverse;&#125; 12345678.msgItem&#123; /*æ¶ˆæ¯itemæ ·å¼*/ position: relative; display: flex; flex-direction: row;&#125;.msgItemReverse&#123; /*å¯¹æ–¹çš„æ¶ˆæ¯æ ·å¼ï¼Œflexè¡Œå–åå¸ƒå±€*/ flex-direction: row-reverse;&#125; ä¿æŒé¡µé¢å§‹ç»ˆæ»‘åŠ¨åœ¨æœ€åº•éƒ¨å‡½æ•° 12345678910pageScrollToBottom( msgLength ) &#123; //åœ¨é¡µé¢éœ€è¦è¿›è¡Œå˜åŒ–æ—¶è°ƒç”¨ wx.createSelectorQuery().select('#contentBox').boundingClientRect(function(rect)&#123; // ä½¿é¡µé¢æ»šåŠ¨åˆ°åº•éƒ¨ log('rect', rect) wx.pageScrollTo(&#123; scrollTop: rect.bottom + msgLength*60, duration: 80 &#125;) log('msgBoxçš„ä¸‹è¾¹ç•Œåæ ‡ï¼š ', msgLength ) &#125;).exec() &#125; è‡ªå·±å‘é€çš„æ¶ˆæ¯æ•°æ®å¯ä»¥ç›´æŽ¥åŽ‹å…¥æœ¬åœ°æ•°ç»„ talkContent å†…ï¼ŒUnshift()è¿›å…¥ï¼Œå¾—åˆ°â€œè´Ÿè´Ÿå¾—æ­£â€æ•ˆæžœï¼Œå³æ•°æ®åï¼Œå¸ƒå±€åå³å¯å¾—åˆ°ä»Žåº•éƒ¨æŽ’åˆ—çš„å¸ƒå±€ã€‚å¯¹æ–¹çš„æ¶ˆæ¯ä»ŽæœåŠ¡å™¨æ‹‰ä¸‹æ¥çš„æ—¶å€™ï¼Œæ”¾å…¥ talkContent å†…å‰ reverse() ä¸€ä¸‹å³å¯ èŠå¤©é¡µé¢inputé¡¶èµ·é¡µé¢ç›¸å…³èŠå¤©inputç‚¹å‡»åŽï¼Œé»˜è®¤ä¸ºé¡¶èµ·é¡µé¢ï¼Œä¹Ÿå¯ä»¥å…³é—­é»˜è®¤é€‰æ‹©ä¸é¡¶èµ·ã€‚ä½†æ˜¯ä¸é¡¶èµ·é¡µé¢å…¶å®žæ˜¯inputè„±ç¦»å½“å‰pageï¼Œä¼šå‡ºçŽ°é”®ç›˜ä¸Šæ–¹æ²¡æœ‰æˆ‘ä»¬çš„è¾“å…¥æ¡†ï¼å› ä¸ºé”®ç›˜ä¸é¡¶èµ·é¡µé¢ï¼Œæ•…ä¸ä¼šå½±å“ä¹‹å‰çš„å¸ƒå±€ï¼Œè¾“å…¥æ¡†ä¸€èˆ¬éƒ½åœ¨é¡µé¢æœ€åº•éƒ¨ã€‚è§£å†³ï¼š wx.onKeyboardHeightChange ç›‘å¬é”®ç›˜é«˜åº¦ï¼Œä¸¥é‡ä¸æŽ¨èinputè‡ªèº«å‡½æ•°bindkeyboardheightchangeï¼Œå› ä¸ºbindkeyboardheightchange åœ¨æ‰‹åŠ¿ä¸Šåˆ’éšè—é”®ç›˜æ—¶Androidæ˜¯ä¸ä¼šè¢«è§¦å‘çš„ï¼ï¼ï¼æ€è·¯ï¼š adjust-position = &quot;false&quot;è®¾ç½®ä¸é¡¶èµ·é¡µé¢ï¼Œåœ¨æ‰‹åŠ¨æŠŠå†…å®¹å±•ç¤ºview çš„é«˜åº¦å‡å°‘é”®ç›˜çš„é«˜åº¦ï¼åœ¨é”®ç›˜æ‹‰èµ·æ—¶ï¼Œå†…å®¹é«˜åº¦å‡å°‘é”®ç›˜çš„é«˜åº¦ï¼Œåœ¨é”®ç›˜éšè—å¼ï¼Œå›žå¤åŽŸé«˜åº¦ã€‚æœ€åŽçš„æ•ˆæžœå’Œå¾®ä¿¡åŽŸç”ŸèŠå¤©ä¸€æ ·ï¼æ•ˆæžœï¼š ä¼˜åŒ–ï¼šåœ¨å‡å°‘é«˜åº¦çš„åŒæ—¶ï¼ŒæŠŠå†…å®¹é¡µé¢æ»‘åˆ°æœ€åº•éƒ¨ï¼Œä»¥å±•ç¤ºæœ€æ–°æ¶ˆæ¯ï¼ 12345678910&lt;input class="inputContent" type="text" value="&#123;&#123;userInputContent&#125;&#125;" bindinput = "InputBlur" adjust-position = "&#123;&#123;false&#125;&#125;" hold-keyboard = true confirm-hold = true confirm-type = 'done' @tap="onInpueChange"&gt; 123456789101112131415161718onInpueChange() &#123; const that = this that.scrollBottom() wx.onKeyboardHeightChange(res =&gt; &#123; that.log(res.height) that.scrollView.height = res.height *2 + 20 that.$apply() &#125;)&#125;// é¡µé¢æ»šåŠ¨åˆ°åº•éƒ¨scrollBottom()&#123; const that = this; that.scrollTopValue++; setTimeout(function() &#123; that.scrollTop = that.scrollTopValue; that.$apply() &#125;, 300);&#125; CSSæ³¨æ„ç‚¹CSSæŒç»­è¡¥å……ä¸­â€¦â€¦word-break: break-all; //æ¢è¡Œæ–‡å­—ï¼Œè‹±æ–‡æº¢å‡º-webkit-overflow-scrolling: touch; //iosç«¯å¯ç”¨ç¡¬ä»¶åŠ é€Ÿï¼Œè§£å†³iosç«¯æ»‘åŠ¨ç²˜æ‰‹catchtouchmove=&#39;true&#39; //æ¨¡æ€æ¡†ä¸­æ·»åŠ ï¼Œç¦æ­¢é¡µé¢æ»‘åŠ¨circleDynamic:last-of-type //ç‰¹å®šç±»circleDynamicä¸­æœ€åŽä¸€ä¸ªå…ƒç´ :nth-of-type(1/odd/even) //é€‰æ‹©ç‰¹å®šå…ƒç´ ä¸‹ç¬¬å‡ ä¸ªå…ƒç´  123 /* CSS å¸é¡¶ */position: sticky; top: 0; async/awaitå¼‚æ­¥ç¼–ç¨‹çš„ç»ˆæžè§£å†³æ–¹æ¡ˆï¼Œåœ¨å°ç¨‹åºå†…æ‹¿å–codeæˆ–è€…loginæ—¶ä¼šç”¨åˆ°ï¼Œawaitå¯ç†è§£ä¸ºæ±‚å€¼ï¼asyncå¯ç†è§£ä¸ºæ­é…awaitçš„è¯­æ³•ï¼Œå¦‚æžœå¼‚æ­¥å‡½æ•°åŽ»æŽ‰awaitï¼Œè¿”å›žçš„ä¸€èˆ¬æ˜¯ promise å¯¹è±¡ï¼Œéœ€è¦æ‰‹åŠ¨åŽ»reject å’Œ resolve ã€‚ 123456789101112if( !wepy.getStorageSync('token') ) &#123; wepy.login().then(async (res) =&gt; &#123; if(res.code) &#123; let code = res.code; await that.login(code) wepy.setStorage(&#123; key: "code", data: code &#125;) &#125; &#125;); &#125; else &#123;&#125; ios/androidæœºåž‹åŒºåˆ«ç”±äºŽå¾®ä¿¡å°ç¨‹åºçš„è¿è¡Œè§„èŒƒé™åˆ¶ç­‰ï¼Œä¸€äº›åœ¨ Android ä¸Šå¯ä»¥å­˜åœ¨çš„ä¸šåŠ¡éœ€æ±‚å¹¶ä¸èƒ½åŽŸå°ä¸åŠ¨åœ¨ ios ç«¯è¿è¡Œï¼Œå¦åˆ™å°å¿ƒ å°å·è­¦å‘Š ï¼ˆæ­¤å¤„æ‰‹åŠ¨æ»‘ç¨½.jpgï¼‰,æ‰€ä»¥ä¸€èˆ¬é‡‡å–ä¸¤ä¸ªç³»ç»Ÿçš„ç”¨æˆ·è¿›å…¥æŸä¸€ä¸ªé¡µé¢ï¼Œå±•çŽ°ä¸åŒçš„å†…å®¹ã€‚åˆ¤æ–­æœºåž‹ï¼šåœ¨ app.wpy å…¥å£æ–‡ä»¶ä¸­ï¼Œonlaunch ç”Ÿå‘½å‘¨æœŸå†…åˆ¤æ–­æœºåž‹å¹¶ä¿å­˜åˆ°å…¨å±€å˜é‡å³å¯ 12345678getSystemInfo() &#123; const that = this; wx.getSystemInfo(&#123; success(res) &#123; that.globalData.userPlatform = res.platform; &#125; &#125;)&#125; åˆ†åŒ…å¾®ä¿¡å°ç¨‹åºå®˜æ–¹é™åˆ¶å°ç¨‹åºä»£ç å¤§å°ä¸å¾—è¶…è¿‡ 2M ï¼Œåœ¨ä¸šåŠ¡é€»è¾‘è¾ƒå¤šçš„æƒ…å†µä¸‹ï¼ŒæŸ¥è¿‡2MåŽï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨åˆ†åŒ…åŠ è½½ã€‚ 1234567891011121314151617181920//app.wpyconfig = &#123; pages: [ &apos;basePage1&apos;, &apos;basePage2&apos;, &apos;basePage3&apos;, ], subPackages: [ &#123; root: &apos;dirName&apos;, //é€šå¸¸ç»“æž„å’Œ pages: [ &apos;subPage1&apos;, &apos;subPage2&apos;, ] &#125; ]&#125;//é¡µé¢ä½¿ç”¨ï¼šthis.nav(`/dirName/pages/subPage1`) canvasç”Ÿæˆæµ·æŠ¥å°ç¨‹åºåˆ†äº«è‡³æœ‹å‹åœˆçš„æµ·æŠ¥åˆ¶ä½œè¿‡ç¨‹ï¼Œæµ·æŠ¥å†…å®¹ä¸ºåŠ¨æ€èŽ·å–ï¼Œå†…å®¹æ ¹æ®æ¯ä¸ªç”¨æˆ·ç”Ÿæˆä¸åŒçš„æµ·æŠ¥ å¦‚å›¾ï¼Œé™¤äº†èƒŒæ™¯ä½¿ç”¨æœ¬åœ°å›¾ç‰‡ï¼Œå…¶ä»–çš„æ‰€æœ‰å†…å®¹å‡ä¸ºåŠ¨æ€èŽ·å–ï¼Œä¸”æ¯æ¬¡èŽ·å–çš„ä¸å°½ç›¸åŒã€‚ å›¾ç‰‡å…ˆä»Žç½‘ç»œå›¾ç‰‡ä¸‹è½½åˆ°æœ¬åœ°æ‰å¯ä»¥æ¸²æŸ“ï¼Œå¦‚æžœå¼€å‘å·¥å…·å¯ä»¥æ­£å¸¸æ˜¾ç¤ºï¼Œè€ŒçœŸæœºæ— æ³•ç»˜åˆ¶ï¼Œé‚£ä¹ˆè¯·å…ˆæ£€æŸ¥ä½ çš„ downloadFile åŸŸå!!! ç»˜åˆ¶åœ†è§’-ç›´è§’å›¾ç‰‡ å›¾ç‰‡ä¿å­˜æ¨¡ç³Š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788//ç»˜åˆ¶æ–‡å­— drawTxt(fontSize, color, content, x, y, bold=false) &#123; this.ctx.save() this.ctx.setFontSize(fontSize) this.ctx.setFillStyle(color) this.ctx.fillText(content, x, y) if (bold) &#123; this.ctx.fillText(content, x, y + 0.3) this.ctx.fillText(content, x + 0.3, y) &#125; this.ctx.setTextBaseline('middle') this.ctx.restore() &#125;//ç»˜åˆ¶åœ†è§’å›¾ç‰‡(é»˜è®¤)-çŸ©å½¢å›¾ç‰‡ getRectWithRadius(ctx, x, y, w, h, r, c, borderArgs = []) &#123; // r &gt; 0 åˆ™é»˜è®¤ç»˜åˆ¶åœ†è§’å›¾ç‰‡ï¼Œ r = 0 ,åˆ™ç»˜åˆ¶çŸ©å½¢ //ç»˜åˆ¶åœ†å½¢ åˆ™ r = 1/2 w || 1/2h //ç»˜åˆ¶ä»»æ„ç›´è§’ åˆ™ borderArgs = [leftTop, rightTop, rightBottom, leftBottom]æŽ§åˆ¶ let rate = this.rate let b = borderArgs ctx.beginPath() ctx.moveTo(x / rate, y / rate) b &amp;&amp; b[0] ? '' : ctx.arc((x + r) / rate, (y + r) / rate, r / rate, Math.PI, 1.5 * Math.PI) b &amp;&amp; b[1] ? ctx.lineTo((x + w) / rate, y / rate) : ctx.lineTo((x + w - r) / rate, y / rate) b &amp;&amp; b[1] ? '' : ctx.arc((x + w - r) / rate, (y + r) / rate, r / rate, 1.5 * Math.PI, 0) b &amp;&amp; b[2] ? ctx.lineTo((x + w) / rate, (y + h) / rate) : ctx.lineTo((x + w) / rate, (y + h - r) / rate) b &amp;&amp; b[2] ? '' : ctx.arc((x + w - r) / rate, (y + h - r) / rate, r / rate, 0, 0.5 * Math.PI) b &amp;&amp; b[3] ? ctx.lineTo((x) / rate, (y + h) / rate) : ctx.lineTo((x + r) / rate, (y + h) / rate) b &amp;&amp; b[3] ? '' : ctx.arc((x + r) / rate, (y + h - r) / rate, r / rate, 0.5 * Math.PI, Math.PI) ctx.closePath() if (c) &#123; ctx.fillStyle = c ctx.fill() &#125; &#125;// ä¿å­˜æµ·æŠ¥ savePosterToLocal() &#123; const that = this // èŽ·å–ç”¨æˆ·æ˜¯å¦å¼€å¯ç”¨æˆ·æŽˆæƒç›¸å†Œ wx.getSetting(&#123; success(res) &#123; // å¦‚æžœæ²¡æœ‰åˆ™èŽ·å–æŽˆæƒ if (!res.authSetting['scope.writePhotosAlbum']) &#123; wx.authorize(&#123; scope: 'scope.writePhotosAlbum', success() &#123; that.saveCanvas() &#125;, fail() &#123; that.toast('å³ä¸Šè§’å¼€å¯æŽˆæƒ', 'none') wx.openSetting() &#125; &#125;) &#125; else &#123; that.saveCanvas() &#125; &#125; &#125;) &#125;//canvasä¿å­˜è‡³ç›¸å†Œ saveCanvas() &#123; // 1-æŠŠç”»å¸ƒè½¬åŒ–æˆä¸´æ—¶æ–‡ä»¶ const that = this wx.canvasToTempFilePath(&#123; x: 0, y: 0, width: 560, // ç”»å¸ƒçš„å®½ height: 996, // ç”»å¸ƒçš„é«˜ destWidth: 1080 * 750 / wx.getSystemInfoSync().windowWidth, destHeight: 1920 * 750 / wx.getSystemInfoSync().windowWidth, canvasId: 'poster', success(res) &#123; wepy.saveImageToPhotosAlbum(&#123; filePath: res.tempFilePath, success(res2) &#123; that.toast('ä¿å­˜è‡³ç›¸å†ŒæˆåŠŸ', 'none') &#125;, fail() &#123; that.toast('ä¿å­˜å¤±è´¥ï¼Œç¨åŽå†è¯•', 'none') &#125; &#125;) &#125;, fail() &#123; that.toast('ä¿å­˜å¤±è´¥ï¼Œç¨åŽå†è¯•', 'none') &#125; &#125;) &#125; å¤šå¼ å›¾ç‰‡ä¸‹è½½ç½‘ç»œå›¾ç‰‡ä¸‹è½½æˆæœ¬åœ°å›¾ç‰‡ï¼Œä¸”å…¨éƒ¨ä¸‹è½½å®Œå…¨åŽæ‰å¯ä»¥ç»˜åˆ¶canvas 1234567891011121314151617181920212223242526272829let promise1 = new Promise(function(resolve,reject)&#123; wx.getImageInfo(&#123; src: that.posterData.matchmaker.qrcord, success:function(res)&#123; imgResource.qrcord = res.path resolve(res); &#125;, fail:function(res)&#123; reject(res); &#125; &#125;) &#125;)let promise2 = new Promise(function(resolve,reject)&#123; wx.getImageInfo(&#123; src: that.posterData.matchmaker.qrcord, success:function(res)&#123; imgResource.qrcord = res.path resolve(res); &#125;, fail:function(res)&#123; reject(res); &#125; &#125;)&#125;)Promise.all([promise1, promise2, promise3]).then(res =&gt; &#123; //å¼€å§‹ç»˜åˆ¶ const ctx = wx.createCanvasContext('poster') that.ctx = ctx&#125; å¼‚å¸¸æ˜¾ç¤ºæœ‰æ—¶å€™Androidæ‰‹æœºä¼šæ˜¾ç¤ºä¸å®Œcanvasï¼Œå®½åº¦å¼‚å¸¸ï¼Œioså´æ²¡æœ‰è¯¥å¼‚å¸¸çŽ°è±¡ã€‚å…¶ä¸­ä¸€ç§å¯èƒ½å°±æ˜¯è®¾ç½®canvasæ ‡ç­¾çš„å®½é«˜å•ä½ä¸ä¸€è‡´ï¼Œcanvaså†…å•ä½åŒä¸€ä½ px ï¼ŒæŠŠå¸¸ç”¨çš„ rpx æ›¿æ¢ä¸º px &lt;canvas canvas-id=&quot;poster&quot; style=&quot;width: 280px; height: 498px;&quot;&gt;&lt;/canvas&gt; touchmove/onPageScrollåŠ¨ç”»æ•ˆæžœå¦‚å›¾ï¼Œå³ä¸‹è§’çš„æŒ‰é’®ï¼Œä¸€èˆ¬ä¼šåšè¿™æ ·çš„æ•ˆæžœï¼Œå½“ç”¨æˆ·æ»‘åŠ¨åˆ—è¡¨æ—¶ï¼Œè¯¥æŒ‰é’®å‘ä¸‹æ»‘åŠ¨å¹¶éšè—ï¼Œå½“ç”¨æˆ·åœæ­¢æ»‘åŠ¨ä¸”é¡µé¢äº¦åœæ­¢æ»‘åŠ¨ï¼ˆéžç”¨æˆ·æ‰‹æŒ‡è„±ç¦»å±å¹•ï¼‰æ—¶ï¼Œè¯¥æŒ‰é’®å†ä»Žé¡µé¢åº•éƒ¨æ»‘å‡ºã€‚ touchmoveã€ onPageScroll æ€è·¯1ï¼š ç¬¬ä¸€ç§æƒ³æ³•æ˜¯touchstartæ—¶ï¼Œ è§¦å‘ä¸‹æ»‘åŠ¨ç”»ï¼Œtouchendæ—¶è§¦å‘ä¸Šåˆ’åŠ¨ç”» ç¼ºç‚¹ï¼š tapç‚¹å‡»äº‹ä»¶ä¹Ÿä¼šå…ˆè§¦å‘start å’Œ end äº‹ä»¶ï¼Œæ•…ç‚¹å‡»å±å¹•ä¹Ÿä¼šè§¦å‘åŠ¨ç”»ï¼Œä¸”å±å¹•æŠ–åŠ¨ï¼Œpass æ€è·¯2ï¼š touchmove æ—¶è§¦å‘åŠ¨ç”»ï¼Œtouchendæ—¶ä¸Šåˆ’åŠ¨ç”»ï¼Œ ç¼ºç‚¹ï¼šè™½ç„¶é¿å…äº†ç‚¹å‡»å°±è§¦å‘åŠ¨ç”»ï¼Œä½†æ•ˆæžœä¸ä½³ï¼Œæ‰‹æŒ‡ç¦»å¼€å±å¹•ï¼Œé¡µé¢è¿˜åœ¨æ»‘åŠ¨ï¼ŒåŠ¨ç”»å·²è§¦å‘ã€‚ æœ€ç»ˆè§£ï¼š åªç”¨ touchmove æ¥åˆ¤æ–­ç”¨æˆ·æ»‘åŠ¨åˆ—è¡¨ï¼Œå†ç”¨ onPageScroll é…åˆ è¶…æ—¶å™¨ æ¥å¤„ç†é¡µé¢åœæ­¢æ»‘åŠ¨ã€‚ ä»£ç ï¼š 12345678910111213141516171819202122//template&lt;view calss="&#123;&#123;isSlide ? 'down-slide-hide' : 'up-slide-hide'&#125;&#125;"&gt;&lt;/view&gt;// datadata: &#123; isSlide: false, timer: null,&#125;//methodstouchmove(e) &#123; this.isSlide = true this.$apply()&#125;,onPageScrool(e) &#123; const that = this clearTimeout(that.timer) that.timer = setTimeout(() =&gt; &#123; that.isSlide = false that.$apply() &#125;, 400)&#125; é¡µé¢ä¸€ç›´å¤„äºŽæ»‘åŠ¨æ—¶ï¼Œè¶…æ—¶å™¨ä¸ä¼šç”Ÿæ•ˆï¼Œåªæœ‰åœ¨é¡µé¢åœæ­¢æ»‘åŠ¨åŽï¼Œè¶…æ—¶å™¨æ‰ç”Ÿæ•ˆï¼Œç¨‹åºæ‰§è¡Œ å½•éŸ³ å½•éŸ³æ²¡æœ‰éš¾åº¦ï¼Œä¸Šä¼ è¯­éŸ³é‡‡ç”¨ä¸ƒç‰›äº‘æœåŠ¡ï¼Œæ‹¿åˆ°ä¸´æ—¶è·¯å¾„ç»è¿‡ä¸ƒç‰›äº‘æ‹¿åˆ°ç½‘ç»œè·¯å¾„ï¼Œåœ¨ä¼ ç»™è‡ªå·±æœåŠ¡å™¨ã€‚è¿™é‡Œå®žçŽ°äº†ä¸€ä¸ªåœ†çŽ¯è¿›åº¦æ¡ï¼ˆcanvasï¼‰ï¼Œåœ¨å½•éŸ³æ—¶é…åˆå½•éŸ³æ—¶é•¿å±•ç¤º 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748//ç»˜åˆ¶è¿›åº¦æ¡åœ†çŽ¯startRocord() &#123; ... this.countInterval()&#125;drawCircle(step) &#123; !this.ctx &amp;&amp; this.ctx = wx.createCanvasContext('progressBar') let ctx = this.ctx // ctx.clearRect(0, 0, 120, 120) //æ¸…é™¤ç”»å¸ƒï¼Œï¼ˆå¤šæ¬¡é‡å¤ç»˜åˆ¶éœ€è¦ã€‚ä½†ç»˜åˆ¶æ­¥ä¼è¿‡å¿«ä¼šå¯¼è‡´é—ªå±ï¼‰ // ctx.draw() ctx.setLineWidth(10) ctx.setStrokeStyle('#FF5757') ctx.setLineCap('round') ctx.beginPath() ctx.arc(60, 60, 55, -Math.PI/2, step*Math.PI - Math.PI/2, false) ctx.stroke() ctx.draw()&#125;//è¿›åº¦ç»˜åˆ¶å®šæ—¶å™¨countInterval() &#123; this.countTimer = setInterval(() =&gt; &#123; if (this.count &lt;= 600) &#123; //ç»˜åˆ¶æ­¥ä¼ï¼Œè¿™é‡Œ0.1ç§’ç»˜åˆ¶ï¼Œå¾ˆä¸æ»‘ this.drawCircle(this.count / (600/2)) this.count++ this.$apply() &#125; else &#123; clearInterval(this.countTimer) this.count = 0 &#125; &#125;, 1000 * 0.1);&#125;//å½•éŸ³å®žä¾‹ initRecord() &#123; !this.RM &amp;&amp; (this.RM = wx.getRecorderManager()) let RM = this.RM RM.onStop(async res =&gt; &#123; //ç›‘å¬å½•éŸ³ç»“æŸï¼Œ resä¼šè¿”å›žå½•éŸ³ä¿¡æ¯ï¼ˆä¸´æ—¶æ–‡ä»¶è·¯å¾„ã€æ—¶é•¿ã€æ–‡ä»¶å¤§å°ï¼‰ //ä¸ƒç‰›äº‘ä¸Šä¼ ä¸´æ—¶è·¯å¾„ let result = await base.uploadImg(res.tempFilePath, wepy.$instance.globalData.qiniuToken) ... &#125;) RM.start(&#123; duration: 60*1000, format: 'mp3', &#125;)&#125; æ’­éŸ³ createInnerAudioContext ç”¨æ¥æ’­æ”¾å„ä¸ªç”¨æˆ·è¯­éŸ³ï¼Œå¯ä»¥éšæ—¶åˆ‡æ¢ä¸åŒç”¨æˆ·çš„è¯­éŸ³æ’­æ”¾ï¼Œå®‰å“è§„è§„çŸ©çŸ©æ²¡é—®é¢˜ iosæ’­æ”¾å¼‚å¸¸ iosç”¨æˆ·åˆ‡æ¢è¯­éŸ³æ—¶ä¼šæ’­æ”¾ç¬¬ä¸€ä¸ªéŸ³é¢‘ï¼Œä½†éšåŽçš„è¯­éŸ³å´ä¸ä¼šæ’­æ”¾ï¼Œå®žä¾‹å·²ç»é”€æ¯ï¼Œä½†è²Œä¼¼å¯¹iosæ— æ•ˆã€‚è§£å†³ï¼šå•ä¾‹æ¨¡å¼åˆ›å»ºå®žä¾‹ï¼Œåœ¨é”€æ¯å®žä¾‹åŽï¼Œåœ¨å°†å˜é‡æ‰‹åŠ¨æ¸…ç©ºï¼Œå¯ä»¥è§£å†³iosæ–°å»ºæ’­éŸ³å®žä¾‹æ— æ•ˆé—®é¢˜ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940//dataIAC: null,isAudition: false,/*** src: éŸ³é¢‘ cubicleï¼šæ’­æ”¾å¼€å…³ index: ç”¨æˆ·ç´¢å¼•(ä¸åŒéŸ³é¢‘) currentUserï¼šå½“å‰éœ€è¦æ’­æ”¾çš„ç”¨æˆ· lastUserï¼š ä¸Šä¸€ä¸ªæ’­æ”¾çš„ç”¨æˆ· isAuditionStatusï¼š æ’­æ”¾çŠ¶æ€ï¼ˆæœªæ’­æ”¾ï¼Œæ­£åœ¨æ’­æ”¾ï¼‰* handleSound ç›‘å¬æ–°è€ç”¨æˆ·æ’­éŸ³ï¼Œè‹¥IACæ­£åœ¨æ’­éŸ³ï¼Œæ­¤æ—¶ç»§ç»­ç‚¹å‡»åŒä¸€ç”¨æˆ·ï¼Œåˆ™æš‚åœå½“å‰éŸ³é¢‘ï¼Œè‹¥IACæœªåœ¨æ’­éŸ³ï¼Œåˆ™æ’­éŸ³å½“å‰ç”¨æˆ·ã€‚è‹¥ç‚¹å‡»ä¸åŒç”¨æˆ·ï¼Œåˆ™æš‚åœå½“å‰æ­£åœ¨æ’­éŸ³çš„ç”¨æˆ·ï¼Œæ’­æ”¾æ–°ç”¨æˆ·å½•éŸ³ã€‚*/async handleSound(src, cubicle, index) &#123; if (this.currentUser !== index) &#123; this.lastUser = this.currentUser this.currentUser = index this.changeUser = true &#125; if (this.changeUser) &#123; this.IAC &amp;&amp; this.IAC.destroy() this.IAC = null //iosè¿™ç‚¹ä¸ä»…éœ€è¦destroyå®žä¾‹ï¼Œè¿˜è¦æ‰‹åŠ¨æ¸…ç©ºå˜é‡ this.lastUser != -1 &amp;&amp; (this.recommUserList[this.lastUser].isAuditionStatus = 0) !this.IAC &amp;&amp; (this.IAC = wx.createInnerAudioContext()) let IAC = this.IAC IAC.src = src IAC.play() IAC.onPlay(() =&gt; &#123; this.recommUserList[this.currentUser].isAuditionStatus = wepy.$instance.globalData.isPlaying = 1 this.$apply() &#125;) IAC.onStop(() =&gt; &#123; this.recommUserList[this.currentUser].isAuditionStatus = wepy.$instance.globalData.isPlaying = 0 this.$apply() &#125;) IAC.onEnded(() =&gt; &#123; this.recommUserList[this.currentUser].isAuditionStatus = wepy.$instance.globalData.isPlaying = 0 this.$apply() &#125;) this.changeUser = false this.$apply() &#125; else &#123; cubicle ? this.IAC.play() : this.IAC.stop() &#125;&#125; ä¸ç®¡æ˜¯å½•éŸ³è¿˜æ˜¯æ’­éŸ³ï¼Œåœ¨é¡µé¢å¸è½½ï¼ˆonUnloadï¼‰çš„æ—¶å€™æ¸…é™¤æŽ‰å®žä¾‹æˆ–è€…åˆå§‹åŒ–,æœ‰canvasä¹Ÿè¦æ¸…é™¤ç”»å¸ƒ åŽä¸º-textarea-å±‚çº§å¼‚å¸¸åŽä¸ºéƒ¨åˆ†æœºåž‹ï¼Œå¯¹å°ç¨‹åºçš„textareaæ ‡ç­¾æ”¯å‡ºå¹¶ä¸å‹å¥½ï¼Œå…¶textareaçš„å†…å®¹ä»¥åŠ placeholder å†…å®¹æ¨å¤©é«˜ï¼Œæ— æ³•é€šè¿‡ç¨‹åºæŽ§åˆ¶ï¼Œç”šè‡³å°ç¨‹åºå®˜æ–¹è¯´ canvas çš„å±‚çº§æ˜¯æœ€é«˜çš„ï¼Œä½†ä¹Ÿæ²¡é«˜è¿‡textareaï¼ é—®é¢˜ï¼š ç›–åœ¨textareaä¸Šé¢çš„å¼¹æ¡†ä¼šè¢«textareaçš„å†…å®¹ç©¿æŽ‰ç›–ä¸ä½ï¼Œå¹¶ä¸”ç‚¹å‡»äº‹ä»¶ç›´æŽ¥ç©¿é€ è§£å†³ï¼šåœ¨æ‹‰èµ·ç›–åœ¨textareaä¸Šé¢çš„å¼¹æ¡†ï¼ˆæˆ–ç»„ä»¶ï¼‰æ—¶ï¼Œç”¨ view æ ‡ç­¾é‡å†™æ¨¡ä»¿ textarea æ ·å¼ï¼Œå¹¶æŠŠ textarea å…³é—­æŽ‰ã€‚ æŒç»­æ›´æ–°â€¦â€¦.]]></content>
      <categories>
        <category>å·¥ä½œæ€»ç»“</category>
      </categories>
      <tags>
        <tag>Programming</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[firstBlog]]></title>
    <url>%2F2019%2F08%2F19%2FfirstBlog%2F</url>
    <content type="text"><![CDATA[#æ—¢æ˜¨å¤©æžå´©GitHubåšå®¢ï¼Œå†æ¬¡åšå¼ºçš„å°è¯• æ—¢æ˜¨å¤©æžå´©GitHubåšå®¢ï¼Œå†æ¬¡åšå¼ºçš„å°è¯•æ—¢æ˜¨å¤©æžå´©GitHubåšå®¢ï¼Œå†æ¬¡åšå¼ºçš„å°è¯•####æ—¢æ˜¨å¤©æžå´©GitHubåšå®¢ï¼Œå†æ¬¡åšå¼ºçš„å°è¯• #####æ—¢æ˜¨å¤©æžå´©GitHubåšå®¢ï¼Œå†æ¬¡åšå¼ºçš„å°è¯• 1alert('hello world')]]></content>
      <categories>
        <category>test</category>
      </categories>
      <tags>
        <tag>Programming</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hello World]]></title>
    <url>%2F2019%2F08%2F15%2Fhello-world%2F</url>
    <content type="text"><![CDATA[Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new "My New Post" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment]]></content>
  </entry>
</search>
